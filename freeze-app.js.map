{"version":3,"file":"freeze-app.js","sources":["../../node_modules/tslib/tslib.es6.js","../../node_modules/@lit/reactive-element/css-tag.js","../../node_modules/@lit/reactive-element/reactive-element.js","../../node_modules/lit/node_modules/lit-html/lit-html.js","../../node_modules/lit/node_modules/lit-element/lit-element.js","../../node_modules/@lit/reactive-element/decorators/custom-element.js","../../node_modules/@lit/reactive-element/decorators/property.js","../../node_modules/@lit/reactive-element/decorators/state.js","../../node_modules/@lit/reactive-element/decorators/query.js","../../node_modules/@lit/reactive-element/decorators/base.js","../../node_modules/lit/node_modules/lit-html/directive-helpers.js","../../node_modules/lit/node_modules/lit-html/directive.js","../../node_modules/lit/node_modules/lit-html/async-directive.js","../../node_modules/lit/node_modules/lit-html/directives/ref.js","../../node_modules/lit/node_modules/lit-html/directives/class-map.js","../../src/errors.ts","../../node_modules/lit/node_modules/lit-html/directives/style-map.js","../../node_modules/lit/node_modules/lit-html/directives/unsafe-html.js","../../src/html.ts","../../src/base-view.ts","../../src/data-source.ts","../../src/freeze-navbar.ts","../../src/freeze-table.ts","../../src/freeze-pathbar.ts","../../src/freeze-no-source.ts","../../src/freeze-browse.ts","../../node_modules/lit/node_modules/lit-html/directives/repeat.js","../../src/utils.ts","../../src/types.ts","../../src/crawler/xpath.ts","../../src/crawler/crawler.ts","../../src/crawler/course.ts","../../src/crawler/fileutil.ts","../../src/crawler/file.ts","../../src/crawler/page.ts","../../src/crawler/download-manager.ts","../../src/freeze-prompt.ts","../../src/freeze-download.ts","../../src/freeze-404.ts","../../node_modules/@vaadin/router/dist/vaadin-router.js","../../src/course-php.ts","../../src/routes.ts","../../src/freeze-sidemenu.ts","../../src/rewrite.ts","../../src/freeze-course.ts","../../src/freeze-index.ts","../../node_modules/idb/build/esm/wrap-idb-value.js","../../node_modules/idb/build/esm/index.js","../../src/freeze-app.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,e=Symbol(),n=new Map;class s{constructor(t,n){if(this._$cssResult$=!0,n!==e)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t}get styleSheet(){let e=n.get(this.cssText);return t&&void 0===e&&(n.set(this.cssText,e=new CSSStyleSheet),e.replaceSync(this.cssText)),e}toString(){return this.cssText}}const o=t=>new s(\"string\"==typeof t?t:t+\"\",e),r=(t,...n)=>{const o=1===t.length?t[0]:n.reduce(((e,n,s)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(n)+t[s+1]),t[0]);return new s(o,e)},i=(e,n)=>{t?e.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((t=>{const n=document.createElement(\"style\"),s=window.litNonce;void 0!==s&&n.setAttribute(\"nonce\",s),n.textContent=t.cssText,e.appendChild(n)}))},S=t?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const n of t.cssRules)e+=n.cssText;return o(e)})(t):t;export{s as CSSResult,i as adoptStyles,r as css,S as getCompatibleStyle,t as supportsAdoptingStyleSheets,o as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as i}from\"./css-tag.js\";export{CSSResult,adoptStyles,css,getCompatibleStyle,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */var s,e;const r={toAttribute(t,i){switch(i){case Boolean:t=t?\"\":null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,i){let s=t;switch(i){case Boolean:s=null!==t;break;case Number:s=null===t?null:Number(t);break;case Object:case Array:try{s=JSON.parse(t)}catch(t){s=null}}return s}},h=(t,i)=>i!==t&&(i==i||t==t),o={attribute:!0,type:String,converter:r,reflect:!1,hasChanged:h};class n extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(t){var i;null!==(i=this.l)&&void 0!==i||(this.l=[]),this.l.push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((i,s)=>{const e=this._$Eh(s,i);void 0!==e&&(this._$Eu.set(e,s),t.push(e))})),t}static createProperty(t,i=o){if(i.state&&(i.attribute=!1),this.finalize(),this.elementProperties.set(t,i),!i.noAccessor&&!this.prototype.hasOwnProperty(t)){const s=\"symbol\"==typeof t?Symbol():\"__\"+t,e=this.getPropertyDescriptor(t,s,i);void 0!==e&&Object.defineProperty(this.prototype,t,e)}}static getPropertyDescriptor(t,i,s){return{get(){return this[i]},set(e){const r=this[t];this[i]=e,this.requestUpdate(t,r,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||o}static finalize(){if(this.hasOwnProperty(\"finalized\"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Eu=new Map,this.hasOwnProperty(\"properties\")){const t=this.properties,i=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const s of i)this.createProperty(s,t[s])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(i){const s=[];if(Array.isArray(i)){const e=new Set(i.flat(1/0).reverse());for(const i of e)s.unshift(t(i))}else void 0!==i&&s.push(t(i));return s}static _$Eh(t,i){const s=i.attribute;return!1===s?void 0:\"string\"==typeof s?s:\"string\"==typeof t?t.toLowerCase():void 0}o(){var t;this._$Ev=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Ep(),this.requestUpdate(),null===(t=this.constructor.l)||void 0===t||t.forEach((t=>t(this)))}addController(t){var i,s;(null!==(i=this._$Em)&&void 0!==i?i:this._$Em=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(s=t.hostConnected)||void 0===s||s.call(t))}removeController(t){var i;null===(i=this._$Em)||void 0===i||i.splice(this._$Em.indexOf(t)>>>0,1)}_$Ep(){this.constructor.elementProperties.forEach(((t,i)=>{this.hasOwnProperty(i)&&(this._$Et.set(i,this[i]),delete this[i])}))}createRenderRoot(){var t;const s=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return i(s,this.constructor.elementStyles),s}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$Em)||void 0===t||t.forEach((t=>{var i;return null===(i=t.hostConnected)||void 0===i?void 0:i.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$Em)||void 0===t||t.forEach((t=>{var i;return null===(i=t.hostDisconnected)||void 0===i?void 0:i.call(t)}))}attributeChangedCallback(t,i,s){this._$AK(t,s)}_$Eg(t,i,s=o){var e,h;const n=this.constructor._$Eh(t,s);if(void 0!==n&&!0===s.reflect){const o=(null!==(h=null===(e=s.converter)||void 0===e?void 0:e.toAttribute)&&void 0!==h?h:r.toAttribute)(i,s.type);this._$Ei=t,null==o?this.removeAttribute(n):this.setAttribute(n,o),this._$Ei=null}}_$AK(t,i){var s,e,h;const o=this.constructor,n=o._$Eu.get(t);if(void 0!==n&&this._$Ei!==n){const t=o.getPropertyOptions(n),l=t.converter,a=null!==(h=null!==(e=null===(s=l)||void 0===s?void 0:s.fromAttribute)&&void 0!==e?e:\"function\"==typeof l?l:null)&&void 0!==h?h:r.fromAttribute;this._$Ei=n,this[n]=a(i,t.type),this._$Ei=null}}requestUpdate(t,i,s){let e=!0;void 0!==t&&(((s=s||this.constructor.getPropertyOptions(t)).hasChanged||h)(this[t],i)?(this._$AL.has(t)||this._$AL.set(t,i),!0===s.reflect&&this._$Ei!==t&&(void 0===this._$ES&&(this._$ES=new Map),this._$ES.set(t,s))):e=!1),!this.isUpdatePending&&e&&(this._$Ev=this._$EC())}async _$EC(){this.isUpdatePending=!0;try{await this._$Ev}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Et&&(this._$Et.forEach(((t,i)=>this[i]=t)),this._$Et=void 0);let i=!1;const s=this._$AL;try{i=this.shouldUpdate(s),i?(this.willUpdate(s),null===(t=this._$Em)||void 0===t||t.forEach((t=>{var i;return null===(i=t.hostUpdate)||void 0===i?void 0:i.call(t)})),this.update(s)):this._$ET()}catch(t){throw i=!1,this._$ET(),t}i&&this._$AE(s)}willUpdate(t){}_$AE(t){var i;null===(i=this._$Em)||void 0===i||i.forEach((t=>{var i;return null===(i=t.hostUpdated)||void 0===i?void 0:i.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ev}shouldUpdate(t){return!0}update(t){void 0!==this._$ES&&(this._$ES.forEach(((t,i)=>this._$Eg(i,this[i],t))),this._$ES=void 0),this._$ET()}updated(t){}firstUpdated(t){}}n.finalized=!0,n.elementProperties=new Map,n.elementStyles=[],n.shadowRootOptions={mode:\"open\"},null===(s=globalThis.reactiveElementPolyfillSupport)||void 0===s||s.call(globalThis,{ReactiveElement:n}),(null!==(e=globalThis.reactiveElementVersions)&&void 0!==e?e:globalThis.reactiveElementVersions=[]).push(\"1.0.0\");export{n as ReactiveElement,r as defaultConverter,h as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nvar t,i;const s=globalThis.trustedTypes,e=s?s.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,o=`lit$${(Math.random()+\"\").slice(9)}$`,n=\"?\"+o,l=`<${n}>`,h=document,r=(t=\"\")=>h.createComment(t),d=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,u=Array.isArray,v=t=>{var i;return u(t)||\"function\"==typeof(null===(i=t)||void 0===i?void 0:i[Symbol.iterator])},c=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,a=/-->/g,f=/>/g,_=/>|[ \t\\n\f\\r](?:([^\\s\"'>=/]+)([ \t\\n\f\\r]*=[ \t\\n\f\\r]*(?:[^ \t\\n\f\\r\"'`<>=]|(\"|')|))|$)/g,g=/'/g,m=/\"/g,$=/^(?:script|style|textarea)$/i,p=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),y=p(1),b=p(2),T=Symbol.for(\"lit-noChange\"),x=Symbol.for(\"lit-nothing\"),w=new WeakMap,A=(t,i,s)=>{var e,o;const n=null!==(e=null==s?void 0:s.renderBefore)&&void 0!==e?e:i;let l=n._$litPart$;if(void 0===l){const t=null!==(o=null==s?void 0:s.renderBefore)&&void 0!==o?o:null;n._$litPart$=l=new S(i.insertBefore(r(),t),t,void 0,null!=s?s:{})}return l._$AI(t),l},C=h.createTreeWalker(h,129,null,!1),P=(t,i)=>{const s=t.length-1,n=[];let h,r=2===i?\"<svg>\":\"\",d=c;for(let i=0;i<s;i++){const s=t[i];let e,u,v=-1,p=0;for(;p<s.length&&(d.lastIndex=p,u=d.exec(s),null!==u);)p=d.lastIndex,d===c?\"!--\"===u[1]?d=a:void 0!==u[1]?d=f:void 0!==u[2]?($.test(u[2])&&(h=RegExp(\"</\"+u[2],\"g\")),d=_):void 0!==u[3]&&(d=_):d===_?\">\"===u[0]?(d=null!=h?h:c,v=-1):void 0===u[1]?v=-2:(v=d.lastIndex-u[2].length,e=u[1],d=void 0===u[3]?_:'\"'===u[3]?m:g):d===m||d===g?d=_:d===a||d===f?d=c:(d=_,h=void 0);const y=d===_&&t[i+1].startsWith(\"/>\")?\" \":\"\";r+=d===c?s+l:v>=0?(n.push(e),s.slice(0,v)+\"$lit$\"+s.slice(v)+o+y):s+o+(-2===v?(n.push(void 0),i):y)}const u=r+(t[s]||\"<?>\")+(2===i?\"</svg>\":\"\");return[void 0!==e?e.createHTML(u):u,n]};class V{constructor({strings:t,_$litType$:i},e){let l;this.parts=[];let h=0,d=0;const u=t.length-1,v=this.parts,[c,a]=P(t,i);if(this.el=V.createElement(c,e),C.currentNode=this.el.content,2===i){const t=this.el.content,i=t.firstChild;i.remove(),t.append(...i.childNodes)}for(;null!==(l=C.nextNode())&&v.length<u;){if(1===l.nodeType){if(l.hasAttributes()){const t=[];for(const i of l.getAttributeNames())if(i.endsWith(\"$lit$\")||i.startsWith(o)){const s=a[d++];if(t.push(i),void 0!==s){const t=l.getAttribute(s.toLowerCase()+\"$lit$\").split(o),i=/([.?@])?(.*)/.exec(s);v.push({type:1,index:h,name:i[2],strings:t,ctor:\".\"===i[1]?k:\"?\"===i[1]?H:\"@\"===i[1]?I:M})}else v.push({type:6,index:h})}for(const i of t)l.removeAttribute(i)}if($.test(l.tagName)){const t=l.textContent.split(o),i=t.length-1;if(i>0){l.textContent=s?s.emptyScript:\"\";for(let s=0;s<i;s++)l.append(t[s],r()),C.nextNode(),v.push({type:2,index:++h});l.append(t[i],r())}}}else if(8===l.nodeType)if(l.data===n)v.push({type:2,index:h});else{let t=-1;for(;-1!==(t=l.data.indexOf(o,t+1));)v.push({type:7,index:h}),t+=o.length-1}h++}}static createElement(t,i){const s=h.createElement(\"template\");return s.innerHTML=t,s}}function E(t,i,s=t,e){var o,n,l,h;if(i===T)return i;let r=void 0!==e?null===(o=s._$Cl)||void 0===o?void 0:o[e]:s._$Cu;const u=d(i)?void 0:i._$litDirective$;return(null==r?void 0:r.constructor)!==u&&(null===(n=null==r?void 0:r._$AO)||void 0===n||n.call(r,!1),void 0===u?r=void 0:(r=new u(t),r._$AT(t,s,e)),void 0!==e?(null!==(l=(h=s)._$Cl)&&void 0!==l?l:h._$Cl=[])[e]=r:s._$Cu=r),void 0!==r&&(i=E(t,r._$AS(t,i.values),r,e)),i}class N{constructor(t,i){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var i;const{el:{content:s},parts:e}=this._$AD,o=(null!==(i=null==t?void 0:t.creationScope)&&void 0!==i?i:h).importNode(s,!0);C.currentNode=o;let n=C.nextNode(),l=0,r=0,d=e[0];for(;void 0!==d;){if(l===d.index){let i;2===d.type?i=new S(n,n.nextSibling,this,t):1===d.type?i=new d.ctor(n,d.name,d.strings,this,t):6===d.type&&(i=new L(n,this,t)),this.v.push(i),d=e[++r]}l!==(null==d?void 0:d.index)&&(n=C.nextNode(),l++)}return o}m(t){let i=0;for(const s of this.v)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class S{constructor(t,i,s,e){var o;this.type=2,this._$AH=x,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cg=null===(o=null==e?void 0:e.isConnected)||void 0===o||o}get _$AU(){var t,i;return null!==(i=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==i?i:this._$Cg}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=E(this,t,i),d(t)?t===x||null==t||\"\"===t?(this._$AH!==x&&this._$AR(),this._$AH=x):t!==this._$AH&&t!==T&&this.$(t):void 0!==t._$litType$?this.T(t):void 0!==t.nodeType?this.S(t):v(t)?this.M(t):this.$(t)}A(t,i=this._$AB){return this._$AA.parentNode.insertBefore(t,i)}S(t){this._$AH!==t&&(this._$AR(),this._$AH=this.A(t))}$(t){this._$AH!==x&&d(this._$AH)?this._$AA.nextSibling.data=t:this.S(h.createTextNode(t)),this._$AH=t}T(t){var i;const{values:s,_$litType$:e}=t,o=\"number\"==typeof e?this._$AC(t):(void 0===e.el&&(e.el=V.createElement(e.h,this.options)),e);if((null===(i=this._$AH)||void 0===i?void 0:i._$AD)===o)this._$AH.m(s);else{const t=new N(o,this),i=t.p(this.options);t.m(s),this.S(i),this._$AH=t}}_$AC(t){let i=w.get(t.strings);return void 0===i&&w.set(t.strings,i=new V(t)),i}M(t){u(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const o of t)e===i.length?i.push(s=new S(this.A(r()),this.A(r()),this,this.options)):s=i[e],s._$AI(o),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){var i;void 0===this._$AM&&(this._$Cg=t,null===(i=this._$AP)||void 0===i||i.call(this,t))}}class M{constructor(t,i,s,e,o){this.type=1,this._$AH=x,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=o,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=x}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,i=this,s,e){const o=this.strings;let n=!1;if(void 0===o)t=E(this,t,i,0),n=!d(t)||t!==this._$AH&&t!==T,n&&(this._$AH=t);else{const e=t;let l,h;for(t=o[0],l=0;l<o.length-1;l++)h=E(this,e[s+l],i,l),h===T&&(h=this._$AH[l]),n||(n=!d(h)||h!==this._$AH[l]),h===x?t=x:t!==x&&(t+=(null!=h?h:\"\")+o[l+1]),this._$AH[l]=h}n&&!e&&this.k(t)}k(t){t===x?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:\"\")}}class k extends M{constructor(){super(...arguments),this.type=3}k(t){this.element[this.name]=t===x?void 0:t}}class H extends M{constructor(){super(...arguments),this.type=4}k(t){t&&t!==x?this.element.setAttribute(this.name,\"\"):this.element.removeAttribute(this.name)}}class I extends M{constructor(t,i,s,e,o){super(t,i,s,e,o),this.type=5}_$AI(t,i=this){var s;if((t=null!==(s=E(this,t,i,0))&&void 0!==s?s:x)===T)return;const e=this._$AH,o=t===x&&e!==x||t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive,n=t!==x&&(e===x||o);o&&this.element.removeEventListener(this.name,this,e),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var i,s;\"function\"==typeof this._$AH?this._$AH.call(null!==(s=null===(i=this.options)||void 0===i?void 0:i.host)&&void 0!==s?s:this.element,t):this._$AH.handleEvent(t)}}class L{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){E(this,t)}}const R={P:\"$lit$\",V:o,L:n,I:1,N:P,R:N,D:v,j:E,H:S,O:M,F:H,B:I,W:k,Z:L};null===(t=globalThis.litHtmlPolyfillSupport)||void 0===t||t.call(globalThis,V,S),(null!==(i=globalThis.litHtmlVersions)&&void 0!==i?i:globalThis.litHtmlVersions=[]).push(\"2.0.0\");export{R as _$LH,y as html,T as noChange,x as nothing,A as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as i}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */var l,o,r;const s=t;class n extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Dt=e(i,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!1)}render(){return i}}n.finalized=!0,n._$litElement$=!0,null===(l=globalThis.litElementHydrateSupport)||void 0===l||l.call(globalThis,{LitElement:n}),null===(o=globalThis.litElementPolyfillSupport)||void 0===o||o.call(globalThis,{LitElement:n});const h={_$AK:(t,e,i)=>{t._$AK(e,i)},_$AL:t=>t._$AL};(null!==(r=globalThis.litElementVersions)&&void 0!==r?r:globalThis.litElementVersions=[]).push(\"3.0.0\");export{n as LitElement,s as UpdatingElement,h as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst n=n=>e=>\"function\"==typeof e?((n,e)=>(window.customElements.define(n,e),e))(n,e):((n,e)=>{const{kind:t,elements:i}=e;return{kind:t,elements:i,finisher(e){window.customElements.define(n,e)}}})(n,e);export{n as customElement};\n//# sourceMappingURL=custom-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst i=(i,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,i)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,i)}};function e(e){return(n,t)=>void 0!==t?((i,e,n)=>{e.constructor.createProperty(n,i)})(e,n,t):i(e,n)}export{e as property};\n//# sourceMappingURL=property.js.map\n","import{property as r}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function t(t){return r({...t,state:!0})}export{t as state};\n//# sourceMappingURL=state.js.map\n","import{decorateProperty as o}from\"./base.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function i(i,n){return o({descriptor:o=>{const t={get(){var o,n;return null!==(n=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(i))&&void 0!==n?n:null},enumerable:!0,configurable:!0};if(n){const n=\"symbol\"==typeof o?Symbol():\"__\"+o;t.get=function(){var o,t;return void 0===this[n]&&(this[n]=null!==(t=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(i))&&void 0!==t?t:null),this[n]}}return t}})}export{i as query};\n//# sourceMappingURL=query.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst e=(e,t,o)=>{Object.defineProperty(t,o,e)},t=(e,t)=>({kind:\"method\",placement:\"prototype\",key:t.key,descriptor:e}),o=({finisher:e,descriptor:t})=>(o,n)=>{var r;if(void 0===n){const n=null!==(r=o.originalKey)&&void 0!==r?r:o.key,i=null!=t?{kind:\"method\",placement:\"prototype\",key:n,descriptor:t(o.key)}:{...o,key:n};return null!=e&&(i.finisher=function(t){e(t,n)}),i}{const r=o.constructor;void 0!==t&&Object.defineProperty(o,n,t(n)),null==e||e(r,n)}};export{o as decorateProperty,e as legacyPrototypeMethod,t as standardPrototypeMethod};\n//# sourceMappingURL=base.js.map\n","import{_$LH as o}from\"./lit-html.js\";\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{H:i}=o,t=o=>null===o||\"object\"!=typeof o&&\"function\"!=typeof o,n={HTML:1,SVG:2},v=(o,i)=>{var t,n;return void 0===i?void 0!==(null===(t=o)||void 0===t?void 0:t._$litType$):(null===(n=o)||void 0===n?void 0:n._$litType$)===i},l=o=>{var i;return void 0!==(null===(i=o)||void 0===i?void 0:i._$litDirective$)},d=o=>{var i;return null===(i=o)||void 0===i?void 0:i._$litDirective$},r=o=>void 0===o.strings,e=()=>document.createComment(\"\"),u=(o,t,n)=>{var v;const l=o._$AA.parentNode,d=void 0===t?o._$AB:t._$AA;if(void 0===n){const t=l.insertBefore(e(),d),v=l.insertBefore(e(),d);n=new i(t,v,o,o.options)}else{const i=n._$AB.nextSibling,t=n._$AM,r=t!==o;if(r){let i;null===(v=n._$AQ)||void 0===v||v.call(n,o),n._$AM=o,void 0!==n._$AP&&(i=o._$AU)!==t._$AU&&n._$AP(i)}if(i!==d||r){let o=n._$AA;for(;o!==i;){const i=o.nextSibling;l.insertBefore(o,d),o=i}}}return n},c=(o,i,t=o)=>(o._$AI(i,t),o),f={},s=(o,i=f)=>o._$AH=i,a=o=>o._$AH,m=o=>{var i;null===(i=o._$AP)||void 0===i||i.call(o,!1,!0);let t=o._$AA;const n=o._$AB.nextSibling;for(;t!==n;){const o=t.nextSibling;t.remove(),t=o}},p=o=>{o._$AR()};export{n as TemplateResultType,p as clearPart,a as getCommittedValue,d as getDirectiveClass,u as insertPart,l as isDirectiveResult,t as isPrimitive,r as isSingleExpression,v as isTemplateResult,m as removePart,c as setChildPartValue,s as setCommittedValue};\n//# sourceMappingURL=directive-helpers.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{isSingleExpression as i}from\"./directive-helpers.js\";import{Directive as t,PartType as s}from\"./directive.js\";export{directive}from\"./directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const e=(i,t)=>{var s,o;const n=i._$AN;if(void 0===n)return!1;for(const i of n)null===(o=(s=i)._$AO)||void 0===o||o.call(s,t,!1),e(i,t);return!0},o=i=>{let t,s;do{if(void 0===(t=i._$AM))break;s=t._$AN,s.delete(i),i=t}while(0===(null==s?void 0:s.size))},n=i=>{for(let t;t=i._$AM;i=t){let s=t._$AN;if(void 0===s)t._$AN=s=new Set;else if(s.has(i))break;s.add(i),l(t)}};function r(i){void 0!==this._$AN?(o(this),this._$AM=i,n(this)):this._$AM=i}function h(i,t=!1,s=0){const n=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(t)if(Array.isArray(n))for(let i=s;i<n.length;i++)e(n[i],!1),o(n[i]);else null!=n&&(e(n,!1),o(n));else e(this,i)}const l=i=>{var t,e,o,n;i.type==s.CHILD&&(null!==(t=(o=i)._$AP)&&void 0!==t||(o._$AP=h),null!==(e=(n=i)._$AQ)&&void 0!==e||(n._$AQ=r))};class d extends t{constructor(){super(...arguments),this._$AN=void 0}_$AT(i,t,s){super._$AT(i,t,s),n(this),this.isConnected=i._$AU}_$AO(i,t=!0){var s,n;i!==this.isConnected&&(this.isConnected=i,i?null===(s=this.reconnected)||void 0===s||s.call(this):null===(n=this.disconnected)||void 0===n||n.call(this)),t&&(e(this,i),o(this))}setValue(t){if(i(this._$Ct))this._$Ct._$AI(t,this);else{const i=[...this._$Ct._$AH];i[this._$Ci]=t,this._$Ct._$AI(i,this,0)}}disconnected(){}reconnected(){}}export{d as AsyncDirective};\n//# sourceMappingURL=async-directive.js.map\n","import{nothing as t}from\"../lit-html.js\";import{AsyncDirective as i}from\"../async-directive.js\";import{directive as s}from\"../directive.js\";\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const e=()=>new o;class o{}const h=new WeakMap,n=s(class extends i{render(i){return t}update(i,[s]){var e;const o=s!==this.U;return o&&void 0!==this.U&&this.nt(void 0),(o||this.rt!==this.lt)&&(this.U=s,this.ht=null===(e=i.options)||void 0===e?void 0:e.host,this.nt(this.lt=i.element)),t}nt(t){\"function\"==typeof this.U?(void 0!==h.get(this.U)&&this.U.call(this.ht,void 0),h.set(this.U,t),void 0!==t&&this.U.call(this.ht,t)):this.U.value=t}get rt(){var t;return\"function\"==typeof this.U?h.get(this.U):null===(t=this.U)||void 0===t?void 0:t.value}disconnected(){this.rt===this.lt&&this.nt(void 0)}reconnected(){this.nt(this.lt)}});export{e as createRef,n as ref};\n//# sourceMappingURL=ref.js.map\n","import{noChange as t}from\"../lit-html.js\";import{directive as i,Directive as s,PartType as r}from\"../directive.js\";\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const o=i(class extends s{constructor(t){var i;if(super(t),t.type!==r.ATTRIBUTE||\"class\"!==t.name||(null===(i=t.strings)||void 0===i?void 0:i.length)>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter((i=>t[i])).join(\" \")+\" \"}update(i,[s]){var r,o;if(void 0===this.st){this.st=new Set,void 0!==i.strings&&(this.et=new Set(i.strings.join(\" \").split(/\\s/).filter((t=>\"\"!==t))));for(const t in s)s[t]&&!(null===(r=this.et)||void 0===r?void 0:r.has(t))&&this.st.add(t);return this.render(s)}const e=i.element.classList;this.st.forEach((t=>{t in s||(e.remove(t),this.st.delete(t))}));for(const t in s){const i=!!s[t];i===this.st.has(t)||(null===(o=this.et)||void 0===o?void 0:o.has(t))||(i?(e.add(t),this.st.add(t)):(e.remove(t),this.st.delete(t)))}return t}});export{o as classMap};\n//# sourceMappingURL=class-map.js.map\n","// https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\nexport class RenderableError extends Error {\n  title: string;\n  constructor(title: string, message: string) {\n    super(message);\n    this.title = title;\n    Object.setPrototypeOf(this, RenderableError.prototype);\n  }\n}\n\nexport const error404 = (message = \"Page not found\") =>\n  new RenderableError(\"404\", message);\n\nconst 佛心 = new RenderableError(\"╰(⊙д⊙)╮\", \"Open a directory to get started\");\nconst 公司 = new RenderableError(\"╭(⊙д⊙)╯\", 佛心.message);\nexport const errorNoSource = () => (Math.random() < 0.5 ? 佛心 : 公司);\n\nexport const error400 = (message: string) =>\n  new RenderableError(\"ヽ(´ー｀)┌\", message);\n\nexport const badsource = (message: string) =>\n  error400(`Bad data source: ${message}`);\n\nexport const error403 = (message: string) =>\n  new RenderableError(\"（・Ａ・）\", message);\n","import{noChange as t}from\"../lit-html.js\";import{directive as e,Directive as r,PartType as s}from\"../directive.js\";\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const i=e(class extends r{constructor(t){var e;if(super(t),t.type!==s.ATTRIBUTE||\"style\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((e,r)=>{const s=t[r];return null==s?e:e+`${r=r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${s};`}),\"\")}update(e,[r]){const{style:s}=e.element;if(void 0===this.ut){this.ut=new Set;for(const t in r)this.ut.add(t);return this.render(r)}this.ut.forEach((t=>{null==r[t]&&(this.ut.delete(t),t.includes(\"-\")?s.removeProperty(t):s[t]=\"\")}));for(const t in r){const e=r[t];null!=e&&(this.ut.add(t),t.includes(\"-\")?s.setProperty(t,e):s[t]=e)}return t}});export{i as styleMap};\n//# sourceMappingURL=style-map.js.map\n","import{nothing as t,noChange as i}from\"../lit-html.js\";import{Directive as r,PartType as s,directive as n}from\"../directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends r{constructor(i){if(super(i),this.it=t,i.type!==s.CHILD)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(r){if(r===t||null==r)return this.vt=void 0,this.it=r;if(r===i)return r;if(\"string\"!=typeof r)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(r===this.it)return this.vt;this.it=r;const s=[r];return s.raw=s,this.vt={_$litType$:this.constructor.resultType,strings:s,values:[]}}}e.directiveName=\"unsafeHTML\",e.resultType=1;const o=n(e);export{e as UnsafeHTMLDirective,o as unsafeHTML};\n//# sourceMappingURL=unsafe-html.js.map\n","import { html, TemplateResult } from \"lit\";\nimport { classMap } from \"lit/directives/class-map.js\";\nimport { StyleInfo, styleMap } from \"lit/directives/style-map.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\nimport { RenderableError } from \"./errors\";\n\nexport const materialIcon = (\n  name: string,\n  styles: StyleInfo = { \"font-size\": \"inherit\" }\n) =>\n  html`<span class=\"icon\">\n    <span class=\"material-icons\" style=${styleMap(styles)}>${name}</span>\n  </span>`;\n\nexport const unsafeContent = (content: string) =>\n  html`<div class=\"content\">${unsafeHTML(content)}</div>`;\n\nexport const externalLink = (\n  text: string,\n  url: string,\n  classes: Record<string, boolean> = {}\n) =>\n  html`<a target=\"_blank\" href=${url} class=${classMap(\n    classes\n  )}><span class=\"icon-text\">${text}</span>${materialIcon(\n    \"open_in_new\"\n  )}</span></a>`;\n\nexport type statusClass = {\n  iconName: string;\n  cssClass: string;\n};\n\nexport const statusSuccess: statusClass = {\n  iconName: \"check\",\n  cssClass: \"has-text-success\",\n};\n\nexport const statusUnknown: statusClass = {\n  iconName: \"hourglass_empty\",\n  cssClass: \"\",\n};\n\nexport const statusWarn: statusClass = {\n  iconName: \"warning\",\n  cssClass: \"has-text-warning\",\n};\n\nexport const statusFail: statusClass = {\n  iconName: \"error\",\n  cssClass: \"has-text-danger\",\n};\n\nexport const renderStatus = (\n  cls: statusClass,\n  text: TemplateResult | string\n) => {\n  return html`<span class=\"icon-text\">\n    <span class=\"${cls.cssClass}\">${materialIcon(cls.iconName)}</span>\n    <span>${text}</span>\n  </span>`;\n};\n\nexport const renderError = (err: RenderableError) => {\n  const classes = {\n    \"has-text-centered\": true,\n    oops: true,\n    x2: err.title === \"404\",\n  };\n  return html`<div>\n    <div class=\"${classMap(classes)}\">${err.title}</div>\n    <div class=\"has-text-centered\">${err.message}</div>\n  </div>`;\n};\n","import { Commands, RouterLocation } from \"@vaadin/router\";\nimport { html, LitElement, TemplateResult } from \"lit\";\nimport { DataSource } from \"./data-source\";\nimport { errorNoSource, RenderableError } from \"./errors\";\nimport { renderError } from \"./html\";\nimport { RouterSource } from \"./routes\";\n\nexport abstract class DirectoryChangeAwareView extends LitElement {\n  private subscribedTo?: Element;\n  private directoryChangedListener: EventListener;\n\n  constructor() {\n    super();\n    this.directoryChangedListener = (e: Event) => {\n      this.handleDirectoryChange((e as CustomEvent).detail as DataSource);\n    };\n  }\n\n  private async subscribe(e: Element, dataSource?: DataSource) {\n    this.subscribedTo = e;\n    if (dataSource !== undefined) {\n      await this.handleDirectoryChange(dataSource);\n    }\n    e.addEventListener(\"directory-changed\", this.directoryChangedListener);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    const options = {\n      detail: async (e: Element, dataSource?: DataSource) => {\n        await this.subscribe(e, dataSource);\n      },\n      bubbles: true,\n    };\n    this.dispatchEvent(new CustomEvent(\"subscribe\", options));\n  }\n\n  disconnectedCallback() {\n    this.subscribedTo?.removeEventListener(\n      \"directory-changed\",\n      this.directoryChangedListener\n    );\n  }\n\n  abstract handleDirectoryChange(dataSource: DataSource): any;\n}\n\nexport abstract class BaseView extends DirectoryChangeAwareView {\n  location?: RouterLocation;\n  activeUrl?: string;\n  router?: RouterSource;\n  private error?: RenderableError;\n\n  createRenderRoot() {\n    return this;\n  }\n\n  async onBeforeEnter(\n    location: RouterLocation,\n    _: Commands,\n    router: RouterSource\n  ) {\n    this.router = router;\n    this.activeUrl = location.pathname;\n    if (router.dataSource !== undefined) {\n      await this.prepareStateProtected(router.dataSource);\n    }\n  }\n\n  async handleDirectoryChange(dataSource: DataSource) {\n    await this.prepareStateProtected(dataSource);\n    this.requestUpdate();\n  }\n\n  private async prepareStateProtected(source: DataSource) {\n    try {\n      await this.prepareState(this.location!, source);\n    } catch (e) {\n      if (e instanceof RenderableError) {\n        this.error = e;\n        return;\n      }\n      this.error = new RenderableError(\n        \"(╯°□°)╯︵ ┻┻\",\n        \"Something really bad happened. Please report a bug.\"\n      );\n      console.error(e);\n      return;\n    }\n    this.error = undefined;\n  }\n\n  render() {\n    if (this.error !== undefined) {\n      return renderError(this.error);\n    }\n    if (this.router!.dataSource === undefined) {\n      return renderError(errorNoSource());\n    }\n    return this.renderState();\n  }\n\n  abstract prepareState(\n    _location: RouterLocation,\n    _source: DataSource\n  ): Promise<any>;\n\n  abstract renderState(): TemplateResult;\n}\n\nexport abstract class BrowseBaseView extends BaseView {\n  header: string | null = null;\n\n  async prepareState(_location: RouterLocation, source: DataSource) {\n    this.header = await source.header();\n  }\n\n  renderHeader() {\n    if (this.header === null) {\n      return undefined;\n    }\n    return html`<div class=\"notification\">${this.header}</div>`;\n  }\n}\n","import { badsource, error404, RenderableError } from \"./errors\";\n\nconst warnAndThrow = (e: any): never => {\n  console.warn(e);\n  throw badsource(`\"${e}\"`);\n};\n\nexport abstract class DataSource {\n  abstract get name(): string;\n  abstract header(): Promise<string | null>;\n  abstract get(typename: string, id: number, filename: string): Promise<Blob>;\n  abstract getAllMeta(typename: string): Promise<Array<any>>;\n\n  async getText(typename: string, id: number, filename: string) {\n    const file = await this.get(typename, id, filename);\n    return await file.text();\n  }\n\n  async getJson(typename: string, id: number, filename: string) {\n    const txt = await this.getText(typename, id, filename);\n    try {\n      return JSON.parse(txt);\n    } catch (e) {\n      warnAndThrow(e);\n    }\n  }\n\n  async getMeta(typename: string, id: number) {\n    return await this.getJson(typename, id, \"meta.json\");\n  }\n\n  async getMetas(typename: string, ids: Array<number> | undefined) {\n    if (ids === undefined) {\n      return [];\n    }\n    const result = [];\n    for (const id of ids) {\n      result.push(await this.getMeta(typename, id));\n    }\n    return result;\n  }\n}\n\nconst isNotFoundError = (e: any) => {\n  return e instanceof Error && e.name === \"NotFoundError\";\n};\n\nconst find = async <T>(\n  promise: Promise<T>,\n  notFound: () => RenderableError\n) => {\n  try {\n    return await promise;\n  } catch (e) {\n    if (isNotFoundError(e)) {\n      throw notFound();\n    }\n    throw e;\n  }\n};\n\nexport class FileSystemDataSource extends DataSource {\n  rootHandle: FileSystemDirectoryHandle;\n\n  constructor(rootHandle: FileSystemDirectoryHandle) {\n    super();\n    this.rootHandle = rootHandle;\n  }\n\n  async header() {\n    return null;\n  }\n\n  get name() {\n    return this.rootHandle.name;\n  }\n\n  async get(typename: string, id: number, filename: string) {\n    const typeDir = await find(\n      this.rootHandle.getDirectoryHandle(typename),\n      () => badsource(`missing directory \"${typename}\"`)\n    );\n    const objDir = await find(typeDir.getDirectoryHandle(id.toString()), () =>\n      error404(`${typename} not found`)\n    );\n    const fileHandle = await find(objDir.getFileHandle(filename), () =>\n      badsource(`missing file ${typename}/${objDir}/${filename}`)\n    );\n    return await fileHandle.getFile();\n  }\n\n  async getAllMeta(typename: string) {\n    const result = [];\n    const typeDir = await find(\n      this.rootHandle.getDirectoryHandle(typename),\n      () => badsource(`missing directory \"${typename}\"`)\n    );\n    for await (const entry of typeDir.values()) {\n      if (entry.kind !== \"directory\") {\n        continue;\n      }\n      const metaHandlePromise = entry.getFileHandle(\"meta.json\");\n      try {\n        await metaHandlePromise;\n      } catch (e) {\n        if (isNotFoundError(e)) {\n          console.warn(`missing meta.json for ${typename}/${entry.name}`);\n          continue;\n        } else {\n          throw e;\n        }\n      }\n      const metaFile = await (await metaHandlePromise).getFile();\n      const meta = JSON.parse(await metaFile.text());\n      result.push(meta);\n    }\n    return result;\n  }\n}\n\nexport class RemoteDataSource extends DataSource {\n  baseURL: string;\n\n  constructor(baseURL: string) {\n    super();\n    this.baseURL = baseURL;\n  }\n\n  get name() {\n    return this.baseURL;\n  }\n\n  async header() {\n    const resp = await this.fetch(\"source.json\");\n    try {\n      const json = await resp.json();\n      return json.header;\n    } catch (e) {\n      warnAndThrow(e);\n    }\n    return null;\n  }\n\n  private async fetch(path: string) {\n    const url = new URL(path, this.baseURL).toString();\n    let resp: Response;\n    try {\n      resp = await fetch(url);\n    } catch (e) {\n      warnAndThrow(e);\n    }\n    resp = resp!;\n    if (resp.status !== 200) {\n      throw new RenderableError(\n        resp.status.toString(),\n        `${url} ${resp.statusText}`\n      );\n    }\n    return resp;\n  }\n\n  async get(typename: string, id: number, filename: string) {\n    const resp = await this.fetch(`${typename}/${id}/${filename}`);\n    return await resp.blob();\n  }\n\n  async getAllMeta(typename: string) {\n    const resp = await this.fetch(`${typename}/all.json`);\n    try {\n      return await resp.json();\n    } catch (e) {\n      warnAndThrow(e);\n    }\n  }\n}\n\nexport const getSavedFilename = (meta: any) => {\n  // https://github.com/afq984/ilmsdump/blob/main/ilmsserve/__init__.py#L342\n  if (meta.saved_filename !== undefined) {\n    return meta.saved_filename;\n  }\n  if (meta.title === \"meta.json\") {\n    return \"meta_.json\";\n  }\n  return meta.title;\n};\n\nexport const serializeDataSource = (dataSource: DataSource) => {\n  if (dataSource instanceof FileSystemDataSource) {\n    return {\n      ty: \"FileSystemDataSource\",\n      data: dataSource.rootHandle,\n    };\n  } else if (dataSource instanceof RemoteDataSource) {\n    return {\n      ty: \"RemoteDataSource\",\n      data: dataSource.baseURL,\n    };\n  }\n  return null;\n};\n\nexport const deserializeDataSource = (obj: any) => {\n  if (obj.ty === \"FileSystemDataSource\") {\n    return new FileSystemDataSource(obj.data);\n  }\n  if (obj.ty == \"RemoteDataSource\") {\n    return new RemoteDataSource(obj.data);\n  }\n  return null;\n};\n","import { html } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\nimport { classMap } from \"lit/directives/class-map.js\";\nimport { DirectoryChangeAwareView } from \"./base-view\";\nimport {\n  DataSource,\n  FileSystemDataSource,\n  RemoteDataSource,\n} from \"./data-source\";\nimport { externalLink, materialIcon } from \"./html\";\n\n@customElement(\"freeze-navbar\")\nexport class FreezeNavbar extends DirectoryChangeAwareView {\n  @state()\n  directoryName = \"no directory\";\n  @state()\n  directoryAccess = \"unknown\";\n\n  createRenderRoot() {\n    return this;\n  }\n\n  async handleDirectoryChange(dataSource: DataSource) {\n    this.directoryName = dataSource.name;\n    if (dataSource instanceof FileSystemDataSource) {\n      const rootHandle = dataSource.rootHandle;\n      if ((await rootHandle.queryPermission({ mode: \"read\" })) !== \"granted\") {\n        this.directoryName = \"no directory\";\n        this.directoryAccess = \"unknown\";\n        return;\n      }\n      if (\n        (await rootHandle.queryPermission({ mode: \"readwrite\" })) === \"granted\"\n      ) {\n        this.directoryAccess = \"readwrite\";\n      } else {\n        this.directoryAccess = \"readonly\";\n      }\n    } else if (dataSource instanceof RemoteDataSource) {\n      this.directoryAccess = \"readonly\";\n    }\n  }\n\n  private renderDirectoryStatus() {\n    const directoryAccessClasses = {\n      tag: true,\n      \"is-success\": this.directoryAccess === \"readwrite\",\n      \"is-info\": this.directoryAccess === \"readonly\",\n      \"is-warning\": this.directoryAccess === \"unknown\",\n    };\n    return html`<div class=\"field is-grouped is-grouped-multiline\">\n      <div class=\"control\">\n        <div class=\"tags has-addons\">\n          <span class=\"tag is-dark\">${this.directoryName}</span>\n          <span class=${classMap(directoryAccessClasses)}\n            >${this.directoryAccess}</span\n          >\n        </div>\n      </div>\n    </div>`;\n  }\n\n  render() {\n    return html`<nav\n      class=\"navbar is-light\"\n      role=\"navigation\"\n      aria-label=\"main navigation\"\n    >\n      <section class=\"container\" style=\"display: flex\">\n        <div\n          style=\"display: flex; justify-content: flex-start; align-items: center;\"\n        >\n          <a class=\"navbar-item\" href=\"/\">\n            <strong>ilmsfreeze</strong>\n          </a>\n          <a href=\"/course/\" class=\"navbar-item\">Browse</a>\n          <a href=\"/download\" class=\"navbar-item\">Download</a>\n          ${externalLink(\"GitHub\", \"https://github.com/afq984/ilmsfreeze\", {\n            \"navbar-item\": true,\n          })}\n        </div>\n\n        <div\n          class=\"navbar-end\"\n          style=\"display: flex; justify-content: flex-end; align-items: center;\"\n        >\n          <div class=\"navbar-item\">${this.renderDirectoryStatus()}</div>\n          <div class=\"navbar-item\">${this.renderOpenButton()}</div>\n        </div>\n      </section>\n    </nav>`;\n  }\n\n  private renderOpenButton() {\n    return html`<div class=\"buttons\">\n      <button class=\"button is-primary\" @click=\"${this._dispatchClick}\">\n        <strong class=\"icon-text\"\n          >${materialIcon(\"folder\")}<span>Open...</span></strong\n        >\n      </button>\n    </div>`;\n  }\n\n  private _dispatchClick() {\n    const options = {\n      bubbles: true,\n      composed: true,\n    };\n    this.dispatchEvent(new CustomEvent(\"directory-open\", options));\n  }\n}\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nconst symbolAscending = \"⬆︎\";\nconst symbolDescending = \"⬇︎\";\n\ntype AttrFn = (item: any, attr: any) => any;\nexport interface TableFields {\n  [key: string]: AttrFn;\n}\nexport const textField: AttrFn = (_item: any, attr: any) => attr;\n\n@customElement(\"freeze-table\")\nexport class FreezeTable extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  @property({ attribute: false })\n  items: Array<any>;\n\n  @property({ attribute: false })\n  fields: TableFields;\n\n  @property()\n  sortField?: string;\n\n  @property({ type: Boolean })\n  sortDescending = false;\n\n  constructor() {\n    super();\n    this.items = [];\n    this.fields = {};\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.sortField !== undefined) {\n      this.sort();\n    }\n  }\n\n  sort() {\n    if (this.sortField === undefined) {\n      return;\n    }\n    const m = this.sortDescending ? -1 : 1;\n    const field = this.sortField;\n    this.items.sort(\n      (a, b) =>\n        ((a[field] > b[field] ? 1 : 0) - (a[field] < b[field] ? 1 : 0)) * m\n    );\n  }\n\n  toggleSort(field: string) {\n    if (this.sortField === field) {\n      this.sortDescending = !this.sortDescending;\n    } else {\n      this.sortField = field;\n      this.sortDescending = false;\n    }\n  }\n\n  willUpdate() {\n    if (this.sortField !== undefined) {\n      this.sort();\n    }\n  }\n\n  render() {\n    return html`\n    <table class=\"table\">\n      <tr>\n      ${Object.keys(this.fields).map(\n        (field) =>\n          html`<th\n            style=\"cursor: pointer; user-select: none\"\n            @click=${() => this.toggleSort(field)}\n          >\n            ${field}\n            ${field === this.sortField\n              ? this.sortDescending\n                ? symbolDescending\n                : symbolAscending\n              : \"\"}\n          </th>`\n      )}\n  </tr>\n  </tr>\n      ${this.items.map(\n        (item) =>\n          html`<tr>\n            ${Object.entries(this.fields).map(\n              ([field, attrFn]) => html`<td>${attrFn(item, item[field])}</td>`\n            )}\n          </tr>`\n      )}\n      </table>\n    `;\n  }\n}\n","import { html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport { materialIcon } from \"./html\";\n\nexport interface Fragment {\n  text: string | TemplateResult;\n  href: string;\n  active?: boolean;\n}\n\nexport const homeFragment = {\n  text: materialIcon(\"home\", { \"font-size\": \"1.25em\" }),\n  href: \"/course/\",\n};\n\nexport const fragmentsPush = (frags: Fragment[], f: Fragment) => {\n  frags[frags.length - 1].active = false;\n  frags.push(f);\n  return frags;\n};\n\n@customElement(\"freeze-pathbar\")\nexport class FreezePathbar extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  @property({ attribute: false })\n  fragments: Array<Fragment>;\n\n  constructor() {\n    super();\n    this.fragments = [];\n  }\n\n  render() {\n    return html`\n      <nav\n        class=\"breadcrumb\"\n        aria-label=\"breadcrumbs\"\n        style=\"margin-bottom: 1.5rem\"\n      >\n        <ul>\n          ${this.fragments.map(\n            (fragment) => html`\n              <li class=\"${fragment.active ? \"is-active\" : \"\"}\">\n                <a href=\"${fragment.href}\"> ${fragment.text} </a>\n              </li>\n            `\n          )}\n        </ul>\n      </nav>\n    `;\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement } from \"lit/decorators.js\";\n\n@customElement(\"freeze-no-source\")\nexport class FreezeNoSource extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  render() {\n    const 佛心 = \"╰(⊙д⊙)╮\";\n    const 公司 = \"╭(⊙д⊙)╯\";\n    return html`<div>\n      <div class=\"oops has-text-centered\">\n        ${Math.random() < 0.5 ? 佛心 : 公司}\n      </div>\n      <div class=\"has-text-centered\">Open a local directory to get started</div>\n    </div>`;\n  }\n}\n","import { html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport { RouterLocation } from \"@vaadin/router\";\n\nimport { BrowseBaseView } from \"./base-view.js\";\nimport { DataSource } from \"./data-source.js\";\nimport { TableFields, textField } from \"./freeze-table\";\nimport \"./freeze-pathbar\";\nimport { CourseMeta } from \"./types.js\";\nimport \"./freeze-no-source\";\n\n@customElement(\"freeze-browse\")\nexport class FreezeBrowse extends BrowseBaseView {\n  @property({ attribute: false })\n  courses: Array<CourseMeta> = [];\n\n  renderState() {\n    const linkfn = (item: CourseMeta, attr: any) => {\n      const url = this.router!.urlForName(\"freeze-course\", {\n        course_id: item.id.toString(),\n      });\n      return html`<a href=${url}>${attr}</a>`;\n    };\n    const fields: TableFields = {\n      id: linkfn,\n      serial: textField,\n      is_admin: textField,\n      name: linkfn,\n    };\n    return html`\n      ${this.renderHeader()}\n      <div class=\"columns\">\n        <div class=\"column\">\n          <freeze-table\n            sortField=\"id\"\n            .sortDescending=${true}\n            .items=${this.courses}\n            .fields=${fields}\n          ></freeze-table>\n        </div>\n      </div>\n    `;\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    super.prepareState(location, source);\n    this.courses = await source.getAllMeta(\"course\");\n  }\n}\n","import{noChange as e}from\"../lit-html.js\";import{directive as s,Directive as t,PartType as r}from\"../directive.js\";import{getCommittedValue as l,setChildPartValue as o,insertPart as i,removePart as n,setCommittedValue as f}from\"../directive-helpers.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst u=(e,s,t)=>{const r=new Map;for(let l=s;l<=t;l++)r.set(e[l],l);return r},c=s(class extends t{constructor(e){if(super(e),e.type!==r.CHILD)throw Error(\"repeat() can only be used in text expressions\")}dt(e,s,t){let r;void 0===t?t=s:void 0!==s&&(r=s);const l=[],o=[];let i=0;for(const s of e)l[i]=r?r(s,i):i,o[i]=t(s,i),i++;return{values:o,keys:l}}render(e,s,t){return this.dt(e,s,t).values}update(s,[t,r,c]){var d;const a=l(s),{values:p,keys:v}=this.dt(t,r,c);if(!Array.isArray(a))return this.ct=v,p;const h=null!==(d=this.ct)&&void 0!==d?d:this.ct=[],m=[];let y,x,j=0,k=a.length-1,w=0,A=p.length-1;for(;j<=k&&w<=A;)if(null===a[j])j++;else if(null===a[k])k--;else if(h[j]===v[w])m[w]=o(a[j],p[w]),j++,w++;else if(h[k]===v[A])m[A]=o(a[k],p[A]),k--,A--;else if(h[j]===v[A])m[A]=o(a[j],p[A]),i(s,m[A+1],a[j]),j++,A--;else if(h[k]===v[w])m[w]=o(a[k],p[w]),i(s,a[j],a[k]),k--,w++;else if(void 0===y&&(y=u(v,w,A),x=u(h,j,k)),y.has(h[j]))if(y.has(h[k])){const e=x.get(v[w]),t=void 0!==e?a[e]:null;if(null===t){const e=i(s,a[j]);o(e,p[w]),m[w]=e}else m[w]=o(t,p[w]),i(s,a[j],t),a[e]=null;w++}else n(a[k]),k--;else n(a[j]),j++;for(;w<=A;){const e=i(s,m[A+1]);o(e,p[w]),m[w++]=e}for(;j<=k;){const e=a[j++];null!==e&&n(e)}return this.ct=v,f(s,m),e}});export{c as repeat};\n//# sourceMappingURL=repeat.js.map\n","export const Bug = Error;\n\nexport const check = (condition: boolean, ...message: any) => {\n  if (!condition) {\n    throw new Bug(`check failed: ${message}`);\n  }\n};\n\nexport const notnull = <T>(value: T | null | undefined): T => {\n  if (value === null || value === undefined) {\n    throw new Bug();\n  }\n  return value;\n};\n\nexport const mustParseInt = (s: string) => {\n  const value = parseInt(s);\n  if (isFinite(value)) {\n    return value;\n  }\n  throw Bug;\n};\n","export type ChildrenMap = { [key: string]: Array<number> };\n\nexport const parseChildren = (children?: Array<string>) => {\n  if (children === undefined) {\n    return {};\n  }\n  const result: ChildrenMap = {};\n  for (const child of children) {\n    const [camelTypeName, id] = child.split(\"-\", 2);\n    const typename = camelTypeName.toLocaleLowerCase();\n    if (!(typename in result)) {\n      result[typename] = [];\n    }\n    result[typename].push(parseInt(id));\n  }\n  return result;\n};\n\nexport interface CourseMeta {\n  id: number;\n  serial: string;\n  is_admin: boolean;\n  name: string;\n  children?: Array<string>;\n}\nexport interface AnnouncementMeta {\n  id: number;\n  title: string;\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface MaterialMeta {\n  id: number;\n  title: string;\n  type: string;\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface DiscussionMeta {\n  id: number;\n  title: string;\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface HomeworkMeta {\n  id: number;\n  title: string;\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface SubmissionMeta {\n  id: number;\n  title: string;\n  by: string;\n  course: string;\n  comment: null | string;\n  children?: Array<string>;\n}\n\nexport interface AttachmentMeta {\n  id: number;\n  title: string;\n  parent: string;\n  saved_filename?: string;\n  children?: Array<string>;\n}\n\nexport interface ScoreMeta {\n  id: number; // ilmsdump's meta doesn't have id, it is inferred from course\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface GroupListMeta {\n  id: number; // ilmsdump's meta doesn't have id, it is inferred from course\n  course: string;\n  children?: Array<string>;\n}\n\nexport interface VideoMeta {\n  id: number;\n  url: string;\n}\n\nexport type Typename =\n  | \"Course\"\n  | \"Announcement\"\n  | \"Material\"\n  | \"Discussion\"\n  | \"Homework\"\n  | \"SubmittedHomework\"\n  | \"Attachment\"\n  | \"Score\"\n  | \"GroupList\"\n  | \"Video\";\n\nexport const isTypename = (s: string): s is Typename => {\n  return [\n    \"Course\",\n    \"Announcement\",\n    \"Material\",\n    \"Discussion\",\n    \"Homework\",\n    \"SubmittedHomework\",\n    \"Attachment\",\n    \"Score\",\n    \"GroupList\",\n    \"Video\",\n  ].includes(s);\n};\n\nexport type AnyMeta =\n  | CourseMeta\n  | AnnouncementMeta\n  | MaterialMeta\n  | DiscussionMeta\n  | HomeworkMeta\n  | SubmissionMeta\n  | AttachmentMeta\n  | ScoreMeta\n  | GroupListMeta\n  | VideoMeta;\n","import { check } from \"../utils\";\n\nexport const $x = <T extends Node>(\n  xpathExpression: string,\n  contextNode: Node\n): T[] => {\n  const iterator = (\n    (contextNode.ownerDocument || contextNode) as Document\n  ).evaluate(xpathExpression, contextNode);\n  const result = [];\n  let item: Node | null;\n  while ((item = iterator.iterateNext()) !== null) {\n    result.push(item as T);\n  }\n  return result;\n};\n\nexport const $x1 = <T extends Node>(\n  xpathExpression: string,\n  contextNode: Node\n): T => {\n  const results = $x<T>(xpathExpression, contextNode);\n  check(results.length === 1, results.length);\n  return results[0];\n};\n","import { isTypename } from \"./../types\";\nimport { AnyMeta, Typename } from \"../types\";\nimport { Bug, check, mustParseInt, notnull } from \"../utils\";\nimport { $x } from \"./xpath\";\nimport { error403 } from \"../errors\";\n\nexport type SaveFileContent = string | ReadableStream<Uint8Array>;\nexport type SaveFiles = Record<string, SaveFileContent>;\nexport type Downloadable = {\n  typename: Typename;\n  meta: AnyMeta;\n};\nexport type DownloadableReference = {\n  typename: Typename;\n  id: number;\n};\nexport type CrawlResult = AsyncGenerator<Downloadable, SaveFiles>;\n\nexport const dl = (typename: Typename, meta: AnyMeta): Downloadable => {\n  return {\n    typename: typename,\n    meta: meta,\n  };\n};\n\n// parse \"course-1\" into {typename: \"course\", id: 1}\nexport const parseDownloadableReference = (\n  s: string\n): DownloadableReference => {\n  const [typename, idstr] = s.split(\"-\", 2);\n  if (!isTypename(typename)) {\n    throw Bug(`${typename} is not a Typename`);\n  }\n  return { typename, id: mustParseInt(idstr) };\n};\n\nexport const fetch200 = async (url: RequestInfo) => {\n  const response = await fetch(url);\n  check(response.ok, response.status);\n  return response;\n};\n\nexport const parseHTML = (body: string) =>\n  new DOMParser().parseFromString(body, \"text/html\");\n\nexport const mustGetQs = (href: string, q: string) => {\n  const url = new URL(href, \"https://example.com\");\n  const value = url.searchParams.get(q);\n  if (value === null) {\n    throw Bug;\n  }\n  return value;\n};\n\nexport const buildURL = (\n  path: string,\n  query: Record<string, string>\n): string => {\n  const url = new URL(path, \"https://lms.nthu.edu.tw\");\n  url.search = new URLSearchParams(query).toString();\n  return url.toString();\n};\n\nexport const tableIsEmpty = (html: Node) => {\n  const secondRowTds = $x('//div[@class=\"tableBox\"]/table//tr[2]/td', html);\n  if (secondRowTds.length === 1) {\n    check(\n      [\"目前尚無資料\", \"No Data\"].includes(notnull(secondRowTds[0].textContent))\n    );\n    return true;\n  }\n  return false;\n};\n\nconst checkPermission = (html: Document) => {\n  const noPermission = $x(\n    `//div[contains(@style, \"color:#F00;\") and ` +\n      `(starts-with(text(), \"權限不足!\") or starts-with(text(), \"No Permission!\"))]` +\n      `/text()`,\n    html\n  );\n  if (noPermission.length > 0) {\n    throw error403(noPermission.join(\" \"));\n  }\n};\n\nexport const htmlGetMain = (html: Document) => {\n  checkPermission(html);\n  const mains = $x<Element>('//div[@id=\"main\"]', html);\n  check(mains.length > 0);\n  const [main] = mains;\n  for (const bad of ['.//div[@class=\"infoPath\"]', \".//script\"]) {\n    for (const toRemove of $x<Element>(bad, main)) {\n      toRemove.parentElement?.removeChild(toRemove);\n    }\n  }\n  return main;\n};\n","import { error403 } from \"../errors\";\nimport {\n  AnnouncementMeta,\n  AnyMeta,\n  CourseMeta,\n  DiscussionMeta,\n  GroupListMeta,\n  HomeworkMeta,\n  MaterialMeta,\n  ScoreMeta,\n  Typename,\n} from \"../types\";\nimport { Bug, mustParseInt, notnull } from \"../utils\";\nimport {\n  buildURL,\n  CrawlResult,\n  dl,\n  fetch200,\n  htmlGetMain,\n  mustGetQs,\n  parseHTML,\n  tableIsEmpty,\n} from \"./crawler\";\nimport { $x, $x1 } from \"./xpath\";\n\nexport const getEnrolledCourses = async (): Promise<CourseMeta[]> => {\n  const response = await fetch200(\n    buildURL(\"/home.php\", {\n      f: \"allcourse\",\n    })\n  );\n  const body = await response.text();\n  const html = parseHTML(body);\n\n  const result: CourseMeta[] = [];\n\n  for (const a of $x<Element>('.//td[@class=\"listTD\"]/a', html)) {\n    const bs = $x<Element>(\"b\", a);\n    let is_admin = false;\n    let tag: Element;\n    if (bs.length > 0) {\n      is_admin = true;\n      [tag] = bs;\n    } else {\n      tag = a;\n    }\n\n    const name = notnull(tag.textContent);\n    const serial = notnull(\n      a.parentElement!.parentElement!.childNodes[1].textContent\n    );\n\n    const courseURL = notnull(a.getAttribute(\"href\"));\n    const m = courseURL.match(new RegExp(\"/course/(\\\\d+)\"));\n    if (m === null) {\n      throw Bug(`invalid course URL ${courseURL}`);\n    }\n    result.push({\n      id: parseInt(m[1]),\n      serial: serial,\n      name: name,\n      is_admin: is_admin,\n      children: [],\n    });\n  }\n  return result;\n};\n\nexport const getCourse = async (course_id: number): Promise<CourseMeta> => {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      f: \"syllabus\",\n      courseID: course_id.toFixed(),\n    })\n  );\n  const responseURL = new URL(response.url);\n  if (responseURL.pathname === \"/course_login.php\") {\n    throw error403(`No access to course: course_id=${course_id}`);\n  }\n\n  const body = await response.text();\n  if (body.trim().length === 0) {\n    throw error403(\n      `Empty response returned from course, the course probably doesn't exist: course_id=${course_id}`\n    );\n  }\n\n  const html = parseHTML(body);\n  const name = $x1<Text>('//div[@class=\"infoPath\"]/a/text()', html).nodeValue!;\n\n  const hint = notnull(\n    $x1<Text>(\n      '//div[@class=\"infoTable\"]//td[2]/span[@class=\"hint\"]/text()',\n      html\n    ).nodeValue\n  );\n  const m = hint.match(\n    new RegExp(`\\\\([^,()]+, ([^,()]+), [^,()]+, [^,()]+\\\\)`)\n  );\n  if (!m) {\n    throw new Bug(hint || \"hint is null\");\n  }\n  const serial = m[1];\n\n  const is_admin =\n    $x('//div[@id=\"main\"]//a[@href=\"javascript:editDoc(1)\"]', html).length > 0;\n\n  return {\n    id: course_id,\n    serial: serial,\n    name: name,\n    is_admin: is_admin,\n  };\n};\n\nasync function* flattenPaginator(courseMeta: CourseMeta, f: string, page = 1) {\n  while (true) {\n    const response = await fetch200(\n      buildURL(\"/course.php\", {\n        courseID: courseMeta.id.toFixed(),\n        f: f,\n        page: page.toFixed(),\n      })\n    );\n    const html = parseHTML(await response.text());\n\n    if (tableIsEmpty(html)) {\n      break;\n    }\n\n    yield html;\n\n    const nextHrefs = $x<Attr>(\n      '//span[@class=\"page\"]//a[text()=\"Next\"]/@href',\n      html\n    ).map((x) => x.value);\n    if (nextHrefs.length === 0) {\n      break;\n    }\n    const next_page = mustParseInt(mustGetQs(nextHrefs[0], \"page\"));\n    page++;\n    console.assert(page === next_page);\n  }\n}\n\nexport async function* getCourseAnnouncements(\n  courseMeta: CourseMeta\n): AsyncGenerator<AnnouncementMeta> {\n  for await (const html of flattenPaginator(courseMeta, \"news\")) {\n    for (const tr of $x('//*[@id=\"main\"]//tr[@class!=\"header\"]', html)) {\n      const href = $x1<Attr>(\"td[1]/a/@href\", tr);\n      const title = $x1<Text>(\"td[2]//a/text()\", tr);\n      yield {\n        id: mustParseInt(mustGetQs(href.value, \"newsID\")),\n        title: notnull(title.textContent),\n        course: `Course-${courseMeta.id}`,\n      };\n    }\n  }\n}\n\nexport async function* getCourseDiscussions(\n  courseMeta: CourseMeta\n): AsyncGenerator<DiscussionMeta> {\n  for await (const html of flattenPaginator(courseMeta, \"forumlist\")) {\n    for (const tr of $x<Element>(\n      '//*[@id=\"main\"]//tr[@class!=\"header\"]',\n      html\n    )) {\n      if ($x('.//img[@class=\"vmiddle\"]', tr).length > 0) {\n        // XXX: belongs to a homework, material\n        // don't know if it is accessible\n        continue;\n      }\n      const href = $x1<Attr>(\"td[1]/a/@href\", tr);\n      const title = $x1<Text>(\"td[2]//a/span/text()\", tr);\n      yield {\n        id: mustParseInt(mustGetQs(href.value, \"tid\")),\n        title: title.data,\n        course: `Course-${courseMeta.id}`,\n      };\n    }\n  }\n}\n\nexport async function* getCourseMaterials(\n  courseMeta: CourseMeta\n): AsyncGenerator<MaterialMeta> {\n  for await (const html of flattenPaginator(courseMeta, \"doclist\")) {\n    for (const a of $x<Element>(\n      '//*[@id=\"main\"]//tr[@class!=\"header\"]/td[2]/div/a',\n      html\n    )) {\n      const url = new URL(\n        notnull(a.getAttribute(\"href\")),\n        \"https://example.com\"\n      );\n      if (\n        url.pathname !== \"/course.php\" ||\n        url.searchParams.get(\"f\") !== \"doc\"\n      ) {\n        // linked material (the copy should still be downloaded)\n        // XXX: this cannot be tested without logging in :(\n        continue;\n      }\n      yield {\n        id: mustParseInt(notnull(url.searchParams.get(\"cid\"))),\n        title: notnull(a.textContent),\n        type: notnull(notnull(a.parentElement).getAttribute(\"class\")),\n        course: `Course-${courseMeta.id}`,\n      };\n    }\n  }\n}\n\nexport async function* getCourseHomeworks(\n  courseMeta: CourseMeta\n): AsyncGenerator<HomeworkMeta> {\n  for await (const html of flattenPaginator(courseMeta, \"hwlist\")) {\n    for (const a of $x<Element>(\n      '//*[@id=\"main\"]//tr[@class!=\"header\"]/td[2]/a[1]',\n      html\n    )) {\n      yield {\n        id: mustParseInt(mustGetQs(notnull(a.getAttribute(\"href\")), \"hw\")),\n        title: notnull(a.textContent),\n        course: `Course-${courseMeta.id}`,\n      };\n    }\n  }\n}\n\nexport async function* getCourseScores(\n  courseMeta: CourseMeta\n): AsyncGenerator<ScoreMeta> {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      f: \"score\",\n      courseID: courseMeta.id.toFixed(),\n    })\n  );\n  const html = parseHTML(await response.text());\n\n  if (\n    $x(\n      '//div[@id=\"main\"]//input[@type=\"button\" and @onclick=\"history.back()\"]',\n      html\n    ).length === 0\n  ) {\n    yield {\n      id: courseMeta.id,\n      course: `Course-${courseMeta.id}`,\n    };\n  }\n}\n\nexport async function* getCourseGroupLists(\n  courseMeta: CourseMeta\n): AsyncGenerator<GroupListMeta> {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      f: \"grouplist\",\n      courseID: courseMeta.id.toFixed(),\n    })\n  );\n  const html = parseHTML(await response.text());\n  if (!tableIsEmpty(html)) {\n    yield {\n      id: courseMeta.id,\n      course: `Course-${courseMeta.id}`,\n    };\n  }\n}\n\nexport async function* processCourse(courseMeta: CourseMeta): CrawlResult {\n  const getters: Array<[Typename, (_: CourseMeta) => AsyncGenerator<AnyMeta>]> =\n    [\n      [\"Announcement\", getCourseAnnouncements],\n      [\"Material\", getCourseMaterials],\n      [\"Discussion\", getCourseDiscussions],\n      [\"Homework\", getCourseHomeworks],\n      [\"Score\", getCourseScores],\n      [\"GroupList\", getCourseGroupLists],\n    ];\n  for (const [typename, func] of getters) {\n    for await (const meta of func(courseMeta)) {\n      yield dl(typename, meta);\n    }\n  }\n\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      courseID: courseMeta.id.toFixed(),\n      f: \"syllabus\",\n    })\n  );\n  const html = parseHTML(await response.text());\n  const main = htmlGetMain(html);\n\n  return {\n    \"index.html\": main.outerHTML,\n  };\n}\n","import { notnull } from \"../utils\";\n\nconst isIllegalAnywhere = (c: string) => {\n  const i = notnull(c.codePointAt(0));\n  return (\n    `\"~*/:<>??\\\\|`.includes(c) ||\n    c.match(/\\p{Cc}|\\p{Cf}/gu) ||\n    (0xfdd0 <= i && i <= 0xfdef) ||\n    (i <= 0x10ffff && (i & 0xfffe) === 0xfffe)\n  );\n};\n\nconst isIllegalAtEnds = (c: string) => {\n  return c.match(/\\p{Zs}|\\./gu);\n};\n\nexport const replaceIllegalCharactersInPath = (\n  fileName: string,\n  replaceChar: string\n): string => {\n  return Array.from(fileName)\n    .map((c, i, a) => {\n      if (\n        isIllegalAnywhere(c) ||\n        ((i === 0 || i + 1 == a.length) && isIllegalAtEnds(c))\n      ) {\n        return replaceChar;\n      }\n      return c;\n    })\n    .join(\"\");\n};\n","import { AttachmentMeta, VideoMeta } from \"../types\";\nimport { notnull } from \"../utils\";\nimport { buildURL, CrawlResult, fetch200 } from \"./crawler\";\nimport { replaceIllegalCharactersInPath } from \"./fileutil\";\n\nfunction suggestAttachmentFilename(dirty: string) {\n  if (dirty === \"meta.json\") {\n    return \"meta_.json\";\n  }\n  return replaceIllegalCharactersInPath(dirty, \"_\");\n}\n\nexport async function* processAttachment(\n  attachmentMeta: AttachmentMeta\n): CrawlResult {\n  const respose = await fetch200(\n    buildURL(\"/sys/read_attach.php\", {\n      id: attachmentMeta.id.toFixed(),\n    })\n  );\n\n  const saveName = suggestAttachmentFilename(attachmentMeta.title);\n  const metaString = JSON.stringify({\n    ...attachmentMeta,\n    children: [],\n    saved_filename: saveName,\n  });\n\n  return {\n    \"meta.json\": metaString,\n    [saveName]: notnull(respose.body),\n  };\n}\n\nexport async function* processVideo(videoMeta: VideoMeta): CrawlResult {\n  const response = await fetch200(videoMeta.url);\n  return { \"video.mp4\": notnull(response.body) };\n}\n","import {\n  DiscussionMeta,\n  GroupListMeta,\n  HomeworkMeta,\n  MaterialMeta,\n  ScoreMeta,\n  SubmissionMeta,\n  VideoMeta,\n} from \"./../types\";\nimport { AnnouncementMeta, AttachmentMeta } from \"../types\";\nimport { check, mustParseInt, notnull } from \"../utils\";\nimport {\n  buildURL,\n  CrawlResult,\n  dl,\n  fetch200,\n  mustGetQs,\n  parseHTML,\n  parseDownloadableReference,\n  SaveFiles,\n  tableIsEmpty,\n  htmlGetMain,\n} from \"./crawler\";\nimport { $x, $x1 } from \"./xpath\";\n\nexport function* getAttachments(\n  parent: string,\n  element: Document | Element\n): Generator<AttachmentMeta> {\n  const ids: Record<number, boolean> = {};\n  for (const a of $x<Element>(\n    './/a[starts-with(@href, \"/sys/read_attach.php\")]',\n    element\n  )) {\n    if (a.textContent === null || a.textContent.trim().length == 0) {\n      continue;\n    }\n    const id = mustParseInt(mustGetQs(notnull(a.getAttribute(\"href\")), \"id\"));\n    if (ids[id]) {\n      continue;\n    }\n    ids[id] = true;\n    const title = notnull(a.getAttribute(\"title\") || a.textContent);\n    yield {\n      id: id,\n      title: title,\n      parent: parent,\n    };\n  }\n}\n\nexport async function* processAnnouncement(\n  announcementMeta: AnnouncementMeta\n): CrawlResult {\n  const response = await fetch200(\n    buildURL(\"/home/http_event_select.php\", {\n      id: announcementMeta.id.toFixed(),\n      type: \"n\",\n    })\n  );\n  const json = await response.json();\n\n  check(notnull(json.news.note) !== \"NA\");\n  check(notnull(json.news.poster) !== \"\");\n\n  const attachmentRawDiv = json.news.attach;\n  if (attachmentRawDiv !== null) {\n    for (const attachment of getAttachments(\n      `Announcement-${announcementMeta.id}`,\n      parseHTML(attachmentRawDiv)\n    )) {\n      yield {\n        typename: \"Attachment\",\n        meta: attachment,\n      };\n    }\n  }\n\n  return {\n    \"index.json\": JSON.stringify(json),\n  };\n}\n\nexport const getMaterialVideo = async (\n  materialMeta: MaterialMeta,\n  baseURL: string\n): Promise<VideoMeta | null> => {\n  const response = await fetch200(\n    buildURL(\"/sys/http_get_media.php\", {\n      id: materialMeta.id.toFixed(),\n      db_table: \"content\",\n      flash_installed: \"false\",\n      swf_id: `swfslide${materialMeta.id}`,\n      area_size: \"724x3\",\n    })\n  );\n  const json = notnull(await response.json());\n  check(json.ret.status === \"true\", materialMeta.id);\n  if (json.ret.player_width === null) {\n    return null;\n  }\n\n  const html = parseHTML(json.ret.embed);\n  const src = $x1<Attr>(\"//video/@src\", html).value;\n  return { id: materialMeta.id, url: new URL(src, baseURL).toString() };\n};\n\nexport async function* processMaterial(\n  materialMeta: MaterialMeta\n): CrawlResult {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      courseID: parseDownloadableReference(materialMeta.course).id.toFixed(),\n      f: \"doc\",\n      cid: materialMeta.id.toFixed(),\n    })\n  );\n  const html = parseHTML(await response.text());\n  const main = htmlGetMain(html);\n  const refString = `Material-${materialMeta.id}`;\n\n  for (const attachment of getAttachments(refString, main)) {\n    yield dl(\"Attachment\", attachment);\n  }\n\n  if (materialMeta.type === \"Epowercam\") {\n    const video = await getMaterialVideo(materialMeta, response.url);\n    if (video !== null) {\n      yield dl(\"Video\", video);\n    }\n  }\n\n  return {\n    \"index.html\": main.outerHTML,\n  };\n}\n\nexport async function* processDiscussion(\n  discussionMeta: DiscussionMeta\n): CrawlResult {\n  const response = await fetch200(\n    buildURL(\"/sys/lib/ajax/post.php\", {\n      id: discussionMeta.id.toFixed(),\n    })\n  );\n  const json = await response.json();\n\n  for (const post of json[\"posts\"][\"items\"]) {\n    for (const attachment of post[\"attach\"]) {\n      yield dl(\"Attachment\", {\n        id: mustParseInt(attachment.id),\n        title: attachment.srcName,\n        parent: `Discussion-${discussionMeta.id}`,\n      });\n    }\n  }\n\n  return {\n    \"index.json\": JSON.stringify(json),\n  };\n}\n\nexport async function* processHomework(\n  homeworkMeta: HomeworkMeta\n): CrawlResult {\n  const refString = `Homework-${homeworkMeta.id}`;\n  const saveFiles: SaveFiles = {};\n\n  // Homework page\n  {\n    const response = await fetch200(\n      buildURL(\"/course.php\", {\n        courseID: parseDownloadableReference(homeworkMeta.course).id.toFixed(),\n        f: \"hw\",\n        hw: homeworkMeta.id.toFixed(),\n      })\n    );\n    const html = parseHTML(await response.text());\n    const main = htmlGetMain(html);\n\n    for (const toRemove of $x('.//span[@class=\"toolWrapper\"]', main)) {\n      toRemove.parentElement!.removeChild(toRemove);\n    }\n\n    for (const attachment of getAttachments(refString, main)) {\n      yield dl(\"Attachment\", attachment);\n    }\n\n    saveFiles[\"index.html\"] = main.outerHTML;\n  }\n\n  // Submissions\n  {\n    const response = await fetch200(\n      buildURL(\"/course.php\", {\n        courseID: parseDownloadableReference(homeworkMeta.course).id.toFixed(),\n        f: \"hw_doclist\",\n        hw: homeworkMeta.id.toFixed(),\n      })\n    );\n    const html = parseHTML(await response.text());\n    const main = htmlGetMain(html);\n\n    if (tableIsEmpty(main)) {\n      return saveFiles;\n    }\n\n    const headerTr = $x1<Element>(\n      './/div[@class=\"tableBox\"]//tr[@class=\"header\"]',\n      main\n    );\n    const fieldIndexes: Record<string, number> = {};\n    headerTr.childNodes.forEach((td, i) => {\n      const as = $x<Element>(\"a\", td);\n      if (as.length === 1) {\n        fieldIndexes[mustGetQs(notnull(as[0].getAttribute(\"href\")), \"order\")] =\n          i;\n      }\n    });\n\n    const ititle = notnull(fieldIndexes.title);\n    const iname = notnull(fieldIndexes.name);\n    check(iname > ititle, iname);\n\n    for (const tr of $x<Element>(\n      '//div[@class=\"tableBox\"]//tr[@class!=\"header\"]',\n      main\n    )) {\n      const as = $x<Element>(\"div/a\", tr.childNodes[ititle]);\n      if (as.length === 0) {\n        continue;\n      }\n      check(as.length === 1);\n      const id = mustParseInt(\n        mustGetQs(notnull(as[0].getAttribute(\"href\")), \"cid\")\n      );\n      const title = notnull(as[0].textContent).trim();\n\n      const comments = $x<Attr>(\n        'div/img[@src=\"/sys/res/icon/hw_comment.png\"]/@title',\n        tr.childNodes[ititle]\n      );\n      check(comments.length < 2);\n      const comment = comments.length > 0 ? comments[0].value : null;\n\n      // Group homework may hide behind a <a>\n      const by = $x1<Text>(\n        \"div/text()|div/a/text()\",\n        tr.childNodes[iname]\n      ).data;\n\n      yield dl(\"SubmittedHomework\", {\n        id: id,\n        title: title,\n        by: by,\n        comment: comment,\n        course: homeworkMeta.course,\n      });\n    }\n\n    saveFiles[\"list.html\"] = main.outerHTML;\n  }\n\n  return saveFiles;\n}\n\nexport async function* processSubmission(\n  submissionMeta: SubmissionMeta\n): CrawlResult {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      courseID: parseDownloadableReference(submissionMeta.course).id.toFixed(),\n      f: \"doc\",\n      cid: submissionMeta.id.toFixed(),\n    })\n  );\n  const html = parseHTML(await response.text());\n  const main = htmlGetMain(html);\n\n  for (const attachment of getAttachments(\n    `SubmittedHomework-${submissionMeta.id}`,\n    main\n  )) {\n    yield dl(\"Attachment\", attachment);\n  }\n\n  return {\n    \"index.html\": main.outerHTML,\n  };\n}\n\nasync function* processSinglePage(\n  f: string,\n  meta: ScoreMeta | GroupListMeta\n): CrawlResult {\n  const response = await fetch200(\n    buildURL(\"/course.php\", {\n      courseID: parseDownloadableReference(meta.course).id.toFixed(),\n      f: f,\n    })\n  );\n  const html = parseHTML(await response.text());\n  const main = htmlGetMain(html);\n\n  return {\n    \"index.html\": main.outerHTML,\n  };\n}\n\nexport const processScore = (scoreMeta: ScoreMeta): CrawlResult =>\n  processSinglePage(\"score\", scoreMeta);\n\nexport const processGroupList = (groupListMeta: GroupListMeta): CrawlResult =>\n  processSinglePage(\"grouplist\", groupListMeta);\n","import {\n  AnnouncementMeta,\n  AttachmentMeta,\n  CourseMeta,\n  DiscussionMeta,\n  GroupListMeta,\n  HomeworkMeta,\n  MaterialMeta,\n  ScoreMeta,\n  SubmissionMeta,\n  Typename,\n  VideoMeta,\n} from \"../types\";\nimport { Bug } from \"../utils\";\nimport { processCourse } from \"./course\";\nimport { CrawlResult, Downloadable, SaveFiles } from \"./crawler\";\nimport { processAttachment, processVideo } from \"./file\";\nimport {\n  processAnnouncement,\n  processDiscussion,\n  processGroupList,\n  processHomework,\n  processMaterial,\n  processScore,\n  processSubmission,\n} from \"./page\";\n\nconst processItem = ({ typename, meta }: Downloadable): CrawlResult => {\n  switch (typename) {\n    case \"Course\":\n      return processCourse(meta as CourseMeta);\n    case \"Announcement\":\n      return processAnnouncement(meta as AnnouncementMeta);\n    case \"Material\":\n      return processMaterial(meta as MaterialMeta);\n    case \"Discussion\":\n      return processDiscussion(meta as DiscussionMeta);\n    case \"Homework\":\n      return processHomework(meta as HomeworkMeta);\n    case \"SubmittedHomework\":\n      return processSubmission(meta as SubmissionMeta);\n    case \"Attachment\":\n      return processAttachment(meta as AttachmentMeta);\n    case \"Video\":\n      return processVideo(meta as VideoMeta);\n    case \"GroupList\":\n      return processGroupList(meta as GroupListMeta);\n    case \"Score\":\n      return processScore(meta as ScoreMeta);\n    default:\n      throw new Bug(`invalid typename: ${typename}`);\n  }\n};\n\nconst downloadableToString = ({ typename, meta }: Downloadable) => {\n  const ref = `${typename}-${meta.id}`;\n  if (\"name\" in meta) {\n    return `${ref}: ${meta.name}`;\n  }\n  if (\"title\" in meta) {\n    return `${ref}: ${meta.title}`;\n  }\n  return `${ref}`;\n};\n\nexport enum DownloadState {\n  Scheduled,\n  Processing,\n  Completed,\n  Errored,\n}\n\nexport class DownloadManager {\n  private target: Downloadable;\n  status = DownloadState.Scheduled;\n  progress = 0;\n  total = 0;\n  message = \"\";\n  dh: FileSystemDirectoryHandle;\n\n  constructor(target: Downloadable, dh: FileSystemDirectoryHandle) {\n    this.target = target;\n    this.dh = dh;\n  }\n\n  stateChanged() {}\n\n  private setState(progress: number, total: number, message: string) {\n    this.progress = progress;\n    this.total = total;\n    this.message = message;\n    this.stateChanged();\n  }\n\n  async download() {\n    this.status = DownloadState.Processing;\n    this.stateChanged();\n    try {\n      await this.downloadInternal();\n    } catch (e) {\n      console.error(\"Download failed for:\", this.target);\n      console.error(e);\n      this.status = DownloadState.Errored;\n      this.stateChanged();\n      return;\n    }\n    this.status = DownloadState.Completed;\n    this.stateChanged();\n  }\n\n  async downloadFile(\n    typename: Typename,\n    itemID: number,\n    itemName: string,\n    name: string,\n    content: string | ReadableStream\n  ) {\n    const typedir = await this.dh.getDirectoryHandle(typename.toLowerCase(), {\n      create: true,\n    });\n    const objdir = await typedir.getDirectoryHandle(itemID.toFixed(), {\n      create: true,\n    });\n    const fileHandle = await objdir.getFileHandle(name, { create: true });\n    const stream = await fileHandle.createWritable();\n\n    if (!(content instanceof ReadableStream)) {\n      await stream.write(content);\n      await stream.close();\n      return;\n    }\n\n    let bytesWritten = 0;\n    const reportTransform = new TransformStream({\n      transform: (\n        chunk: Uint8Array,\n        controller: TransformStreamDefaultController\n      ) => {\n        bytesWritten += chunk.byteLength;\n        this.setState(\n          this.progress,\n          this.total,\n          `${itemName} ${(bytesWritten * 1e-6).toFixed(1)}MB`\n        );\n\n        controller.enqueue(chunk);\n      },\n    });\n\n    const reportingStream = content.pipeThrough(reportTransform);\n    await reportingStream.pipeTo(stream);\n  }\n\n  private async downloadInternal() {\n    let currentItem = 0;\n    let totalItems = 1;\n\n    const queue: Array<Downloadable> = [this.target];\n    for (; queue.length > 0; ++currentItem) {\n      const item = queue.shift()!;\n      const itemName = downloadableToString(item);\n\n      this.setState(currentItem, totalItems, itemName);\n\n      const result = processItem(item);\n      const children = [];\n\n      for (;;) {\n        const { value, done } = await result.next();\n\n        // handle save files\n        if (done) {\n          const saveFiles = value as SaveFiles;\n          if (saveFiles[\"meta.json\"] === undefined) {\n            await this.downloadFile(\n              item.typename,\n              item.meta.id,\n              itemName,\n              \"meta.json\",\n              JSON.stringify({ ...item.meta, children: children })\n            );\n          }\n          for (const [name, value] of Object.entries(saveFiles)) {\n            await this.downloadFile(\n              item.typename,\n              item.meta.id,\n              itemName,\n              name,\n              value\n            );\n          }\n          break;\n        }\n\n        // handle children\n        ++totalItems;\n        const child = value as Downloadable;\n        children.push(`${child.typename}-${child.meta.id}`);\n        queue.push(child);\n\n        this.setState(currentItem, totalItems, `${itemName}`);\n      }\n    }\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\n\n@customElement(\"freeze-prompt\")\nexport class FreezePrompt extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  @state()\n  title = \"title\";\n  @state()\n  body = \"\";\n  @state()\n  yes = \"OK\";\n  @state()\n  no = \"Cancel\";\n  resolve!: (value: boolean) => any;\n\n  private closeWith(value: boolean) {\n    this.resolve(value);\n    this.remove();\n  }\n\n  render() {\n    return html`<div class=\"modal is-active\">\n      <div class=\"modal-background\"></div>\n      <div class=\"modal-card\">\n        <header class=\"modal-card-head\">\n          <p class=\"modal-card-title\">${this.title}</p>\n          <button\n            class=\"delete\"\n            aria-label=\"close\"\n            @click=${() => this.closeWith(false)}\n          ></button>\n        </header>\n\n        <section class=\"modal-card-body\">\n          ${this.body && html`<p style=\"margin-bottom: 16px\">${this.body}</p>`}\n          <button class=\"button is-info\" @click=${() => this.closeWith(true)}>\n            ${this.yes}\n          </button>\n          ${this.no &&\n          html`<button class=\"button\" @click=${() => this.closeWith(false)}>\n            ${this.no}\n          </button>`}\n        </section>\n      </div>\n    </div>`;\n  }\n}\n\nexport const ask = (\n  title = \"title\",\n  body = \"\",\n  yes = \"OK\",\n  no = \"Cancel\"\n): Promise<boolean> => {\n  const prompt = document.createElement(\"freeze-prompt\") as FreezePrompt;\n  prompt.title = title;\n  prompt.body = body;\n  prompt.yes = yes;\n  prompt.no = no;\n  return new Promise((resolve) => {\n    prompt.resolve = resolve;\n    document.querySelector(\"body\")!.appendChild(prompt);\n  });\n};\n","import { Commands, RouterLocation } from \"@vaadin/router\";\nimport { html, LitElement } from \"lit\";\nimport { customElement, query, state } from \"lit/decorators.js\";\nimport { repeat } from \"lit/directives/repeat.js\";\nimport { BaseView } from \"./base-view.js\";\nimport { getCourse, getEnrolledCourses } from \"./crawler/course\";\nimport { DownloadManager, DownloadState } from \"./crawler/download-manager.js\";\nimport {\n  DataSource,\n  FileSystemDataSource,\n  RemoteDataSource,\n} from \"./data-source.js\";\nimport \"./freeze-no-source\";\nimport { ask } from \"./freeze-prompt.js\";\n\nimport {\n  externalLink,\n  materialIcon,\n  renderStatus,\n  statusFail,\n  statusSuccess,\n  statusUnknown,\n  statusWarn,\n} from \"./html.js\";\nimport { RouterSource } from \"./routes.js\";\nimport { CourseMeta } from \"./types.js\";\nimport { mustParseInt } from \"./utils.js\";\n\nconst getLoginState = async () => {\n  let response: Response;\n  try {\n    response = await fetch(\"https://lms.nthu.edu.tw/home.php\");\n  } catch (err) {\n    return renderStatus(statusFail, \"Inaccessible\");\n  }\n  const body = new DOMParser().parseFromString(\n    await response.text(),\n    \"text/html\"\n  );\n  const profile = body.querySelector(\"#profile\");\n  if (profile === null) {\n    return renderStatus(statusWarn, \"Logged out\");\n  }\n  const nameTag = profile.querySelector(\"span.lt\");\n  console.assert(nameTag !== null);\n  const nameTagName = nameTag!.textContent!.trim();\n  console.assert(\n    [\"Name:\", \"姓名:\"].find((x) => x === nameTagName) === nameTagName,\n    nameTag\n  );\n  const loggedInAs = nameTag!.nextSibling!.textContent;\n  return renderStatus(statusSuccess, `Logged in as ${loggedInAs}`);\n};\n\nenum DirectoryState {\n  None,\n  ReadOnly,\n  ReadWrite,\n  Remote,\n}\n\n@customElement(\"freeze-download\")\nexport class FreezeDownload extends BaseView {\n  @state()\n  ilmsAccess = renderStatus(statusUnknown, \"Unknown\");\n\n  @state()\n  directoryAccess = DirectoryState.None;\n  dh!: FileSystemDirectoryHandle;\n\n  @query(\"freeze-dump\")\n  dumper?: FreezeDump;\n\n  windowOnBeforeUnload: () => boolean | null;\n\n  constructor() {\n    super();\n    this.windowOnBeforeUnload = () => this.downlaodIsRunning() || null;\n  }\n\n  createRenderRoot() {\n    return this;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.getStatus();\n  }\n\n  private downlaodIsRunning() {\n    if (this.dumper === undefined || this.dumper === null) {\n      return false;\n    }\n    return this.dumper.downloadRunning > 0;\n  }\n\n  async onBeforeEnter(\n    location: RouterLocation,\n    commands: Commands,\n    router: RouterSource\n  ) {\n    window.onbeforeunload = this.windowOnBeforeUnload;\n    await super.onBeforeEnter(location, commands, router);\n  }\n\n  async onBeforeLeave(_: any, commands: Commands) {\n    window.onbeforeunload = null;\n\n    if (!this.downlaodIsRunning()) {\n      return;\n    }\n    const leave = await ask(\n      \"Are you sure you want to leave?\",\n      \"Download will be interrupted.\",\n      \"Leave\",\n      \"Cancel\"\n    );\n    if (!leave) {\n      return commands.prevent();\n    }\n    return;\n  }\n\n  private async getStatus() {\n    this.ilmsAccess = await getLoginState();\n  }\n\n  async prepareState(_location: RouterLocation, source: DataSource) {\n    if (source instanceof FileSystemDataSource) {\n      this.dh = source.rootHandle;\n      if ((await this.dh.queryPermission({ mode: \"read\" })) !== \"granted\") {\n        this.directoryAccess = DirectoryState.None;\n        return;\n      }\n      if (\n        (await this.dh.queryPermission({ mode: \"readwrite\" })) !== \"granted\"\n      ) {\n        this.directoryAccess = DirectoryState.ReadOnly;\n        return;\n      }\n      this.directoryAccess = DirectoryState.ReadWrite;\n    } else if (source instanceof RemoteDataSource) {\n      this.directoryAccess = DirectoryState.Remote;\n    }\n  }\n\n  renderState() {\n    return html`\n      <p class=\"has-text-centered\">\n        <span>\n          ${externalLink(\"iLMS\", \"https://lms.nthu.edu.tw\")} status:\n          ${this.ilmsAccess}\n          <span style=\"opacity: 0.7\">(refresh this page to update status)</span>\n        </span>\n      </p>\n      <hr />\n      <freeze-dump\n        .directoryAccess=${this.directoryAccess}\n        .dh=${this.dh}\n      ></freeze-dump>\n    `;\n  }\n}\n\n@customElement(\"freeze-dump\")\nexport class FreezeDump extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  @state()\n  dh!: FileSystemDirectoryHandle;\n\n  @state()\n  directoryAccess = DirectoryState.None;\n\n  @state()\n  enrolledCourses: CourseMeta[] = [];\n\n  @state()\n  queue: UIDownloadManager[] = [];\n  added: { [_: number]: DownloadManager } = {};\n\n  @state()\n  completedDownloads = 0;\n\n  // XXX is this async-safe?\n  downloadRunning = 0;\n\n  @query(\"#dump-course-id\")\n  courseIdInput!: HTMLInputElement;\n\n  constructor() {\n    super();\n    this.setEnrolledCoursesAsync();\n  }\n\n  private async setEnrolledCoursesAsync() {\n    this.enrolledCourses = await getEnrolledCourses();\n  }\n\n  private async doDownload() {\n    if (this.downloadRunning > 0) {\n      return;\n    }\n    ++this.downloadRunning;\n    console.assert(this.downloadRunning === 1, this.downloadRunning);\n    for (\n      ;\n      this.completedDownloads < this.queue.length;\n      this.completedDownloads++\n    ) {\n      const dm = this.queue[this.completedDownloads];\n      await dm.download();\n    }\n\n    --this.downloadRunning;\n    console.assert(this.downloadRunning === 0, this.downloadRunning);\n  }\n\n  addCourse(course: CourseMeta) {\n    if (this.added[course.id]) {\n      return;\n    }\n    const dm = new UIDownloadManager(course, this.dh);\n    this.added[course.id] = dm;\n    this.queue.push(dm);\n    this.doDownload();\n  }\n\n  addEnrolledCourses() {\n    for (const course of this.enrolledCourses) {\n      if (course.id in this.added) {\n        continue;\n      }\n      this.addCourse(course);\n    }\n    this.requestUpdate();\n  }\n\n  async addSelectedCourse() {\n    const courseID = this.courseIdInput.value;\n    this.courseIdInput.value = \"\";\n\n    let course: CourseMeta;\n    try {\n      course = await getCourse(mustParseInt(courseID));\n    } catch (e) {\n      ask(\"Cannot add course\", e.toString(), \"Close\", \"\");\n      this.requestUpdate();\n      return;\n    }\n    this.addCourse(course);\n    this.requestUpdate();\n  }\n\n  private _requestWriteAccess() {\n    this.dispatchEvent(new Event(\"request-write\", { bubbles: true }));\n  }\n\n  render() {\n    if (\n      this.directoryAccess === DirectoryState.None ||\n      this.directoryAccess === DirectoryState.Remote\n    ) {\n      return html`<freeze-no-source></freeze-no-source>`;\n    }\n    if (this.directoryAccess === DirectoryState.ReadOnly) {\n      return html`<div class=\"has-text-centered\">\n        <div class=\"oops\">(._.)</div>\n        <div>Cannot download without write access</div>\n        <div style=\"margin-top: 20px\">\n          <button class=\"button is-info\" @click=${this._requestWriteAccess}>\n            Grant Write Access\n          </button>\n        </div>\n      </div>`;\n    }\n    console.assert(this.directoryAccess === DirectoryState.ReadWrite);\n    return this.renderState();\n  }\n\n  renderForm() {\n    return html`\n      <div class=\"field is-grouped is-grouped-centered\">\n        <div class=\"field has-addons\">\n          <div class=\"control\">\n            <input\n              id=\"dump-course-id\"\n              class=\"input has-text-centered\"\n              type=\"text\"\n              placeholder=\"Course ID\"\n              @keyup=${(event: KeyboardEvent) => {\n                if (event.key !== \"Enter\") return;\n                this.addSelectedCourse();\n                event.preventDefault();\n              }}\n            />\n          </div>\n          <div class=\"control\">\n            <button class=\"button is-info\" @click=${this.addSelectedCourse}>\n              ${materialIcon(\"download\")}\n              <span>Download</span>\n            </button>\n          </div>\n        </div>\n        &emsp;\n\n        <div class=\"field has-addons\">\n          <div class=\"control\">\n            <input\n              class=\"input has-text-centered is-italic\"\n              type=\"text\"\n              value=\"all ${this.enrolledCourses.length} enrolled courses\"\n              readonly\n            />\n          </div>\n          <div class=\"control\">\n            <button\n              class=\"button is-info\"\n              @click=${this.addEnrolledCourses}\n              ?disabled=${this.enrolledCourses.length === 0}\n            >\n              ${materialIcon(\"download\")}\n              <span>Download</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  renderQueue() {\n    if (this.queue.length === 0) {\n      return html`<span class=\"panel-block\">\n        <div style=\"width: 100%\">\n          <div class=\"oops has-text-centered\">ᕦ( ᐛ )ᕡ</div>\n          <div class=\" has-text-centered\">No courses queued for download.</div>\n        </div>\n      </span>`;\n    }\n    return html`\n      <div class=\"container\" style=\"max-width: 768px\">\n        <div class=\"panel\">\n          <p class=\"panel-heading\">\n            Downloads ${this.completedDownloads}/${this.queue.length}\n          </p>\n          ${repeat(\n            this.queue,\n            (dm) => dm.course.id,\n            (dm) =>\n              html`\n                <span class=\"panel-block\">\n                  <freeze-dump-course\n                    .course=${dm.course}\n                    .downloadManager=${dm}\n                    style=\"width: 100%\"\n                  ></freeze-dump-course>\n                </span>\n              `\n          )}\n        </div>\n      </div>\n    `;\n  }\n\n  renderState() {\n    return html` ${this.renderForm()} ${this.renderQueue()} `;\n  }\n}\n\n@customElement(\"freeze-dump-course\")\nexport class FreezeDumpCourse extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  course!: CourseMeta;\n  downloadManager!: UIDownloadManager;\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.downloadManager.ui = this;\n  }\n\n  startDownload() {\n    this.downloadManager.download();\n  }\n\n  getIconName(status: DownloadState) {\n    switch (status) {\n      case DownloadState.Scheduled:\n        return \"hourglass_empty\";\n      case DownloadState.Processing:\n        return \"downloading\";\n      case DownloadState.Completed:\n        return \"file_download_done\";\n      case DownloadState.Errored:\n        return \"error\";\n    }\n  }\n\n  render() {\n    const dm = this.downloadManager;\n    return html`\n      <span> ${materialIcon(this.getIconName(dm.status))} </span>\n      <span>\n        <span class=\"tag\">${this.course.id}</span>\n        <span>${this.course.name}</span>\n        <span class=\"tag\">${this.course.serial}</span>\n        ${this.course.is_admin\n          ? html`<span class=\"tag is-primary is-light\">admin</span>`\n          : undefined}\n        ${dm.status === DownloadState.Processing\n          ? html`\n              <progress\n                class=\"progress is-info\"\n                value=\"${dm.progress}\"\n                max=\"${dm.total}\"\n                style=\"height: 4px; margin-top: 8px; margin-bottom: 4px\"\n              >\n                ${dm.progress}/${dm.total}\n              </progress>\n              <small style=\"opacity: .7\"\n                >Downloading (${dm.progress}/${dm.total})...\n                ${dm.message}</small\n              >\n            `\n          : undefined}\n      </span>\n    `;\n  }\n}\n\nclass UIDownloadManager extends DownloadManager {\n  course: CourseMeta;\n  ui?: FreezeDumpCourse;\n\n  constructor(course: CourseMeta, dh: FileSystemDirectoryHandle) {\n    super({ typename: \"Course\", meta: course }, dh);\n    this.course = course;\n  }\n\n  stateChanged() {\n    this.ui?.requestUpdate();\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement } from \"lit/decorators.js\";\n\n@customElement(\"freeze-404\")\nexport class Freeze404 extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  render() {\n    return html`<div>\n      <div class=\"oops x2 has-text-centered\">404</div>\n      <div class=\"has-text-centered\">Page not found</div>\n    </div>`;\n  }\n}\n","function toArray(objectOrArray) {\n  objectOrArray = objectOrArray || [];\n  return Array.isArray(objectOrArray) ? objectOrArray : [objectOrArray];\n}\n\nfunction log(msg) {\n  return `[Vaadin.Router] ${msg}`;\n}\n\nfunction logValue(value) {\n  if (typeof value !== 'object') {\n    return String(value);\n  }\n\n  const stringType = Object.prototype.toString.call(value).match(/ (.*)\\]$/)[1];\n  if (stringType === 'Object' || stringType === 'Array') {\n    return `${stringType} ${JSON.stringify(value)}`;\n  } else {\n    return stringType;\n  }\n}\n\nconst MODULE = 'module';\nconst NOMODULE = 'nomodule';\nconst bundleKeys = [MODULE, NOMODULE];\n\nfunction ensureBundle(src) {\n  if (!src.match(/.+\\.[m]?js$/)) {\n    throw new Error(\n      log(`Unsupported type for bundle \"${src}\": .js or .mjs expected.`)\n    );\n  }\n}\n\nfunction ensureRoute(route) {\n  if (!route || !isString(route.path)) {\n    throw new Error(\n      log(`Expected route config to be an object with a \"path\" string property, or an array of such objects`)\n    );\n  }\n\n  const bundle = route.bundle;\n\n  const stringKeys = ['component', 'redirect', 'bundle'];\n  if (\n    !isFunction(route.action) &&\n    !Array.isArray(route.children) &&\n    !isFunction(route.children) &&\n    !isObject(bundle) &&\n    !stringKeys.some(key => isString(route[key]))\n  ) {\n    throw new Error(\n      log(\n        `Expected route config \"${route.path}\" to include either \"${stringKeys.join('\", \"')}\" ` +\n        `or \"action\" function but none found.`\n      )\n    );\n  }\n\n  if (bundle) {\n    if (isString(bundle)) {\n      ensureBundle(bundle);\n    } else if (!bundleKeys.some(key => key in bundle)) {\n      throw new Error(\n        log('Expected route bundle to include either \"' + NOMODULE + '\" or \"' + MODULE + '\" keys, or both')\n      );\n    } else {\n      bundleKeys.forEach(key => key in bundle && ensureBundle(bundle[key]));\n    }\n  }\n\n  if (route.redirect) {\n    ['bundle', 'component'].forEach(overriddenProp => {\n      if (overriddenProp in route) {\n        console.warn(\n          log(\n            `Route config \"${route.path}\" has both \"redirect\" and \"${overriddenProp}\" properties, ` +\n            `and \"redirect\" will always override the latter. Did you mean to only use \"${overriddenProp}\"?`\n          )\n        );\n      }\n    });\n  }\n}\n\nfunction ensureRoutes(routes) {\n  toArray(routes).forEach(route => ensureRoute(route));\n}\n\nfunction loadScript(src, key) {\n  let script = document.head.querySelector('script[src=\"' + src + '\"][async]');\n  if (!script) {\n    script = document.createElement('script');\n    script.setAttribute('src', src);\n    if (key === MODULE) {\n      script.setAttribute('type', MODULE);\n    } else if (key === NOMODULE) {\n      script.setAttribute(NOMODULE, '');\n    }\n    script.async = true;\n  }\n  return new Promise((resolve, reject) => {\n    script.onreadystatechange = script.onload = e => {\n      script.__dynamicImportLoaded = true;\n      resolve(e);\n    };\n    script.onerror = e => {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n      reject(e);\n    };\n    if (script.parentNode === null) {\n      document.head.appendChild(script);\n    } else if (script.__dynamicImportLoaded) {\n      resolve();\n    }\n  });\n}\n\nfunction loadBundle(bundle) {\n  if (isString(bundle)) {\n    return loadScript(bundle);\n  } else {\n    return Promise.race(\n      bundleKeys\n        .filter(key => key in bundle)\n        .map(key => loadScript(bundle[key], key))\n    );\n  }\n}\n\nfunction fireRouterEvent(type, detail) {\n  return !window.dispatchEvent(new CustomEvent(\n    `vaadin-router-${type}`,\n    {cancelable: type === 'go', detail}\n  ));\n}\n\nfunction isObject(o) {\n  // guard against null passing the typeof check\n  return typeof o === 'object' && !!o;\n}\n\nfunction isFunction(f) {\n  return typeof f === 'function';\n}\n\nfunction isString(s) {\n  return typeof s === 'string';\n}\n\nfunction getNotFoundError(context) {\n  const error = new Error(log(`Page not found (${context.pathname})`));\n  error.context = context;\n  error.code = 404;\n  return error;\n}\n\nconst notFoundResult = new (class NotFoundResult {})();\n\n/* istanbul ignore next: coverage is calculated in Chrome, this code is for IE */\nfunction getAnchorOrigin(anchor) {\n  // IE11: on HTTP and HTTPS the default port is not included into\n  // window.location.origin, so won't include it here either.\n  const port = anchor.port;\n  const protocol = anchor.protocol;\n  const defaultHttp = protocol === 'http:' && port === '80';\n  const defaultHttps = protocol === 'https:' && port === '443';\n  const host = (defaultHttp || defaultHttps)\n    ? anchor.hostname // does not include the port number (e.g. www.example.org)\n    : anchor.host; // does include the port number (e.g. www.example.org:80)\n  return `${protocol}//${host}`;\n}\n\n// The list of checks is not complete:\n//  - SVG support is missing\n//  - the 'rel' attribute is not considered\nfunction vaadinRouterGlobalClickHandler(event) {\n  // ignore the click if the default action is prevented\n  if (event.defaultPrevented) {\n    return;\n  }\n\n  // ignore the click if not with the primary mouse button\n  if (event.button !== 0) {\n    return;\n  }\n\n  // ignore the click if a modifier key is pressed\n  if (event.shiftKey || event.ctrlKey || event.altKey || event.metaKey) {\n    return;\n  }\n\n  // find the <a> element that the click is at (or within)\n  let anchor = event.target;\n  const path = event.composedPath\n    ? event.composedPath()\n    : (event.path || []);\n\n  // FIXME(web-padawan): `Symbol.iterator` used by webcomponentsjs is broken for arrays\n  // example to check: `for...of` loop here throws the \"Not yet implemented\" error\n  for (let i = 0; i < path.length; i++) {\n    const target = path[i];\n    if (target.nodeName && target.nodeName.toLowerCase() === 'a') {\n      anchor = target;\n      break;\n    }\n  }\n\n  while (anchor && anchor.nodeName.toLowerCase() !== 'a') {\n    anchor = anchor.parentNode;\n  }\n\n  // ignore the click if not at an <a> element\n  if (!anchor || anchor.nodeName.toLowerCase() !== 'a') {\n    return;\n  }\n\n  // ignore the click if the <a> element has a non-default target\n  if (anchor.target && anchor.target.toLowerCase() !== '_self') {\n    return;\n  }\n\n  // ignore the click if the <a> element has the 'download' attribute\n  if (anchor.hasAttribute('download')) {\n    return;\n  }\n\n  // ignore the click if the <a> element has the 'router-ignore' attribute\n  if (anchor.hasAttribute('router-ignore')) {\n    return;\n  }\n\n  // ignore the click if the target URL is a fragment on the current page\n  if (anchor.pathname === window.location.pathname && anchor.hash !== '') {\n    return;\n  }\n\n  // ignore the click if the target is external to the app\n  // In IE11 HTMLAnchorElement does not have the `origin` property\n  const origin = anchor.origin || getAnchorOrigin(anchor);\n  if (origin !== window.location.origin) {\n    return;\n  }\n\n  // if none of the above, convert the click into a navigation event\n  const {pathname, search, hash} = anchor;\n  if (fireRouterEvent('go', {pathname, search, hash})) {\n    event.preventDefault();\n    // for a click event, the scroll is reset to the top position.\n    if (event && event.type === 'click') {\n      window.scrollTo(0, 0);\n    }\n  }\n}\n\n/**\n * A navigation trigger for Vaadin Router that translated clicks on `<a>` links\n * into Vaadin Router navigation events.\n *\n * Only regular clicks on in-app links are translated (primary mouse button, no\n * modifier keys, the target href is within the app's URL space).\n *\n * @memberOf Router.NavigationTrigger\n * @type {NavigationTrigger}\n */\nconst CLICK = {\n  activate() {\n    window.document.addEventListener('click', vaadinRouterGlobalClickHandler);\n  },\n\n  inactivate() {\n    window.document.removeEventListener('click', vaadinRouterGlobalClickHandler);\n  }\n};\n\n// PopStateEvent constructor shim\nconst isIE = /Trident/.test(navigator.userAgent);\n\n/* istanbul ignore next: coverage is calculated in Chrome, this code is for IE */\nif (isIE && !isFunction(window.PopStateEvent)) {\n  window.PopStateEvent = function(inType, params) {\n    params = params || {};\n    var e = document.createEvent('Event');\n    e.initEvent(inType, Boolean(params.bubbles), Boolean(params.cancelable));\n    e.state = params.state || null;\n    return e;\n  };\n  window.PopStateEvent.prototype = window.Event.prototype;\n}\n\nfunction vaadinRouterGlobalPopstateHandler(event) {\n  if (event.state === 'vaadin-router-ignore') {\n    return;\n  }\n  const {pathname, search, hash} = window.location;\n  fireRouterEvent('go', {pathname, search, hash});\n}\n\n/**\n * A navigation trigger for Vaadin Router that translates popstate events into\n * Vaadin Router navigation events.\n *\n * @memberOf Router.NavigationTrigger\n * @type {NavigationTrigger}\n */\nconst POPSTATE = {\n  activate() {\n    window.addEventListener('popstate', vaadinRouterGlobalPopstateHandler);\n  },\n\n  inactivate() {\n    window.removeEventListener('popstate', vaadinRouterGlobalPopstateHandler);\n  }\n};\n\n/**\n * Expose `pathToRegexp`.\n */\nvar pathToRegexp_1 = pathToRegexp;\nvar parse_1 = parse;\nvar compile_1 = compile;\nvar tokensToFunction_1 = tokensToFunction;\nvar tokensToRegExp_1 = tokensToRegExp;\n\n/**\n * Default configs.\n */\nvar DEFAULT_DELIMITER = '/';\nvar DEFAULT_DELIMITERS = './';\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \":test(\\\\d+)?\" => [\"test\", \"\\d+\", undefined, \"?\"]\n  // \"(\\\\d+)\"  => [undefined, undefined, \"\\d+\", undefined]\n  '(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?'\n].join('|'), 'g');\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = [];\n  var key = 0;\n  var index = 0;\n  var path = '';\n  var defaultDelimiter = (options && options.delimiter) || DEFAULT_DELIMITER;\n  var delimiters = (options && options.delimiters) || DEFAULT_DELIMITERS;\n  var pathEscaped = false;\n  var res;\n\n  while ((res = PATH_REGEXP.exec(str)) !== null) {\n    var m = res[0];\n    var escaped = res[1];\n    var offset = res.index;\n    path += str.slice(index, offset);\n    index = offset + m.length;\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1];\n      pathEscaped = true;\n      continue\n    }\n\n    var prev = '';\n    var next = str[index];\n    var name = res[2];\n    var capture = res[3];\n    var group = res[4];\n    var modifier = res[5];\n\n    if (!pathEscaped && path.length) {\n      var k = path.length - 1;\n\n      if (delimiters.indexOf(path[k]) > -1) {\n        prev = path[k];\n        path = path.slice(0, k);\n      }\n    }\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path);\n      path = '';\n      pathEscaped = false;\n    }\n\n    var partial = prev !== '' && next !== undefined && next !== prev;\n    var repeat = modifier === '+' || modifier === '*';\n    var optional = modifier === '?' || modifier === '*';\n    var delimiter = prev || defaultDelimiter;\n    var pattern = capture || group;\n\n    tokens.push({\n      name: name || key++,\n      prefix: prev,\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      pattern: pattern ? escapeGroup(pattern) : '[^' + escapeString(delimiter) + ']+?'\n    });\n  }\n\n  // Push any remaining characters.\n  if (path || index < str.length) {\n    tokens.push(path + str.substr(index));\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length);\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$');\n    }\n  }\n\n  return function (data, options) {\n    var path = '';\n    var encode = (options && options.encode) || encodeURIComponent;\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i];\n\n      if (typeof token === 'string') {\n        path += token;\n        continue\n      }\n\n      var value = data ? data[token.name] : undefined;\n      var segment;\n\n      if (Array.isArray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but got array')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) continue\n\n          throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j], token);\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\"')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment;\n        }\n\n        continue\n      }\n\n      if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        segment = encode(String(value), token);\n\n        if (!matches[i].test(segment)) {\n          throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but got \"' + segment + '\"')\n        }\n\n        path += token.prefix + segment;\n        continue\n      }\n\n      if (token.optional) {\n        // Prepend partial segment prefixes.\n        if (token.partial) path += token.prefix;\n\n        continue\n      }\n\n      throw new TypeError('Expected \"' + token.name + '\" to be ' + (token.repeat ? 'an array' : 'a string'))\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$/()])/g, '\\\\$1')\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options && options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {Array=}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  if (!keys) return path\n\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g);\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        pattern: null\n      });\n    }\n  }\n\n  return path\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = [];\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source);\n  }\n\n  return new RegExp('(?:' + parts.join('|') + ')', flags(options))\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}  tokens\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  options = options || {};\n\n  var strict = options.strict;\n  var start = options.start !== false;\n  var end = options.end !== false;\n  var delimiter = escapeString(options.delimiter || DEFAULT_DELIMITER);\n  var delimiters = options.delimiters || DEFAULT_DELIMITERS;\n  var endsWith = [].concat(options.endsWith || []).map(escapeString).concat('$').join('|');\n  var route = start ? '^' : '';\n  var isEndDelimited = tokens.length === 0;\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (typeof token === 'string') {\n      route += escapeString(token);\n      isEndDelimited = i === tokens.length - 1 && delimiters.indexOf(token[token.length - 1]) > -1;\n    } else {\n      var capture = token.repeat\n        ? '(?:' + token.pattern + ')(?:' + escapeString(token.delimiter) + '(?:' + token.pattern + '))*'\n        : token.pattern;\n\n      if (keys) keys.push(token);\n\n      if (token.optional) {\n        if (token.partial) {\n          route += escapeString(token.prefix) + '(' + capture + ')?';\n        } else {\n          route += '(?:' + escapeString(token.prefix) + '(' + capture + '))?';\n        }\n      } else {\n        route += escapeString(token.prefix) + '(' + capture + ')';\n      }\n    }\n  }\n\n  if (end) {\n    if (!strict) route += '(?:' + delimiter + ')?';\n\n    route += endsWith === '$' ? '$' : '(?=' + endsWith + ')';\n  } else {\n    if (!strict) route += '(?:' + delimiter + '(?=' + endsWith + '))?';\n    if (!isEndDelimited) route += '(?=' + delimiter + '|' + endsWith + ')';\n  }\n\n  return new RegExp(route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {Array=}                keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys)\n  }\n\n  if (Array.isArray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), keys, options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), keys, options)\n}\npathToRegexp_1.parse = parse_1;\npathToRegexp_1.compile = compile_1;\npathToRegexp_1.tokensToFunction = tokensToFunction_1;\npathToRegexp_1.tokensToRegExp = tokensToRegExp_1;\n\n/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright (c) 2015-present Kriasoft.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\nconst {hasOwnProperty} = Object.prototype;\nconst cache = new Map();\n// see https://github.com/pillarjs/path-to-regexp/issues/148\ncache.set('|false', {\n  keys: [],\n  pattern: /(?:)/\n});\n\nfunction decodeParam(val) {\n  try {\n    return decodeURIComponent(val);\n  } catch (err) {\n    return val;\n  }\n}\n\nfunction matchPath(routepath, path, exact, parentKeys, parentParams) {\n  exact = !!exact;\n  const cacheKey = `${routepath}|${exact}`;\n  let regexp = cache.get(cacheKey);\n\n  if (!regexp) {\n    const keys = [];\n    regexp = {\n      keys,\n      pattern: pathToRegexp_1(routepath, keys, {\n        end: exact,\n        strict: routepath === ''\n      }),\n    };\n    cache.set(cacheKey, regexp);\n  }\n\n  const m = regexp.pattern.exec(path);\n  if (!m) {\n    return null;\n  }\n\n  const params = Object.assign({}, parentParams);\n\n  for (let i = 1; i < m.length; i++) {\n    const key = regexp.keys[i - 1];\n    const prop = key.name;\n    const value = m[i];\n    if (value !== undefined || !hasOwnProperty.call(params, prop)) {\n      if (key.repeat) {\n        params[prop] = value ? value.split(key.delimiter).map(decodeParam) : [];\n      } else {\n        params[prop] = value ? decodeParam(value) : value;\n      }\n    }\n  }\n\n  return {\n    path: m[0],\n    keys: (parentKeys || []).concat(regexp.keys),\n    params,\n  };\n}\n\n/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright (c) 2015-present Kriasoft.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\n/**\n * Traverses the routes tree and matches its nodes to the given pathname from\n * the root down to the leaves. Each match consumes a part of the pathname and\n * the matching process continues for as long as there is a matching child\n * route for the remaining part of the pathname.\n *\n * The returned value is a lazily evaluated iterator.\n *\n * The leading \"/\" in a route path matters only for the root of the routes\n * tree (or if all parent routes are \"\"). In all other cases a leading \"/\" in\n * a child route path has no significance.\n *\n * The trailing \"/\" in a _route path_ matters only for the leaves of the\n * routes tree. A leaf route with a trailing \"/\" matches only a pathname that\n * also has a trailing \"/\".\n *\n * The trailing \"/\" in a route path does not affect matching of child routes\n * in any way.\n *\n * The trailing \"/\" in a _pathname_ generally does not matter (except for\n * the case of leaf nodes described above).\n *\n * The \"\" and \"/\" routes have special treatment:\n *  1. as a single route\n *     the \"\" and \"/\" routes match only the \"\" and \"/\" pathnames respectively\n *  2. as a parent in the routes tree\n *     the \"\" route matches any pathname without consuming any part of it\n *     the \"/\" route matches any absolute pathname consuming its leading \"/\"\n *  3. as a leaf in the routes tree\n *     the \"\" and \"/\" routes match only if the entire pathname is consumed by\n *         the parent routes chain. In this case \"\" and \"/\" are equivalent.\n *  4. several directly nested \"\" or \"/\" routes\n *     - directly nested \"\" or \"/\" routes are 'squashed' (i.e. nesting two\n *       \"/\" routes does not require a double \"/\" in the pathname to match)\n *     - if there are only \"\" in the parent routes chain, no part of the\n *       pathname is consumed, and the leading \"/\" in the child routes' paths\n *       remains significant\n *\n * Side effect:\n *   - the routes tree { path: '' } matches only the '' pathname\n *   - the routes tree { path: '', children: [ { path: '' } ] } matches any\n *     pathname (for the tree root)\n *\n * Prefix matching can be enabled also by `children: true`.\n */\nfunction matchRoute(route, pathname, ignoreLeadingSlash, parentKeys, parentParams) {\n  let match;\n  let childMatches;\n  let childIndex = 0;\n  let routepath = route.path || '';\n  if (routepath.charAt(0) === '/') {\n    if (ignoreLeadingSlash) {\n      routepath = routepath.substr(1);\n    }\n    ignoreLeadingSlash = true;\n  }\n\n  return {\n    next(routeToSkip) {\n      if (route === routeToSkip) {\n        return {done: true};\n      }\n\n      const children = route.__children = route.__children || route.children;\n\n      if (!match) {\n        match = matchPath(routepath, pathname, !children, parentKeys, parentParams);\n\n        if (match) {\n          return {\n            done: false,\n            value: {\n              route,\n              keys: match.keys,\n              params: match.params,\n              path: match.path\n            },\n          };\n        }\n      }\n\n      if (match && children) {\n        while (childIndex < children.length) {\n          if (!childMatches) {\n            const childRoute = children[childIndex];\n            childRoute.parent = route;\n\n            let matchedLength = match.path.length;\n            if (matchedLength > 0 && pathname.charAt(matchedLength) === '/') {\n              matchedLength += 1;\n            }\n\n            childMatches = matchRoute(\n              childRoute,\n              pathname.substr(matchedLength),\n              ignoreLeadingSlash,\n              match.keys,\n              match.params\n            );\n          }\n\n          const childMatch = childMatches.next(routeToSkip);\n          if (!childMatch.done) {\n            return {\n              done: false,\n              value: childMatch.value,\n            };\n          }\n\n          childMatches = null;\n          childIndex++;\n        }\n      }\n\n      return {done: true};\n    },\n  };\n}\n\n/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright (c) 2015-present Kriasoft.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\nfunction resolveRoute(context) {\n  if (isFunction(context.route.action)) {\n    return context.route.action(context);\n  }\n  return undefined;\n}\n\n/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright (c) 2015-present Kriasoft.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\nfunction isChildRoute(parentRoute, childRoute) {\n  let route = childRoute;\n  while (route) {\n    route = route.parent;\n    if (route === parentRoute) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction generateErrorMessage(currentContext) {\n  let errorMessage = `Path '${currentContext.pathname}' is not properly resolved due to an error.`;\n  const routePath = (currentContext.route || {}).path;\n  if (routePath) {\n    errorMessage += ` Resolution had failed on route: '${routePath}'`;\n  }\n  return errorMessage;\n}\n\nfunction updateChainForRoute(context, match) {\n  const {route, path} = match;\n\n  if (route && !route.__synthetic) {\n    const item = {path, route};\n    if (!context.chain) {\n      context.chain = [];\n    } else {\n      // Discard old items\n      if (route.parent) {\n        let i = context.chain.length;\n        while (i-- && context.chain[i].route && context.chain[i].route !== route.parent) {\n          context.chain.pop();\n        }\n      }\n    }\n    context.chain.push(item);\n  }\n}\n\n/**\n */\nclass Resolver {\n  constructor(routes, options = {}) {\n    if (Object(routes) !== routes) {\n      throw new TypeError('Invalid routes');\n    }\n\n    this.baseUrl = options.baseUrl || '';\n    this.errorHandler = options.errorHandler;\n    this.resolveRoute = options.resolveRoute || resolveRoute;\n    this.context = Object.assign({resolver: this}, options.context);\n    this.root = Array.isArray(routes) ? {path: '', __children: routes, parent: null, __synthetic: true} : routes;\n    this.root.parent = null;\n  }\n\n  /**\n   * Returns the current list of routes (as a shallow copy). Adding / removing\n   * routes to / from the returned array does not affect the routing config,\n   * but modifying the route objects does.\n   *\n   * @return {!Array<!Router.Route>}\n   */\n  getRoutes() {\n    return [...this.root.__children];\n  }\n\n  /**\n   * Sets the routing config (replacing the existing one).\n   *\n   * @param {!Array<!Router.Route>|!Router.Route} routes a single route or an array of those\n   *    (the array is shallow copied)\n   */\n  setRoutes(routes) {\n    ensureRoutes(routes);\n    const newRoutes = [...toArray(routes)];\n    this.root.__children = newRoutes;\n  }\n\n  /**\n   * Appends one or several routes to the routing config and returns the\n   * effective routing config after the operation.\n   *\n   * @param {!Array<!Router.Route>|!Router.Route} routes a single route or an array of those\n   *    (the array is shallow copied)\n   * @return {!Array<!Router.Route>}\n   * @protected\n   */\n  addRoutes(routes) {\n    ensureRoutes(routes);\n    this.root.__children.push(...toArray(routes));\n    return this.getRoutes();\n  }\n\n  /**\n   * Removes all existing routes from the routing config.\n   */\n  removeRoutes() {\n    this.setRoutes([]);\n  }\n\n  /**\n   * Asynchronously resolves the given pathname, i.e. finds all routes matching\n   * the pathname and tries resolving them one after another in the order they\n   * are listed in the routes config until the first non-null result.\n   *\n   * Returns a promise that is fulfilled with the return value of an object that consists of the first\n   * route handler result that returns something other than `null` or `undefined` and context used to get this result.\n   *\n   * If no route handlers return a non-null result, or if no route matches the\n   * given pathname the returned promise is rejected with a 'page not found'\n   * `Error`.\n   *\n   * @param {!string|!{pathname: !string}} pathnameOrContext the pathname to\n   *    resolve or a context object with a `pathname` property and other\n   *    properties to pass to the route resolver functions.\n   * @return {!Promise<any>}\n   */\n  resolve(pathnameOrContext) {\n    const context = Object.assign(\n      {},\n      this.context,\n      isString(pathnameOrContext) ? {pathname: pathnameOrContext} : pathnameOrContext\n    );\n    const match = matchRoute(\n      this.root,\n      this.__normalizePathname(context.pathname),\n      this.baseUrl\n    );\n    const resolve = this.resolveRoute;\n    let matches = null;\n    let nextMatches = null;\n    let currentContext = context;\n\n    function next(resume, parent = matches.value.route, prevResult) {\n      const routeToSkip = prevResult === null && matches.value.route;\n      matches = nextMatches || match.next(routeToSkip);\n      nextMatches = null;\n\n      if (!resume) {\n        if (matches.done || !isChildRoute(parent, matches.value.route)) {\n          nextMatches = matches;\n          return Promise.resolve(notFoundResult);\n        }\n      }\n\n      if (matches.done) {\n        return Promise.reject(getNotFoundError(context));\n      }\n\n      currentContext = Object.assign(\n        currentContext\n          ? {chain: (currentContext.chain ? currentContext.chain.slice(0) : [])}\n          : {},\n        context,\n        matches.value\n      );\n      updateChainForRoute(currentContext, matches.value);\n\n      return Promise.resolve(resolve(currentContext)).then(resolution => {\n        if (resolution !== null && resolution !== undefined && resolution !== notFoundResult) {\n          currentContext.result = resolution.result || resolution;\n          return currentContext;\n        }\n        return next(resume, parent, resolution);\n      });\n    }\n\n    context.next = next;\n\n    return Promise.resolve()\n      .then(() => next(true, this.root))\n      .catch((error) => {\n        const errorMessage = generateErrorMessage(currentContext);\n        if (!error) {\n          error = new Error(errorMessage);\n        } else {\n          console.warn(errorMessage);\n        }\n        error.context = error.context || currentContext;\n        // DOMException has its own code which is read-only\n        if (!(error instanceof DOMException)) {\n          error.code = error.code || 500;\n        }\n        if (this.errorHandler) {\n          currentContext.result = this.errorHandler(error);\n          return currentContext;\n        }\n        throw error;\n      });\n  }\n\n  /**\n   * URL constructor polyfill hook. Creates and returns an URL instance.\n   */\n  static __createUrl(url, base) {\n    return new URL(url, base);\n  }\n\n  /**\n   * If the baseUrl property is set, transforms the baseUrl and returns the full\n   * actual `base` string for using in the `new URL(path, base);` and for\n   * prepernding the paths with. The returned base ends with a trailing slash.\n   *\n   * Otherwise, returns empty string.\n   */\n  get __effectiveBaseUrl() {\n    return this.baseUrl\n      ? this.constructor.__createUrl(\n        this.baseUrl,\n        document.baseURI || document.URL\n      ).href.replace(/[^\\/]*$/, '')\n      : '';\n  }\n\n  /**\n   * If the baseUrl is set, matches the pathname with the router’s baseUrl,\n   * and returns the local pathname with the baseUrl stripped out.\n   *\n   * If the pathname does not match the baseUrl, returns undefined.\n   *\n   * If the `baseUrl` is not set, returns the unmodified pathname argument.\n   */\n  __normalizePathname(pathname) {\n    if (!this.baseUrl) {\n      // No base URL, no need to transform the pathname.\n      return pathname;\n    }\n\n    const base = this.__effectiveBaseUrl;\n    const normalizedUrl = this.constructor.__createUrl(pathname, base).href;\n    if (normalizedUrl.slice(0, base.length) === base) {\n      return normalizedUrl.slice(base.length);\n    }\n  }\n}\n\nResolver.pathToRegexp = pathToRegexp_1;\n\n/**\n * Universal Router (https://www.kriasoft.com/universal-router/)\n *\n * Copyright (c) 2015-present Kriasoft.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.txt file in the root directory of this source tree.\n */\n\nconst {pathToRegexp: pathToRegexp$1} = Resolver;\nconst cache$1 = new Map();\n\nfunction cacheRoutes(routesByName, route, routes) {\n  const name = route.name || route.component;\n  if (name) {\n    if (routesByName.has(name)) {\n      routesByName.get(name).push(route);\n    } else {\n      routesByName.set(name, [route]);\n    }\n  }\n\n  if (Array.isArray(routes)) {\n    for (let i = 0; i < routes.length; i++) {\n      const childRoute = routes[i];\n      childRoute.parent = route;\n      cacheRoutes(routesByName, childRoute, childRoute.__children || childRoute.children);\n    }\n  }\n}\n\nfunction getRouteByName(routesByName, routeName) {\n  const routes = routesByName.get(routeName);\n  if (routes && routes.length > 1) {\n    throw new Error(\n      `Duplicate route with name \"${routeName}\".`\n      + ` Try seting unique 'name' route properties.`\n    );\n  }\n  return routes && routes[0];\n}\n\nfunction getRoutePath(route) {\n  let path = route.path;\n  path = Array.isArray(path) ? path[0] : path;\n  return path !== undefined ? path : '';\n}\n\nfunction generateUrls(router, options = {}) {\n  if (!(router instanceof Resolver)) {\n    throw new TypeError('An instance of Resolver is expected');\n  }\n\n  const routesByName = new Map();\n\n  return (routeName, params) => {\n    let route = getRouteByName(routesByName, routeName);\n    if (!route) {\n      routesByName.clear(); // clear cache\n      cacheRoutes(routesByName, router.root, router.root.__children);\n\n      route = getRouteByName(routesByName, routeName);\n      if (!route) {\n        throw new Error(`Route \"${routeName}\" not found`);\n      }\n    }\n\n    let regexp = cache$1.get(route.fullPath);\n    if (!regexp) {\n      let fullPath = getRoutePath(route);\n      let rt = route.parent;\n      while (rt) {\n        const path = getRoutePath(rt);\n        if (path) {\n          fullPath = path.replace(/\\/$/, '') + '/' + fullPath.replace(/^\\//, '');\n        }\n        rt = rt.parent;\n      }\n      const tokens = pathToRegexp$1.parse(fullPath);\n      const toPath = pathToRegexp$1.tokensToFunction(tokens);\n      const keys = Object.create(null);\n      for (let i = 0; i < tokens.length; i++) {\n        if (!isString(tokens[i])) {\n          keys[tokens[i].name] = true;\n        }\n      }\n      regexp = {toPath, keys};\n      cache$1.set(fullPath, regexp);\n      route.fullPath = fullPath;\n    }\n\n    let url = regexp.toPath(params, options) || '/';\n\n    if (options.stringifyQueryParams && params) {\n      const queryParams = {};\n      const keys = Object.keys(params);\n      for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        if (!regexp.keys[key]) {\n          queryParams[key] = params[key];\n        }\n      }\n      const query = options.stringifyQueryParams(queryParams);\n      if (query) {\n        url += query.charAt(0) === '?' ? query : `?${query}`;\n      }\n    }\n\n    return url;\n  };\n}\n\n/**\n * @typedef NavigationTrigger\n * @type {object}\n * @property {function()} activate\n * @property {function()} inactivate\n */\n\n/** @type {Array<NavigationTrigger>} */\nlet triggers = [];\n\nfunction setNavigationTriggers(newTriggers) {\n  triggers.forEach(trigger => trigger.inactivate());\n\n  newTriggers.forEach(trigger => trigger.activate());\n\n  triggers = newTriggers;\n}\n\nconst willAnimate = elem => {\n  const name = getComputedStyle(elem).getPropertyValue('animation-name');\n  return name && name !== 'none';\n};\n\nconst waitForAnimation = (elem, cb) => {\n  const listener = () => {\n    elem.removeEventListener('animationend', listener);\n    cb();\n  };\n  elem.addEventListener('animationend', listener);\n};\n\nfunction animate(elem, className) {\n  elem.classList.add(className);\n\n  return new Promise(resolve => {\n    if (willAnimate(elem)) {\n      const rect = elem.getBoundingClientRect();\n      const size = `height: ${rect.bottom - rect.top}px; width: ${rect.right - rect.left}px`;\n      elem.setAttribute('style', `position: absolute; ${size}`);\n      waitForAnimation(elem, () => {\n        elem.classList.remove(className);\n        elem.removeAttribute('style');\n        resolve();\n      });\n    } else {\n      elem.classList.remove(className);\n      resolve();\n    }\n  });\n}\n\nconst MAX_REDIRECT_COUNT = 256;\n\nfunction isResultNotEmpty(result) {\n  return result !== null && result !== undefined;\n}\n\nfunction copyContextWithoutNext(context) {\n  const copy = Object.assign({}, context);\n  delete copy.next;\n  return copy;\n}\n\nfunction createLocation({pathname = '', search = '', hash = '', chain = [], params = {}, redirectFrom, resolver}, route) {\n  const routes = chain.map(item => item.route);\n  return {\n    baseUrl: resolver && resolver.baseUrl || '',\n    pathname,\n    search,\n    hash,\n    routes,\n    route: route || routes.length && routes[routes.length - 1] || null,\n    params,\n    redirectFrom,\n    getUrl: (userParams = {}) => getPathnameForRouter(\n      Router.pathToRegexp.compile(\n        getMatchedPath(routes)\n      )(Object.assign({}, params, userParams)),\n      resolver\n    )\n  };\n}\n\nfunction createRedirect(context, pathname) {\n  const params = Object.assign({}, context.params);\n  return {\n    redirect: {\n      pathname,\n      from: context.pathname,\n      params\n    }\n  };\n}\n\nfunction renderElement(context, element) {\n  element.location = createLocation(context);\n  const index = context.chain.map(item => item.route).indexOf(context.route);\n  context.chain[index].element = element;\n  return element;\n}\n\nfunction runCallbackIfPossible(callback, args, thisArg) {\n  if (isFunction(callback)) {\n    return callback.apply(thisArg, args);\n  }\n}\n\nfunction amend(amendmentFunction, args, element) {\n  return amendmentResult => {\n    if (amendmentResult && (amendmentResult.cancel || amendmentResult.redirect)) {\n      return amendmentResult;\n    }\n\n    if (element) {\n      return runCallbackIfPossible(element[amendmentFunction], args, element);\n    }\n  };\n}\n\nfunction processNewChildren(newChildren, route) {\n  if (!Array.isArray(newChildren) && !isObject(newChildren)) {\n    throw new Error(\n      log(\n        `Incorrect \"children\" value for the route ${route.path}: expected array or object, but got ${newChildren}`\n      )\n    );\n  }\n\n  route.__children = [];\n  const childRoutes = toArray(newChildren);\n  for (let i = 0; i < childRoutes.length; i++) {\n    ensureRoute(childRoutes[i]);\n    route.__children.push(childRoutes[i]);\n  }\n}\n\nfunction removeDomNodes(nodes) {\n  if (nodes && nodes.length) {\n    const parent = nodes[0].parentNode;\n    for (let i = 0; i < nodes.length; i++) {\n      parent.removeChild(nodes[i]);\n    }\n  }\n}\n\nfunction getPathnameForRouter(pathname, router) {\n  const base = router.__effectiveBaseUrl;\n  return base\n    ? router.constructor.__createUrl(pathname.replace(/^\\//, ''), base).pathname\n    : pathname;\n}\n\nfunction getMatchedPath(chain) {\n  return chain.map(item => item.path).reduce((a, b) => {\n    if (b.length) {\n      return a.replace(/\\/$/, '') + '/' + b.replace(/^\\//, '');\n    }\n    return a;\n  }, '');\n}\n\n/**\n * A simple client-side router for single-page applications. It uses\n * express-style middleware and has a first-class support for Web Components and\n * lazy-loading. Works great in Polymer and non-Polymer apps.\n *\n * Use `new Router(outlet, options)` to create a new Router instance.\n *\n * * The `outlet` parameter is a reference to the DOM node to render\n *   the content into.\n *\n * * The `options` parameter is an optional object with options. The following\n *   keys are supported:\n *   * `baseUrl` — the initial value for [\n *     the `baseUrl` property\n *   ](#/classes/Router#property-baseUrl)\n *\n * The Router instance is automatically subscribed to navigation events\n * on `window`.\n *\n * See [Live Examples](#/classes/Router/demos/demo/index.html) for the detailed usage demo and code snippets.\n *\n * See also detailed API docs for the following methods, for the advanced usage:\n *\n * * [setOutlet](#/classes/Router#method-setOutlet) – should be used to configure the outlet.\n * * [setTriggers](#/classes/Router#method-setTriggers) – should be used to configure the navigation events.\n * * [setRoutes](#/classes/Router#method-setRoutes) – should be used to configure the routes.\n *\n * Only `setRoutes` has to be called manually, others are automatically invoked when creating a new instance.\n *\n * @extends Resolver\n * @demo demo/index.html\n * @summary JavaScript class that renders different DOM content depending on\n *    a given path. It can re-render when triggered or automatically on\n *    'popstate' and / or 'click' events.\n */\nclass Router extends Resolver {\n\n  /**\n   * Creates a new Router instance with a given outlet, and\n   * automatically subscribes it to navigation events on the `window`.\n   * Using a constructor argument or a setter for outlet is equivalent:\n   *\n   * ```\n   * const router = new Router();\n   * router.setOutlet(outlet);\n   * ```\n   * @param {?Node=} outlet\n   * @param {?RouterOptions=} options\n   */\n  constructor(outlet, options) {\n    const baseElement = document.head.querySelector('base');\n    const baseHref = baseElement && baseElement.getAttribute('href');\n    super([], Object.assign({\n      // Default options\n      baseUrl: baseHref && Resolver.__createUrl(baseHref, document.URL).pathname.replace(/[^\\/]*$/, '')\n    }, options));\n\n    this.resolveRoute = context => this.__resolveRoute(context);\n\n    const triggers = Router.NavigationTrigger;\n    Router.setTriggers.apply(Router, Object.keys(triggers).map(key => triggers[key]));\n\n    /**\n     * The base URL for all routes in the router instance. By default,\n     * if the base element exists in the `<head>`, vaadin-router\n     * takes the `<base href>` attribute value, resolves against current `document.URL`\n     * and gets the `pathname` from the result.\n     *\n     * @public\n     * @type {string}\n     */\n    this.baseUrl;\n\n    /**\n     * A promise that is settled after the current render cycle completes. If\n     * there is no render cycle in progress the promise is immediately settled\n     * with the last render cycle result.\n     *\n     * @public\n     * @type {!Promise<!RouterLocation>}\n     */\n    this.ready;\n    this.ready = Promise.resolve(outlet);\n\n    /**\n     * Contains read-only information about the current router location:\n     * pathname, active routes, parameters. See the\n     * [Location type declaration](#/classes/RouterLocation)\n     * for more details.\n     *\n     * @public\n     * @type {!RouterLocation}\n     */\n    this.location;\n    this.location = createLocation({resolver: this});\n\n    this.__lastStartedRenderId = 0;\n    this.__navigationEventHandler = this.__onNavigationEvent.bind(this);\n    this.setOutlet(outlet);\n    this.subscribe();\n    // Using WeakMap instead of WeakSet because WeakSet is not supported by IE11\n    this.__createdByRouter = new WeakMap();\n    this.__addedByRouter = new WeakMap();\n  }\n\n  __resolveRoute(context) {\n    const route = context.route;\n\n    let callbacks = Promise.resolve();\n\n    if (isFunction(route.children)) {\n      callbacks = callbacks\n        .then(() => route.children(copyContextWithoutNext(context)))\n        .then(children => {\n          // The route.children() callback might have re-written the\n          // route.children property instead of returning a value\n          if (!isResultNotEmpty(children) && !isFunction(route.children)) {\n            children = route.children;\n          }\n          processNewChildren(children, route);\n        });\n    }\n\n    const commands = {\n      redirect: path => createRedirect(context, path),\n      component: (component) => {\n        const element = document.createElement(component);\n        this.__createdByRouter.set(element, true);\n        return element;\n      }\n    };\n\n    return callbacks\n      .then(() => {\n        if (this.__isLatestRender(context)) {\n          return runCallbackIfPossible(route.action, [context, commands], route);\n        }\n      })\n      .then(result => {\n        if (isResultNotEmpty(result)) {\n          // Actions like `() => import('my-view.js')` are not expected to\n          // end the resolution, despite the result is not empty. Checking\n          // the result with a whitelist of values that end the resolution.\n          if (result instanceof HTMLElement ||\n              result.redirect ||\n              result === notFoundResult) {\n            return result;\n          }\n        }\n\n        if (isString(route.redirect)) {\n          return commands.redirect(route.redirect);\n        }\n\n        if (route.bundle) {\n          return loadBundle(route.bundle)\n            .then(() => {}, () => {\n              throw new Error(log(`Bundle not found: ${route.bundle}. Check if the file name is correct`));\n            });\n        }\n      })\n      .then(result => {\n        if (isResultNotEmpty(result)) {\n          return result;\n        }\n        if (isString(route.component)) {\n          return commands.component(route.component);\n        }\n      });\n  }\n\n  /**\n   * Sets the router outlet (the DOM node where the content for the current\n   * route is inserted). Any content pre-existing in the router outlet is\n   * removed at the end of each render pass.\n   *\n   * NOTE: this method is automatically invoked first time when creating a new Router instance.\n   *\n   * @param {?Node} outlet the DOM node where the content for the current route\n   *     is inserted.\n   */\n  setOutlet(outlet) {\n    if (outlet) {\n      this.__ensureOutlet(outlet);\n    }\n    this.__outlet = outlet;\n  }\n\n  /**\n   * Returns the current router outlet. The initial value is `undefined`.\n   *\n   * @return {?Node} the current router outlet (or `undefined`)\n   */\n  getOutlet() {\n    return this.__outlet;\n  }\n\n  /**\n   * Sets the routing config (replacing the existing one) and triggers a\n   * navigation event so that the router outlet is refreshed according to the\n   * current `window.location` and the new routing config.\n   *\n   * Each route object may have the following properties, listed here in the processing order:\n   * * `path` – the route path (relative to the parent route if any) in the\n   * [express.js syntax](https://expressjs.com/en/guide/routing.html#route-paths\").\n   *\n   * * `children` – an array of nested routes or a function that provides this\n   * array at the render time. The function can be synchronous or asynchronous:\n   * in the latter case the render is delayed until the returned promise is\n   * resolved. The `children` function is executed every time when this route is\n   * being rendered. This allows for dynamic route structures (e.g. backend-defined),\n   * but it might have a performance impact as well. In order to avoid calling\n   * the function on subsequent renders, you can override the `children` property\n   * of the route object and save the calculated array there\n   * (via `context.route.children = [ route1, route2, ...];`).\n   * Parent routes are fully resolved before resolving the children. Children\n   * 'path' values are relative to the parent ones.\n   *\n   * * `action` – the action that is executed before the route is resolved.\n   * The value for this property should be a function, accepting `context`\n   * and `commands` parameters described below. If present, this function is\n   * always invoked first, disregarding of the other properties' presence.\n   * The action can return a result directly or within a `Promise`, which\n   * resolves to the result. If the action result is an `HTMLElement` instance,\n   * a `commands.component(name)` result, a `commands.redirect(path)` result,\n   * or a `context.next()` result, the current route resolution is finished,\n   * and other route config properties are ignored.\n   * See also **Route Actions** section in [Live Examples](#/classes/Router/demos/demo/index.html).\n   *\n   * * `redirect` – other route's path to redirect to. Passes all route parameters to the redirect target.\n   * The target route should also be defined.\n   * See also **Redirects** section in [Live Examples](#/classes/Router/demos/demo/index.html).\n   *\n   * * `bundle` – string containing the path to `.js` or `.mjs` bundle to load before resolving the route,\n   * or the object with \"module\" and \"nomodule\" keys referring to different bundles.\n   * Each bundle is only loaded once. If \"module\" and \"nomodule\" are set, only one bundle is loaded,\n   * depending on whether the browser supports ES modules or not.\n   * The property is ignored when either an `action` returns the result or `redirect` property is present.\n   * Any error, e.g. 404 while loading bundle will cause route resolution to throw.\n   * See also **Code Splitting** section in [Live Examples](#/classes/Router/demos/demo/index.html).\n   *\n   * * `component` – the tag name of the Web Component to resolve the route to.\n   * The property is ignored when either an `action` returns the result or `redirect` property is present.\n   * If route contains the `component` property (or an action that return a component)\n   * and its child route also contains the `component` property, child route's component\n   * will be rendered as a light dom child of a parent component.\n   *\n   * * `name` – the string name of the route to use in the\n   * [`router.urlForName(name, params)`](#/classes/Router#method-urlForName)\n   * navigation helper method.\n   *\n   * For any route function (`action`, `children`) defined, the corresponding `route` object is available inside the callback\n   * through the `this` reference. If you need to access it, make sure you define the callback as a non-arrow function\n   * because arrow functions do not have their own `this` reference.\n   *\n   * `context` object that is passed to `action` function holds the following properties:\n   * * `context.pathname` – string with the pathname being resolved\n   *\n   * * `context.search` – search query string\n   *\n   * * `context.hash` – hash string\n   *\n   * * `context.params` – object with route parameters\n   *\n   * * `context.route` – object that holds the route that is currently being rendered.\n   *\n   * * `context.next()` – function for asynchronously getting the next route\n   * contents from the resolution chain (if any)\n   *\n   * `commands` object that is passed to `action` function has\n   * the following methods:\n   *\n   * * `commands.redirect(path)` – function that creates a redirect data\n   * for the path specified.\n   *\n   * * `commands.component(component)` – function that creates a new HTMLElement\n   * with current context. Note: the component created by this function is reused if visiting the same path twice in row.\n   *\n   *\n   * @param {!Array<!Route>|!Route} routes a single route or an array of those\n   * @param {?boolean} skipRender configure the router but skip rendering the\n   *     route corresponding to the current `window.location` values\n   *\n   * @return {!Promise<!Node>}\n   */\n  setRoutes(routes, skipRender = false) {\n    this.__previousContext = undefined;\n    this.__urlForName = undefined;\n    super.setRoutes(routes);\n    if (!skipRender) {\n      this.__onNavigationEvent();\n    }\n    return this.ready;\n  }\n\n  /**\n   * Asynchronously resolves the given pathname and renders the resolved route\n   * component into the router outlet. If no router outlet is set at the time of\n   * calling this method, or at the time when the route resolution is completed,\n   * a `TypeError` is thrown.\n   *\n   * Returns a promise that is fulfilled with the router outlet DOM Node after\n   * the route component is created and inserted into the router outlet, or\n   * rejected if no route matches the given path.\n   *\n   * If another render pass is started before the previous one is completed, the\n   * result of the previous render pass is ignored.\n   *\n   * @param {!string|!{pathname: !string, search: ?string, hash: ?string}} pathnameOrContext\n   *    the pathname to render or a context object with a `pathname` property,\n   *    optional `search` and `hash` properties, and other properties\n   *    to pass to the resolver.\n   * @param {boolean=} shouldUpdateHistory\n   *    update browser history with the rendered location\n   * @return {!Promise<!Node>}\n   */\n  render(pathnameOrContext, shouldUpdateHistory) {\n    const renderId = ++this.__lastStartedRenderId;\n    const context = Object.assign(\n      {\n        search: '',\n        hash: ''\n      },\n      isString(pathnameOrContext)\n        ? {pathname: pathnameOrContext}\n        : pathnameOrContext,\n      {\n        __renderId: renderId\n      }\n    );\n\n    // Find the first route that resolves to a non-empty result\n    this.ready = this.resolve(context)\n\n      // Process the result of this.resolve() and handle all special commands:\n      // (redirect / prevent / component). If the result is a 'component',\n      // then go deeper and build the entire chain of nested components matching\n      // the pathname. Also call all 'on before' callbacks along the way.\n      .then(context => this.__fullyResolveChain(context))\n\n      .then(context => {\n        if (this.__isLatestRender(context)) {\n          const previousContext = this.__previousContext;\n\n          // Check if the render was prevented and make an early return in that case\n          if (context === previousContext) {\n            // Replace the history with the previous context\n            // to make sure the URL stays the same.\n            this.__updateBrowserHistory(previousContext, true);\n            return this.location;\n          }\n\n          this.location = createLocation(context);\n\n          if (shouldUpdateHistory) {\n            // Replace only if first render redirects, so that we don’t leave\n            // the redirecting record in the history\n            this.__updateBrowserHistory(context, renderId === 1);\n          }\n\n          fireRouterEvent('location-changed', {router: this, location: this.location});\n\n          // Skip detaching/re-attaching there are no render changes\n          if (context.__skipAttach) {\n            this.__copyUnchangedElements(context, previousContext);\n            this.__previousContext = context;\n            return this.location;\n          }\n\n          this.__addAppearingContent(context, previousContext);\n          const animationDone = this.__animateIfNeeded(context);\n\n          this.__runOnAfterEnterCallbacks(context);\n          this.__runOnAfterLeaveCallbacks(context, previousContext);\n\n          return animationDone.then(() => {\n            if (this.__isLatestRender(context)) {\n              // If there is another render pass started after this one,\n              // the 'disappearing content' would be removed when the other\n              // render pass calls `this.__addAppearingContent()`\n              this.__removeDisappearingContent();\n\n              this.__previousContext = context;\n              return this.location;\n            }\n          });\n        }\n      })\n      .catch(error => {\n        if (renderId === this.__lastStartedRenderId) {\n          if (shouldUpdateHistory) {\n            this.__updateBrowserHistory(context);\n          }\n          removeDomNodes(this.__outlet && this.__outlet.children);\n          this.location = createLocation(Object.assign(context, {resolver: this}));\n          fireRouterEvent('error', Object.assign({router: this, error}, context));\n          throw error;\n        }\n      });\n    return this.ready;\n  }\n\n  // `topOfTheChainContextBeforeRedirects` is a context coming from Resolver.resolve().\n  // It would contain a 'redirect' route or the first 'component' route that\n  // matched the pathname. There might be more child 'component' routes to be\n  // resolved and added into the chain. This method would find and add them.\n  // `contextBeforeRedirects` is the context containing such a child component\n  // route. It's only necessary when this method is called recursively (otherwise\n  // it's the same as the 'top of the chain' context).\n  //\n  // Apart from building the chain of child components, this method would also\n  // handle 'redirect' routes, call 'onBefore' callbacks and handle 'prevent'\n  // and 'redirect' callback results.\n  __fullyResolveChain(topOfTheChainContextBeforeRedirects,\n    contextBeforeRedirects = topOfTheChainContextBeforeRedirects) {\n    return this.__findComponentContextAfterAllRedirects(contextBeforeRedirects)\n      // `contextAfterRedirects` is always a context with an `HTMLElement` result\n      // In other cases the promise gets rejected and .then() is not called\n      .then(contextAfterRedirects => {\n        const redirectsHappened = contextAfterRedirects !== contextBeforeRedirects;\n        const topOfTheChainContextAfterRedirects =\n          redirectsHappened ? contextAfterRedirects : topOfTheChainContextBeforeRedirects;\n\n        const matchedPath = getPathnameForRouter(\n          getMatchedPath(contextAfterRedirects.chain),\n          contextAfterRedirects.resolver\n        );\n        const isFound = (matchedPath === contextAfterRedirects.pathname);\n\n        // Recursive method to try matching more child and sibling routes\n        const findNextContextIfAny = (context, parent = context.route, prevResult) => {\n          return context.next(undefined, parent, prevResult).then(nextContext => {\n            if (nextContext === null || nextContext === notFoundResult) {\n              // Next context is not found in children, ...\n              if (isFound) {\n                // ...but original context is already fully matching - use it\n                return context;\n              } else if (parent.parent !== null) {\n                // ...and there is no full match yet - step up to check siblings\n                return findNextContextIfAny(context, parent.parent, nextContext);\n              } else {\n                return nextContext;\n              }\n            }\n\n            return nextContext;\n          });\n        };\n\n        return findNextContextIfAny(contextAfterRedirects).then(nextContext => {\n          if (nextContext === null || nextContext === notFoundResult) {\n            throw getNotFoundError(topOfTheChainContextAfterRedirects);\n          }\n\n          return nextContext\n          && nextContext !== notFoundResult\n          && nextContext !== contextAfterRedirects\n            ? this.__fullyResolveChain(topOfTheChainContextAfterRedirects, nextContext)\n            : this.__amendWithOnBeforeCallbacks(contextAfterRedirects);\n        });\n      });\n  }\n\n  __findComponentContextAfterAllRedirects(context) {\n    const result = context.result;\n    if (result instanceof HTMLElement) {\n      renderElement(context, result);\n      return Promise.resolve(context);\n    } else if (result.redirect) {\n      return this.__redirect(result.redirect, context.__redirectCount, context.__renderId)\n        .then(context => this.__findComponentContextAfterAllRedirects(context));\n    } else if (result instanceof Error) {\n      return Promise.reject(result);\n    } else {\n      return Promise.reject(\n        new Error(\n          log(\n            `Invalid route resolution result for path \"${context.pathname}\". ` +\n            `Expected redirect object or HTML element, but got: \"${logValue(result)}\". ` +\n            `Double check the action return value for the route.`\n          )\n        ));\n    }\n  }\n\n  __amendWithOnBeforeCallbacks(contextWithFullChain) {\n    return this.__runOnBeforeCallbacks(contextWithFullChain).then(amendedContext => {\n      if (amendedContext === this.__previousContext || amendedContext === contextWithFullChain) {\n        return amendedContext;\n      }\n      return this.__fullyResolveChain(amendedContext);\n    });\n  }\n\n  __runOnBeforeCallbacks(newContext) {\n    const previousContext = this.__previousContext || {};\n    const previousChain = previousContext.chain || [];\n    const newChain = newContext.chain;\n\n    let callbacks = Promise.resolve();\n    const prevent = () => ({cancel: true});\n    const redirect = (pathname) => createRedirect(newContext, pathname);\n\n    newContext.__divergedChainIndex = 0;\n    newContext.__skipAttach = false;\n    if (previousChain.length) {\n      for (let i = 0; i < Math.min(previousChain.length, newChain.length); i = ++newContext.__divergedChainIndex) {\n        if (previousChain[i].route !== newChain[i].route\n          || previousChain[i].path !== newChain[i].path && previousChain[i].element !== newChain[i].element\n          || !this.__isReusableElement(previousChain[i].element, newChain[i].element)) {\n          break;\n        }\n      }\n\n      // Skip re-attaching and notifications if element and chain do not change\n      newContext.__skipAttach =\n        // Same route chain\n        newChain.length === previousChain.length && newContext.__divergedChainIndex == newChain.length &&\n        // Same element\n        this.__isReusableElement(newContext.result, previousContext.result);\n\n      if (newContext.__skipAttach) {\n        // execute onBeforeLeave for changed segment element when skipping attach\n        for (let i = newChain.length - 1; i >= 0; i--) {\n          callbacks = this.__runOnBeforeLeaveCallbacks(callbacks, newContext, {prevent}, previousChain[i]);\n        }\n        // execute onBeforeEnter for changed segment element when skipping attach\n        for (let i = 0; i < newChain.length; i++) {\n          callbacks = this.__runOnBeforeEnterCallbacks(callbacks, newContext, {prevent, redirect}, newChain[i]);\n          previousChain[i].element.location = createLocation(newContext, previousChain[i].route);\n        }\n\n      } else {\n        // execute onBeforeLeave when NOT skipping attach\n        for (let i = previousChain.length - 1; i >= newContext.__divergedChainIndex; i--) {\n          callbacks = this.__runOnBeforeLeaveCallbacks(callbacks, newContext, {prevent}, previousChain[i]);\n        }\n      }\n    }\n    // execute onBeforeEnter when NOT skipping attach\n    if (!newContext.__skipAttach) {\n      for (let i = 0; i < newChain.length; i++) {\n        if (i < newContext.__divergedChainIndex) {\n          if (i < previousChain.length && previousChain[i].element) {\n            previousChain[i].element.location = createLocation(newContext, previousChain[i].route);\n          }\n        } else {\n          callbacks = this.__runOnBeforeEnterCallbacks(callbacks, newContext, {prevent, redirect}, newChain[i]);\n          if (newChain[i].element) {\n            newChain[i].element.location = createLocation(newContext, newChain[i].route);\n          }\n        }\n      }\n    }\n    return callbacks.then(amendmentResult => {\n      if (amendmentResult) {\n        if (amendmentResult.cancel) {\n          this.__previousContext.__renderId = newContext.__renderId;\n          return this.__previousContext;\n        }\n        if (amendmentResult.redirect) {\n          return this.__redirect(amendmentResult.redirect, newContext.__redirectCount, newContext.__renderId);\n        }\n      }\n      return newContext;\n    });\n  }\n\n  __runOnBeforeLeaveCallbacks(callbacks, newContext, commands, chainElement) {\n    const location = createLocation(newContext);\n    return callbacks.then(result => {\n      if (this.__isLatestRender(newContext)) {\n        const afterLeaveFunction = amend('onBeforeLeave', [location, commands, this], chainElement.element);\n        return afterLeaveFunction(result);\n      }\n    }).then(result => {\n      if (!(result || {}).redirect) {\n        return result;\n      }\n    });\n  }\n\n  __runOnBeforeEnterCallbacks(callbacks, newContext, commands, chainElement) {\n    const location = createLocation(newContext, chainElement.route);\n    return callbacks.then(result => {\n      if (this.__isLatestRender(newContext)) {\n        const beforeEnterFunction = amend('onBeforeEnter', [location, commands, this], chainElement.element);\n        return beforeEnterFunction(result);\n      }\n    });\n  }\n\n  __isReusableElement(element, otherElement) {\n    if (element && otherElement) {\n      return this.__createdByRouter.get(element) && this.__createdByRouter.get(otherElement)\n        ? element.localName === otherElement.localName\n        : element === otherElement;\n    }\n    return false;\n  }\n\n  __isLatestRender(context) {\n    return context.__renderId === this.__lastStartedRenderId;\n  }\n\n  __redirect(redirectData, counter, renderId) {\n    if (counter > MAX_REDIRECT_COUNT) {\n      throw new Error(log(`Too many redirects when rendering ${redirectData.from}`));\n    }\n\n    return this.resolve({\n      pathname: this.urlForPath(\n        redirectData.pathname,\n        redirectData.params\n      ),\n      redirectFrom: redirectData.from,\n      __redirectCount: (counter || 0) + 1,\n      __renderId: renderId\n    });\n  }\n\n  __ensureOutlet(outlet = this.__outlet) {\n    if (!(outlet instanceof Node)) {\n      throw new TypeError(log(`Expected router outlet to be a valid DOM Node (but got ${outlet})`));\n    }\n  }\n\n  __updateBrowserHistory({pathname, search = '', hash = ''}, replace) {\n    if (window.location.pathname !== pathname\n        || window.location.search !== search\n        || window.location.hash !== hash\n    ) {\n      const changeState = replace ? 'replaceState' : 'pushState';\n      window.history[changeState](null, document.title, pathname + search + hash);\n      window.dispatchEvent(new PopStateEvent('popstate', {state: 'vaadin-router-ignore'}));\n    }\n  }\n\n  __copyUnchangedElements(context, previousContext) {\n    // Find the deepest common parent between the last and the new component\n    // chains. Update references for the unchanged elements in the new chain\n    let deepestCommonParent = this.__outlet;\n    for (let i = 0; i < context.__divergedChainIndex; i++) {\n      const unchangedElement = previousContext && previousContext.chain[i].element;\n      if (unchangedElement) {\n        if (unchangedElement.parentNode === deepestCommonParent) {\n          context.chain[i].element = unchangedElement;\n          deepestCommonParent = unchangedElement;\n        } else {\n          break;\n        }\n      }\n    }\n    return deepestCommonParent;\n  }\n\n  __addAppearingContent(context, previousContext) {\n    this.__ensureOutlet();\n\n    // If the previous 'entering' animation has not completed yet,\n    // stop it and remove that content from the DOM before adding new one.\n    this.__removeAppearingContent();\n\n    // Copy reusable elements from the previousContext to current\n    const deepestCommonParent = this.__copyUnchangedElements(context, previousContext);\n\n    // Keep two lists of DOM elements:\n    //  - those that should be removed once the transition animation is over\n    //  - and those that should remain\n    this.__appearingContent = [];\n    this.__disappearingContent = Array\n      .from(deepestCommonParent.children)\n      .filter(\n        // Only remove layout content that was added by router\n        e => this.__addedByRouter.get(e) &&\n        // Do not remove the result element to avoid flickering\n        e !== context.result);\n\n    // Add new elements (starting after the deepest common parent) to the DOM.\n    // That way only the components that are actually different between the two\n    // locations are added to the DOM (and those that are common remain in the\n    // DOM without first removing and then adding them again).\n    let parentElement = deepestCommonParent;\n    for (let i = context.__divergedChainIndex; i < context.chain.length; i++) {\n      const elementToAdd = context.chain[i].element;\n      if (elementToAdd) {\n        parentElement.appendChild(elementToAdd);\n        this.__addedByRouter.set(elementToAdd, true);\n        if (parentElement === deepestCommonParent) {\n          this.__appearingContent.push(elementToAdd);\n        }\n        parentElement = elementToAdd;\n      }\n    }\n  }\n\n  __removeDisappearingContent() {\n    if (this.__disappearingContent) {\n      removeDomNodes(this.__disappearingContent);\n    }\n    this.__disappearingContent = null;\n    this.__appearingContent = null;\n  }\n\n  __removeAppearingContent() {\n    if (this.__disappearingContent && this.__appearingContent) {\n      removeDomNodes(this.__appearingContent);\n      this.__disappearingContent = null;\n      this.__appearingContent = null;\n    }\n  }\n\n  __runOnAfterLeaveCallbacks(currentContext, targetContext) {\n    if (!targetContext) {\n      return;\n    }\n\n    // REVERSE iteration: from Z to A\n    for (let i = targetContext.chain.length - 1; i >= currentContext.__divergedChainIndex; i--) {\n      if (!this.__isLatestRender(currentContext)) {\n        break;\n      }\n      const currentComponent = targetContext.chain[i].element;\n      if (!currentComponent) {\n        continue;\n      }\n      try {\n        const location = createLocation(currentContext);\n        runCallbackIfPossible(\n          currentComponent.onAfterLeave,\n          [location, {}, targetContext.resolver],\n          currentComponent);\n      } finally {\n        if (this.__disappearingContent.indexOf(currentComponent) > -1) {\n          removeDomNodes(currentComponent.children);\n        }\n      }\n    }\n  }\n\n  __runOnAfterEnterCallbacks(currentContext) {\n    // forward iteration: from A to Z\n    for (let i = currentContext.__divergedChainIndex; i < currentContext.chain.length; i++) {\n      if (!this.__isLatestRender(currentContext)) {\n        break;\n      }\n      const currentComponent = currentContext.chain[i].element || {};\n      const location = createLocation(currentContext, currentContext.chain[i].route);\n      runCallbackIfPossible(\n        currentComponent.onAfterEnter,\n        [location, {}, currentContext.resolver],\n        currentComponent);\n    }\n  }\n\n  __animateIfNeeded(context) {\n    const from = (this.__disappearingContent || [])[0];\n    const to = (this.__appearingContent || [])[0];\n    const promises = [];\n\n    const chain = context.chain;\n    let config;\n    for (let i = chain.length; i > 0; i--) {\n      if (chain[i - 1].route.animate) {\n        config = chain[i - 1].route.animate;\n        break;\n      }\n    }\n\n    if (from && to && config) {\n      const leave = isObject(config) && config.leave || 'leaving';\n      const enter = isObject(config) && config.enter || 'entering';\n      promises.push(animate(from, leave));\n      promises.push(animate(to, enter));\n    }\n\n    return Promise.all(promises).then(() => context);\n  }\n\n  /**\n   * Subscribes this instance to navigation events on the `window`.\n   *\n   * NOTE: beware of resource leaks. For as long as a router instance is\n   * subscribed to navigation events, it won't be garbage collected.\n   */\n  subscribe() {\n    window.addEventListener('vaadin-router-go', this.__navigationEventHandler);\n  }\n\n  /**\n   * Removes the subscription to navigation events created in the `subscribe()`\n   * method.\n   */\n  unsubscribe() {\n    window.removeEventListener('vaadin-router-go', this.__navigationEventHandler);\n  }\n\n  __onNavigationEvent(event) {\n    const {pathname, search, hash} = event ? event.detail : window.location;\n    if (isString(this.__normalizePathname(pathname))) {\n      if (event && event.preventDefault) {\n        event.preventDefault();\n      }\n      this.render({pathname, search, hash}, true);\n    }\n  }\n\n  /**\n   * Configures what triggers Router navigation events:\n   *  - `POPSTATE`: popstate events on the current `window`\n   *  - `CLICK`: click events on `<a>` links leading to the current page\n   *\n   * This method is invoked with the pre-configured values when creating a new Router instance.\n   * By default, both `POPSTATE` and `CLICK` are enabled. This setup is expected to cover most of the use cases.\n   *\n   * See the `router-config.js` for the default navigation triggers config. Based on it, you can\n   * create the own one and only import the triggers you need, instead of pulling in all the code,\n   * e.g. if you want to handle `click` differently.\n   *\n   * See also **Navigation Triggers** section in [Live Examples](#/classes/Router/demos/demo/index.html).\n   *\n   * @param {...NavigationTrigger} triggers\n   */\n  static setTriggers(...triggers) {\n    setNavigationTriggers(triggers);\n  }\n\n  /**\n   * Generates a URL for the route with the given name, optionally performing\n   * substitution of parameters.\n   *\n   * The route is searched in all the Router instances subscribed to\n   * navigation events.\n   *\n   * **Note:** For child route names, only array children are considered.\n   * It is not possible to generate URLs using a name for routes set with\n   * a children function.\n   *\n   * @function urlForName\n   * @param {!string} name the route name or the route’s `component` name.\n   * @param {Params=} params Optional object with route path parameters.\n   * Named parameters are passed by name (`params[name] = value`), unnamed\n   * parameters are passed by index (`params[index] = value`).\n   *\n   * @return {string}\n   */\n  urlForName(name, params) {\n    if (!this.__urlForName) {\n      this.__urlForName = generateUrls(this);\n    }\n    return getPathnameForRouter(\n      this.__urlForName(name, params),\n      this\n    );\n  }\n\n  /**\n   * Generates a URL for the given route path, optionally performing\n   * substitution of parameters.\n   *\n   * @param {!string} path string route path declared in [express.js syntax](https://expressjs.com/en/guide/routing.html#route-paths\").\n   * @param {Params=} params Optional object with route path parameters.\n   * Named parameters are passed by name (`params[name] = value`), unnamed\n   * parameters are passed by index (`params[index] = value`).\n   *\n   * @return {string}\n   */\n  urlForPath(path, params) {\n    return getPathnameForRouter(\n      Router.pathToRegexp.compile(path)(params),\n      this\n    );\n  }\n\n  /**\n   * Triggers navigation to a new path. Returns a boolean without waiting until\n   * the navigation is complete. Returns `true` if at least one `Router`\n   * has handled the navigation (was subscribed and had `baseUrl` matching\n   * the `path` argument), otherwise returns `false`.\n   *\n   * @param {!string|!{pathname: !string, search: (string|undefined), hash: (string|undefined)}} path\n   *   a new in-app path string, or an URL-like object with `pathname`\n   *   string property, and optional `search` and `hash` string properties.\n   * @return {boolean}\n   */\n  static go(path) {\n    const {pathname, search, hash} = isString(path)\n      ? this.__createUrl(path, 'http://a') // some base to omit origin\n      : path;\n    return fireRouterEvent('go', {pathname, search, hash});\n  }\n}\n\nconst DEV_MODE_CODE_REGEXP =\n  /\\/\\*\\*\\s+vaadin-dev-mode:start([\\s\\S]*)vaadin-dev-mode:end\\s+\\*\\*\\//i;\n\nconst FlowClients = window.Vaadin && window.Vaadin.Flow && window.Vaadin.Flow.clients;\n\nfunction isMinified() {\n  function test() {\n    /** vaadin-dev-mode:start\n    return false;\n    vaadin-dev-mode:end **/\n    return true;\n  }\n  return uncommentAndRun(test);\n}\n\nfunction isDevelopmentMode() {\n  try {\n    if (isForcedDevelopmentMode()) {\n      return true;\n    }\n\n    if (!isLocalhost()) {\n      return false;\n    }\n\n    if (FlowClients) {\n      return !isFlowProductionMode();\n    }\n\n    return !isMinified();\n  } catch (e) {\n    // Some error in this code, assume production so no further actions will be taken\n    return false;\n  }\n}\n\nfunction isForcedDevelopmentMode() {\n  return localStorage.getItem(\"vaadin.developmentmode.force\");\n}\n\nfunction isLocalhost() {\n  return ([\"localhost\",\"127.0.0.1\"].indexOf(window.location.hostname) >= 0);\n}\n\nfunction isFlowProductionMode() {\n  if (FlowClients) {\n    const productionModeApps = Object.keys(FlowClients)\n      .map(key => FlowClients[key])\n      .filter(client => client.productionMode);\n    if (productionModeApps.length > 0) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction uncommentAndRun(callback, args) {\n  if (typeof callback !== 'function') {\n    return;\n  }\n\n  const match = DEV_MODE_CODE_REGEXP.exec(callback.toString());\n  if (match) {\n    try {\n      // requires CSP: script-src 'unsafe-eval'\n      callback = new Function(match[1]);\n    } catch (e) {\n      // eat the exception\n      console.log('vaadin-development-mode-detector: uncommentAndRun() failed', e);\n    }\n  }\n\n  return callback(args);\n}\n\n// A guard against polymer-modulizer removing the window.Vaadin\n// initialization above.\nwindow['Vaadin'] = window['Vaadin'] || {};\n\n/**\n * Inspects the source code of the given `callback` function for\n * specially-marked _commented_ code. If such commented code is found in the\n * callback source, uncomments and runs that code instead of the callback\n * itself. Otherwise runs the callback as is.\n *\n * The optional arguments are passed into the callback / uncommented code,\n * the result is returned.\n *\n * See the `isMinified()` function source code in this file for an example.\n *\n */\nconst runIfDevelopmentMode = function(callback, args) {\n  if (window.Vaadin.developmentMode) {\n    return uncommentAndRun(callback, args);\n  }\n};\n\nif (window.Vaadin.developmentMode === undefined) {\n  window.Vaadin.developmentMode = isDevelopmentMode();\n}\n\n/* This file is autogenerated from src/vaadin-usage-statistics.tpl.html */\n\nfunction maybeGatherAndSendStats() {\n  /** vaadin-dev-mode:start\n  (function () {\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar getPolymerVersion = function getPolymerVersion() {\n  return window.Polymer && window.Polymer.version;\n};\n\nvar StatisticsGatherer = function () {\n  function StatisticsGatherer(logger) {\n    classCallCheck(this, StatisticsGatherer);\n\n    this.now = new Date().getTime();\n    this.logger = logger;\n  }\n\n  createClass(StatisticsGatherer, [{\n    key: 'frameworkVersionDetectors',\n    value: function frameworkVersionDetectors() {\n      return {\n        'Flow': function Flow() {\n          if (window.Vaadin && window.Vaadin.Flow && window.Vaadin.Flow.clients) {\n            var flowVersions = Object.keys(window.Vaadin.Flow.clients).map(function (key) {\n              return window.Vaadin.Flow.clients[key];\n            }).filter(function (client) {\n              return client.getVersionInfo;\n            }).map(function (client) {\n              return client.getVersionInfo().flow;\n            });\n            if (flowVersions.length > 0) {\n              return flowVersions[0];\n            }\n          }\n        },\n        'Vaadin Framework': function VaadinFramework() {\n          if (window.vaadin && window.vaadin.clients) {\n            var frameworkVersions = Object.values(window.vaadin.clients).filter(function (client) {\n              return client.getVersionInfo;\n            }).map(function (client) {\n              return client.getVersionInfo().vaadinVersion;\n            });\n            if (frameworkVersions.length > 0) {\n              return frameworkVersions[0];\n            }\n          }\n        },\n        'AngularJs': function AngularJs() {\n          if (window.angular && window.angular.version && window.angular.version) {\n            return window.angular.version.full;\n          }\n        },\n        'Angular': function Angular() {\n          if (window.ng) {\n            var tags = document.querySelectorAll(\"[ng-version]\");\n            if (tags.length > 0) {\n              return tags[0].getAttribute(\"ng-version\");\n            }\n            return \"Unknown\";\n          }\n        },\n        'Backbone.js': function BackboneJs() {\n          if (window.Backbone) {\n            return window.Backbone.VERSION;\n          }\n        },\n        'React': function React() {\n          var reactSelector = '[data-reactroot], [data-reactid]';\n          if (!!document.querySelector(reactSelector)) {\n            // React does not publish the version by default\n            return \"unknown\";\n          }\n        },\n        'Ember': function Ember() {\n          if (window.Em && window.Em.VERSION) {\n            return window.Em.VERSION;\n          } else if (window.Ember && window.Ember.VERSION) {\n            return window.Ember.VERSION;\n          }\n        },\n        'jQuery': function (_jQuery) {\n          function jQuery() {\n            return _jQuery.apply(this, arguments);\n          }\n\n          jQuery.toString = function () {\n            return _jQuery.toString();\n          };\n\n          return jQuery;\n        }(function () {\n          if (typeof jQuery === 'function' && jQuery.prototype.jquery !== undefined) {\n            return jQuery.prototype.jquery;\n          }\n        }),\n        'Polymer': function Polymer() {\n          var version = getPolymerVersion();\n          if (version) {\n            return version;\n          }\n        },\n        'LitElement': function LitElement() {\n          var version = window.litElementVersions && window.litElementVersions[0];\n          if (version) {\n            return version;\n          }\n        },\n        'LitHtml': function LitHtml() {\n          var version = window.litHtmlVersions && window.litHtmlVersions[0];\n          if (version) {\n            return version;\n          }\n        },\n        'Vue.js': function VueJs() {\n          if (window.Vue) {\n            return window.Vue.version;\n          }\n        }\n      };\n    }\n  }, {\n    key: 'getUsedVaadinElements',\n    value: function getUsedVaadinElements(elements) {\n      var version = getPolymerVersion();\n      var elementClasses = void 0;\n      // NOTE: In case you edit the code here, YOU MUST UPDATE any statistics reporting code in Flow.\n      // Check all locations calling the method getEntries() in\n      // https://github.com/vaadin/flow/blob/master/flow-server/src/main/java/com/vaadin/flow/internal/UsageStatistics.java#L106\n      // Currently it is only used by BootstrapHandler.\n      if (version && version.indexOf('2') === 0) {\n        // Polymer 2: components classes are stored in window.Vaadin\n        elementClasses = Object.keys(window.Vaadin).map(function (c) {\n          return window.Vaadin[c];\n        }).filter(function (c) {\n          return c.is;\n        });\n      } else {\n        // Polymer 3: components classes are stored in window.Vaadin.registrations\n        elementClasses = window.Vaadin.registrations || [];\n      }\n      elementClasses.forEach(function (klass) {\n        var version = klass.version ? klass.version : \"0.0.0\";\n        elements[klass.is] = { version: version };\n      });\n    }\n  }, {\n    key: 'getUsedVaadinThemes',\n    value: function getUsedVaadinThemes(themes) {\n      ['Lumo', 'Material'].forEach(function (themeName) {\n        var theme;\n        var version = getPolymerVersion();\n        if (version && version.indexOf('2') === 0) {\n          // Polymer 2: themes are stored in window.Vaadin\n          theme = window.Vaadin[themeName];\n        } else {\n          // Polymer 3: themes are stored in custom element registry\n          theme = customElements.get('vaadin-' + themeName.toLowerCase() + '-styles');\n        }\n        if (theme && theme.version) {\n          themes[themeName] = { version: theme.version };\n        }\n      });\n    }\n  }, {\n    key: 'getFrameworks',\n    value: function getFrameworks(frameworks) {\n      var detectors = this.frameworkVersionDetectors();\n      Object.keys(detectors).forEach(function (framework) {\n        var detector = detectors[framework];\n        try {\n          var version = detector();\n          if (version) {\n            frameworks[framework] = { version: version };\n          }\n        } catch (e) {}\n      });\n    }\n  }, {\n    key: 'gather',\n    value: function gather(storage) {\n      var storedStats = storage.read();\n      var gatheredStats = {};\n      var types = [\"elements\", \"frameworks\", \"themes\"];\n\n      types.forEach(function (type) {\n        gatheredStats[type] = {};\n        if (!storedStats[type]) {\n          storedStats[type] = {};\n        }\n      });\n\n      var previousStats = JSON.stringify(storedStats);\n\n      this.getUsedVaadinElements(gatheredStats.elements);\n      this.getFrameworks(gatheredStats.frameworks);\n      this.getUsedVaadinThemes(gatheredStats.themes);\n\n      var now = this.now;\n      types.forEach(function (type) {\n        var keys = Object.keys(gatheredStats[type]);\n        keys.forEach(function (key) {\n          if (!storedStats[type][key] || _typeof(storedStats[type][key]) != _typeof({})) {\n            storedStats[type][key] = { firstUsed: now };\n          }\n          // Discards any previously logged version number\n          storedStats[type][key].version = gatheredStats[type][key].version;\n          storedStats[type][key].lastUsed = now;\n        });\n      });\n\n      var newStats = JSON.stringify(storedStats);\n      storage.write(newStats);\n      if (newStats != previousStats && Object.keys(storedStats).length > 0) {\n        this.logger.debug(\"New stats: \" + newStats);\n      }\n    }\n  }]);\n  return StatisticsGatherer;\n}();\n\nvar StatisticsStorage = function () {\n  function StatisticsStorage(key) {\n    classCallCheck(this, StatisticsStorage);\n\n    this.key = key;\n  }\n\n  createClass(StatisticsStorage, [{\n    key: 'read',\n    value: function read() {\n      var localStorageStatsString = localStorage.getItem(this.key);\n      try {\n        return JSON.parse(localStorageStatsString ? localStorageStatsString : '{}');\n      } catch (e) {\n        return {};\n      }\n    }\n  }, {\n    key: 'write',\n    value: function write(data) {\n      localStorage.setItem(this.key, data);\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      localStorage.removeItem(this.key);\n    }\n  }, {\n    key: 'isEmpty',\n    value: function isEmpty() {\n      var storedStats = this.read();\n      var empty = true;\n      Object.keys(storedStats).forEach(function (key) {\n        if (Object.keys(storedStats[key]).length > 0) {\n          empty = false;\n        }\n      });\n\n      return empty;\n    }\n  }]);\n  return StatisticsStorage;\n}();\n\nvar StatisticsSender = function () {\n  function StatisticsSender(url, logger) {\n    classCallCheck(this, StatisticsSender);\n\n    this.url = url;\n    this.logger = logger;\n  }\n\n  createClass(StatisticsSender, [{\n    key: 'send',\n    value: function send(data, errorHandler) {\n      var logger = this.logger;\n\n      if (navigator.onLine === false) {\n        logger.debug(\"Offline, can't send\");\n        errorHandler();\n        return;\n      }\n      logger.debug(\"Sending data to \" + this.url);\n\n      var req = new XMLHttpRequest();\n      req.withCredentials = true;\n      req.addEventListener(\"load\", function () {\n        // Stats sent, nothing more to do\n        logger.debug(\"Response: \" + req.responseText);\n      });\n      req.addEventListener(\"error\", function () {\n        logger.debug(\"Send failed\");\n        errorHandler();\n      });\n      req.addEventListener(\"abort\", function () {\n        logger.debug(\"Send aborted\");\n        errorHandler();\n      });\n      req.open(\"POST\", this.url);\n      req.setRequestHeader(\"Content-Type\", \"application/json\");\n      req.send(data);\n    }\n  }]);\n  return StatisticsSender;\n}();\n\nvar StatisticsLogger = function () {\n  function StatisticsLogger(id) {\n    classCallCheck(this, StatisticsLogger);\n\n    this.id = id;\n  }\n\n  createClass(StatisticsLogger, [{\n    key: '_isDebug',\n    value: function _isDebug() {\n      return localStorage.getItem(\"vaadin.\" + this.id + \".debug\");\n    }\n  }, {\n    key: 'debug',\n    value: function debug(msg) {\n      if (this._isDebug()) {\n        console.info(this.id + \": \" + msg);\n      }\n    }\n  }]);\n  return StatisticsLogger;\n}();\n\nvar UsageStatistics = function () {\n  function UsageStatistics() {\n    classCallCheck(this, UsageStatistics);\n\n    this.now = new Date();\n    this.timeNow = this.now.getTime();\n    this.gatherDelay = 10; // Delay between loading this file and gathering stats\n    this.initialDelay = 24 * 60 * 60;\n\n    this.logger = new StatisticsLogger(\"statistics\");\n    this.storage = new StatisticsStorage(\"vaadin.statistics.basket\");\n    this.gatherer = new StatisticsGatherer(this.logger);\n    this.sender = new StatisticsSender(\"https://tools.vaadin.com/usage-stats/submit\", this.logger);\n  }\n\n  createClass(UsageStatistics, [{\n    key: 'maybeGatherAndSend',\n    value: function maybeGatherAndSend() {\n      var _this = this;\n\n      if (localStorage.getItem(UsageStatistics.optOutKey)) {\n        return;\n      }\n      this.gatherer.gather(this.storage);\n      setTimeout(function () {\n        _this.maybeSend();\n      }, this.gatherDelay * 1000);\n    }\n  }, {\n    key: 'lottery',\n    value: function lottery() {\n      return true;\n    }\n  }, {\n    key: 'currentMonth',\n    value: function currentMonth() {\n      return this.now.getYear() * 12 + this.now.getMonth();\n    }\n  }, {\n    key: 'maybeSend',\n    value: function maybeSend() {\n      var firstUse = Number(localStorage.getItem(UsageStatistics.firstUseKey));\n      var monthProcessed = Number(localStorage.getItem(UsageStatistics.monthProcessedKey));\n\n      if (!firstUse) {\n        // Use a grace period to avoid interfering with tests, incognito mode etc\n        firstUse = this.timeNow;\n        localStorage.setItem(UsageStatistics.firstUseKey, firstUse);\n      }\n\n      if (this.timeNow < firstUse + this.initialDelay * 1000) {\n        this.logger.debug(\"No statistics will be sent until the initial delay of \" + this.initialDelay + \"s has passed\");\n        return;\n      }\n      if (this.currentMonth() <= monthProcessed) {\n        this.logger.debug(\"This month has already been processed\");\n        return;\n      }\n      localStorage.setItem(UsageStatistics.monthProcessedKey, this.currentMonth());\n      // Use random sampling\n      if (this.lottery()) {\n        this.logger.debug(\"Congratulations, we have a winner!\");\n      } else {\n        this.logger.debug(\"Sorry, no stats from you this time\");\n        return;\n      }\n\n      this.send();\n    }\n  }, {\n    key: 'send',\n    value: function send() {\n      // Ensure we have the latest data\n      this.gatherer.gather(this.storage);\n\n      // Read, send and clean up\n      var data = this.storage.read();\n      data[\"firstUse\"] = Number(localStorage.getItem(UsageStatistics.firstUseKey));\n      data[\"usageStatisticsVersion\"] = UsageStatistics.version;\n      var info = 'This request contains usage statistics gathered from the application running in development mode. \\n\\nStatistics gathering is automatically disabled and excluded from production builds.\\n\\nFor details and to opt-out, see https://github.com/vaadin/vaadin-usage-statistics.\\n\\n\\n\\n';\n      var self = this;\n      this.sender.send(info + JSON.stringify(data), function () {\n        // Revert the 'month processed' flag\n        localStorage.setItem(UsageStatistics.monthProcessedKey, self.currentMonth() - 1);\n      });\n    }\n  }], [{\n    key: 'version',\n    get: function get$1() {\n      return '2.1.0';\n    }\n  }, {\n    key: 'firstUseKey',\n    get: function get$1() {\n      return 'vaadin.statistics.firstuse';\n    }\n  }, {\n    key: 'monthProcessedKey',\n    get: function get$1() {\n      return 'vaadin.statistics.monthProcessed';\n    }\n  }, {\n    key: 'optOutKey',\n    get: function get$1() {\n      return 'vaadin.statistics.optout';\n    }\n  }]);\n  return UsageStatistics;\n}();\n\ntry {\n  window.Vaadin = window.Vaadin || {};\n  window.Vaadin.usageStatsChecker = window.Vaadin.usageStatsChecker || new UsageStatistics();\n  window.Vaadin.usageStatsChecker.maybeGatherAndSend();\n} catch (e) {\n  // Intentionally ignored as this is not a problem in the app being developed\n}\n\n}());\n\n  vaadin-dev-mode:end **/\n}\n\nconst usageStatistics = function() {\n  if (typeof runIfDevelopmentMode === 'function') {\n    return runIfDevelopmentMode(maybeGatherAndSendStats);\n  }\n};\n\nwindow.Vaadin = window.Vaadin || {};\nwindow.Vaadin.registrations = window.Vaadin.registrations || [];\n\nwindow.Vaadin.registrations.push({\n  is: '@vaadin/router',\n  version: '1.7.4',\n});\n\nusageStatistics();\n\nRouter.NavigationTrigger = {POPSTATE, CLICK};\n\nexport { Resolver, Router };\n//# sourceMappingURL=vaadin-router.js.map\n","import { error400, error404 } from \"./errors\";\n\n// https://github.com/afq984/ilmsdump/blob/2ae39118b38c05f54e689d62bb245692269e5df3/ilmsserve/__init__.py#L377-L425\nexport const getRedirectLocation = (params: URLSearchParams): string => {\n  const param = (key: string) => {\n    const value = params.get(key);\n    if (value === null) {\n      throw error400(`missing required query parameter: ${key}`);\n    }\n    return value;\n  };\n\n  const courseID = param(\"courseID\");\n  const f = params.get(\"f\") || \"syllabus\";\n  switch (f) {\n    case \"syllabus\":\n      return `/course/${courseID}`;\n    case \"activity\":\n    case \"news\":\n      return `/course/${courseID}/announcement/`;\n    case \"doclist\":\n      return `/course/${courseID}/material/`;\n    case \"forumlist\":\n      return `/course/${courseID}/discussion/`;\n    case \"hwlist\":\n      return `/course/${courseID}/homework/`;\n    case \"score\":\n    case \"score_edit\":\n      return `/course/${courseID}/score`;\n    case \"group\":\n    case \"grouplist\":\n    case \"teamall\":\n    case \"team_forumlist\":\n    case \"team_memberlist\":\n    case \"team_homework\":\n      return `/course/${courseID}/grouplist`;\n    case \"news_show\":\n      return `/course/${courseID}/announcement/${param(\"newsID\")}`;\n    case \"doc\":\n      throw error404();\n    case \"forum\":\n      return `/course/${courseID}/discussion/${param(\"tid\")}`;\n    case \"hw\":\n      return `/course/${courseID}/homework/${param(\"hw\")}`;\n    case \"hw_doclist\":\n      return `/course/${courseID}/homework/${param(\"hw\")}/submission/`;\n    default:\n      throw error404();\n  }\n};\n","import { Commands, Context, Route, Router } from \"@vaadin/router\";\nimport { getRedirectLocation } from \"./course-php\";\nimport { DataSource } from \"./data-source\";\nimport { RenderableError } from \"./errors\";\n\nexport interface MenuItem {\n  typename?: string;\n  displayname: string;\n  countable: boolean;\n}\n\nexport type RouteEntry = MenuItem & Route;\n\nexport const menuItemAnnouncement = {\n  typename: \"announcement\",\n  displayname: \"公告\",\n  countable: true,\n  path: \"/course/:course_id/announcement/\",\n  component: \"freeze-course-announcements\",\n};\n\nexport const menuItemMaterial = {\n  typename: \"material\",\n  displayname: \"上課教材\",\n  countable: true,\n  path: \"/course/:course_id/material/\",\n  component: \"freeze-course-materials\",\n};\nexport const menuItemDiscussion = {\n  typename: \"discussion\",\n  displayname: \"討論區\",\n  countable: true,\n  path: \"/course/:course_id/discussion/\",\n  component: \"freeze-course-discussions\",\n};\nexport const menuItemHomework = {\n  typename: \"homework\",\n  displayname: \"作業\",\n  countable: true,\n  path: \"/course/:course_id/homework/\",\n  component: \"freeze-course-homeworks\",\n};\nexport const menuItemScore = {\n  typename: \"score\",\n  displayname: \"成績計算\",\n  countable: false,\n  path: \"/course/:course_id/score\",\n  component: \"freeze-course-score\",\n};\nexport const menuItemGrouplist = {\n  typename: \"grouplist\",\n  displayname: \"小組專區\",\n  countable: false,\n  path: \"/course/:course_id/grouplist\",\n  component: \"freeze-course-grouplist\",\n};\n\nexport const menuItems: Array<RouteEntry> = [\n  {\n    displayname: \"課程說明\",\n    countable: false,\n    path: \"/course/:course_id\",\n    component: \"freeze-course\",\n  },\n  menuItemAnnouncement,\n  menuItemMaterial,\n  menuItemDiscussion,\n  menuItemHomework,\n  menuItemScore,\n  menuItemGrouplist,\n];\n\nconst actionOpenBlank = (ctx: Context, commands: Commands) => {\n  window.open(ctx.pathname + ctx.search);\n  return commands.prevent();\n};\n\nexport const routes: Array<Route> = (\n  [\n    {\n      path: \"/\",\n      component: \"freeze-index\",\n    },\n    {\n      path: \"/course/\",\n      component: \"freeze-browse\",\n    },\n    {\n      path: \"/download\",\n      component: \"freeze-download\",\n    },\n    {\n      path: \"/course/:course_id/announcement/:announcement_id\",\n      component: \"freeze-announcement\",\n    },\n    {\n      path: \"/course/:course_id/material/:material_id\",\n      component: \"freeze-material\",\n    },\n    {\n      path: \"/course/:course_id/discussion/:discussion_id\",\n      component: \"freeze-discussion\",\n    },\n    {\n      path: \"/course/:course_id/homework/:homework_id\",\n      component: \"freeze-homework\",\n    },\n    {\n      path: \"/course/:course_id/homework/:homework_id/submission/\",\n      component: \"freeze-homework-submissions\",\n    },\n    {\n      path: \"/course/:course_id/homework/:homework_id/submission/:submittedhomework_id\",\n      component: \"freeze-submission\",\n    },\n    {\n      path: \"/attachment/(.*)\",\n      action: actionOpenBlank,\n    },\n    {\n      path: \"/sys/read_attach.php\",\n      action: actionOpenBlank,\n    },\n  ] as Array<Route>\n).concat(menuItems as Array<Route>, [\n  {\n    path: \"/course.php\",\n    action: async (context, commands) => {\n      const params = new URLSearchParams(context.search);\n      let redirectLocation: string;\n      try {\n        redirectLocation = getRedirectLocation(params);\n      } catch (e) {\n        if (e instanceof RenderableError) {\n          return commands.component(\"freeze-404\");\n        }\n        throw e;\n      }\n      return commands.redirect(redirectLocation);\n    },\n  },\n  {\n    path: \"(.*)\",\n    component: \"freeze-404\",\n  },\n]);\n\nexport class RouterSource extends Router {\n  dataSource?: DataSource;\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport { classMap } from \"lit/directives/class-map.js\";\n\nimport { ChildrenMap, CourseMeta } from \"./types\";\nimport { menuItems, RouteEntry, RouterSource } from \"./routes\";\n\nconst getLink = (\n  router: RouterSource,\n  course_id: number,\n  menuItem: RouteEntry\n) => {\n  const params = { course_id: course_id.toString() };\n  return router.urlForName(menuItem.component!, params);\n};\n\n@customElement(\"freeze-sidemenu\")\nexport class FreezeSidemenu extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  @property({ attribute: false })\n  courseMeta?: CourseMeta;\n  @property({ attribute: false })\n  courseChildren?: ChildrenMap;\n  @property({ attribute: false })\n  activeUrl?: string;\n  @property({ attribute: false })\n  router?: RouterSource;\n\n  renderLink(meta: CourseMeta, item: RouteEntry) {\n    const children = this.courseChildren!;\n    const url = getLink(this.router!, meta.id, item);\n    const classes = {\n      \"is-active\": url === this.activeUrl,\n      \"side-menu-disabled\":\n        item.typename !== undefined && !(item.typename in children),\n    };\n    let text = item.displayname;\n    if (item.typename !== undefined && item.countable) {\n      text = `${text} (${(children[item.typename] || []).length})`;\n    }\n    return html`<a href=\"${url}\" class=\"${classMap(classes)}\">${text}</a>`;\n  }\n\n  render() {\n    const meta = this.courseMeta!;\n    return html`<aside class=\"menu\">\n      <p class=\"menu-label\">${meta.serial}</p>\n      <ul class=\"menu-list\">\n        ${menuItems.map(\n          (item) => html` <li>${this.renderLink(meta, item)}</li> `\n        )}\n      </ul>\n    </aside>`;\n  }\n}\n","const baseName = (name: string) => {\n  const split = name.split(\"/\");\n  return split[split.length - 1];\n};\n\nexport const rewriteHTML = (\n  html: string,\n  tag: string,\n  srcmap: { [key: string]: string },\n  keyfunc: (_: string) => string = baseName\n) => {\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(html, \"text/html\");\n  for (const element of doc.querySelectorAll(tag)) {\n    const src = element.getAttribute(\"src\");\n    if (src !== null && src.startsWith(\"/sysdata/\")) {\n      const key = keyfunc(src);\n      if (key in srcmap) {\n        element.setAttribute(\"src\", srcmap[key]);\n      }\n    }\n  }\n  return doc.querySelector(\"body\")!.innerHTML;\n};\n","import { IndexedParams, RouterLocation } from \"@vaadin/router\";\nimport { html, TemplateResult } from \"lit\";\nimport { customElement } from \"lit/decorators.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nimport \"./freeze-no-source\";\nimport \"./freeze-404\";\nimport { BrowseBaseView } from \"./base-view.js\";\nimport { DataSource } from \"./data-source.js\";\nimport { Fragment, fragmentsPush, homeFragment } from \"./freeze-pathbar.js\";\nimport \"./freeze-sidemenu\";\nimport { TableFields, textField } from \"./freeze-table.js\";\nimport { materialIcon, unsafeContent } from \"./html.js\";\nimport {\n  menuItemAnnouncement,\n  menuItemDiscussion,\n  menuItemGrouplist,\n  menuItemHomework,\n  menuItemMaterial,\n  menuItemScore,\n  RouteEntry,\n} from \"./routes.js\";\nimport {\n  AnnouncementMeta,\n  AttachmentMeta,\n  ChildrenMap,\n  CourseMeta,\n  DiscussionMeta,\n  HomeworkMeta,\n  MaterialMeta,\n  parseChildren,\n  SubmissionMeta,\n} from \"./types.js\";\nimport { rewriteHTML } from \"./rewrite\";\n\nconst getParamId = (params: IndexedParams, field: string) => {\n  const str = params[field].toString();\n  return parseInt(str);\n};\n\nconst getParamMeta = async (\n  params: IndexedParams,\n  source: DataSource,\n  typename: string\n) => {\n  const id = getParamId(params, `${typename}_id`);\n  return await source.getMeta(typename, id);\n};\n\nabstract class FreezeCourseBase extends BrowseBaseView {\n  courseMeta?: CourseMeta;\n  courseChildren?: ChildrenMap;\n  abstract fragments(): Array<Fragment>;\n\n  constructor() {\n    super();\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    super.prepareState(location, source);\n\n    const course_id = parseInt(location.params.course_id.toString());\n    this.courseMeta = await source.getMeta(\"course\", course_id);\n    this.courseChildren = parseChildren(this.courseMeta!.children);\n  }\n\n  abstract renderBody(): string | TemplateResult;\n\n  renderState() {\n    return html`\n      ${this.renderHeader()}\n      <freeze-pathbar .fragments=${this.fragments()}></freeze-pathbar>\n      <div class=\"columns\">\n        <freeze-sidemenu\n          class=\"column is-one-fifth\"\n          .courseMeta=${this.courseMeta}\n          .courseChildren=${this.courseChildren}\n          .activeUrl=${this.activeUrl}\n          .router=${this.router}\n        ></freeze-sidemenu>\n        <div class=\"column\">${this.renderBody()}</div>\n      </div>\n    `;\n  }\n}\n\n@customElement(\"freeze-course\")\nexport class FreezeCourseOverview extends FreezeCourseBase {\n  body = \"\";\n\n  fragments() {\n    return [\n      homeFragment,\n      {\n        text: this.courseMeta!.name,\n        href: `/course/${this.courseMeta!.id}/`,\n        active: true,\n      },\n    ];\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.body = await source.getText(\n      \"course\",\n      this.courseMeta!.id,\n      \"index.html\"\n    );\n  }\n\n  renderBody() {\n    return unsafeContent(this.body);\n  }\n}\n\nabstract class FreezeCourseL2Base extends FreezeCourseBase {\n  abstract menuItem: RouteEntry;\n\n  get typename() {\n    return this.menuItem.typename!;\n  }\n\n  fragments(): Fragment[] {\n    const course_id_param = { course_id: this.courseMeta!.id.toString() };\n    return [\n      homeFragment,\n      {\n        text: this.courseMeta!.name,\n        href: this.router!.urlForName(\"freeze-course\", course_id_param),\n      },\n      {\n        text: this.menuItem.displayname,\n        href: this.router!.urlForName(\n          this.menuItem.component!,\n          course_id_param\n        ),\n        active: true,\n      },\n    ];\n  }\n}\n\n@customElement(\"freeze-course-score\")\nexport class FreezeCourseScore extends FreezeCourseL2Base {\n  menuItem = menuItemScore;\n\n  body = \"\";\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.body = await source.getText(\n      \"score\",\n      this.courseMeta!.id,\n      \"index.html\"\n    );\n  }\n\n  renderBody() {\n    return unsafeContent(this.body);\n  }\n}\n\n@customElement(\"freeze-course-grouplist\")\nexport class FreezeCourseGrouplist extends FreezeCourseL2Base {\n  menuItem = menuItemGrouplist;\n\n  body = \"\";\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.body = await source.getText(\n      \"grouplist\",\n      this.courseMeta!.id,\n      \"index.html\"\n    );\n  }\n\n  renderBody() {\n    return unsafeContent(this.body);\n  }\n}\n\nabstract class FreezeCourseTable<T> extends FreezeCourseL2Base {\n  table: Array<T> = [];\n  abstract fields(): TableFields;\n\n  makeLinkFn(component: string) {\n    const typename_id = `${this.typename}_id`;\n    return (item: any, attr: any) => {\n      const url = this.router!.urlForName(component, {\n        course_id: this.courseMeta!.id.toString(),\n        [typename_id]: item.id.toString(),\n      });\n      return html`<a href=\"${url}\">${attr}</a>`;\n    };\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.table = await source.getMetas(\n      this.typename,\n      this.courseChildren![this.typename]\n    );\n  }\n\n  renderBody() {\n    return html`<freeze-table\n      .items=${this.table}\n      .fields=${this.fields()}\n      .sortDescending=${true}\n      .sortField=${\"id\"}\n    ></freeze-table>`;\n  }\n}\n\n@customElement(\"freeze-course-announcements\")\nexport class FreezeCourseAnnouncements extends FreezeCourseTable<AnnouncementMeta> {\n  menuItem = menuItemAnnouncement;\n  fields() {\n    return {\n      id: this.makeLinkFn(\"freeze-announcement\"),\n      title: this.makeLinkFn(\"freeze-announcement\"),\n    };\n  }\n}\n\n@customElement(\"freeze-course-materials\")\nexport class FreezeCousreMaterials extends FreezeCourseTable<MaterialMeta> {\n  menuItem = menuItemMaterial;\n  fields() {\n    return {\n      id: this.makeLinkFn(\"freeze-material\"),\n      title: this.makeLinkFn(\"freeze-material\"),\n      type: textField,\n    };\n  }\n}\n\n@customElement(\"freeze-course-discussions\")\nexport class FreezeCourseDiscussions extends FreezeCourseTable<DiscussionMeta> {\n  menuItem = menuItemDiscussion;\n  fields() {\n    return {\n      id: this.makeLinkFn(\"freeze-discussion\"),\n      title: this.makeLinkFn(\"freeze-discussion\"),\n    };\n  }\n}\n\n@customElement(\"freeze-course-homeworks\")\nexport class FzeezeCourseHomeworks extends FreezeCourseTable<HomeworkMeta> {\n  menuItem = menuItemHomework;\n  fields() {\n    return {\n      id: this.makeLinkFn(\"freeze-homework\"),\n      title: this.makeLinkFn(\"freeze-homework\"),\n    };\n  }\n}\n\n@customElement(\"freeze-announcement\")\nexport class FreezeAnnouncement extends FreezeCourseL2Base {\n  menuItem = menuItemAnnouncement;\n\n  announcementMeta?: AnnouncementMeta;\n  news: any;\n  attachments?: Array<AttachmentMeta>;\n\n  fragments() {\n    const meta = this.announcementMeta!;\n    return fragmentsPush(super.fragments(), {\n      text: meta.title,\n      href: this.router!.urlForName(\"freeze-announcement\", {\n        course_id: this.courseMeta!.id.toString(),\n        announcement_id: meta.id.toString(),\n      }),\n      active: true,\n    });\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    const announcement_id = parseInt(\n      location.params.announcement_id.toString()\n    );\n    this.announcementMeta = await source.getMeta(\n      \"announcement\",\n      announcement_id\n    );\n    this.news = (\n      await source.getJson(\n        \"announcement\",\n        this.announcementMeta!.id,\n        \"index.json\"\n      )\n    ).news;\n    const children = parseChildren(this.announcementMeta!.children);\n    this.attachments = await source.getMetas(\"attachment\", children.attachment);\n  }\n\n  renderAttachments() {\n    if (this.attachments === undefined) {\n      return undefined;\n    }\n    return html`\n      <br />\n      ${this.attachments.map(\n        (item) => html`\n          ${materialIcon(\"attachment\")}\n          <a href=\"/attachment/${item.id}\" target=\"_blank\">${item.title}</a>\n        `\n      )}\n    `;\n  }\n\n  renderBody() {\n    return html`\n      <h1 class=\"title\">${this.announcementMeta!.title}</h1>\n      <strong>${this.news.poster}</strong>\n      <small>\n        ${materialIcon(\"visibility\")}\n        <span>${this.news.views}</span>\n      </small>\n      <small>\n        ${materialIcon(\"calendar_today\")}\n        <span>${this.news.createTime}</span>\n      </small>\n      <div class=\"content\">\n        <br />\n        ${unsafeHTML(this.news.note)} ${this.renderAttachments()}\n      </div>\n    `;\n  }\n}\n\n@customElement(\"freeze-material\")\nexport class FreezeMaterial extends FreezeCourseL2Base {\n  menuItem = menuItemMaterial;\n\n  materialMeta?: MaterialMeta;\n  materialChildren?: ChildrenMap;\n  materialBody?: string;\n\n  fragments() {\n    const meta = this.materialMeta!;\n    return fragmentsPush(super.fragments(), {\n      text: meta.title,\n      href: this.router!.urlForName(\"freeze-material\", {\n        course_id: this.courseMeta!.id.toString(),\n        material_id: meta.id.toString(),\n      }),\n      active: true,\n    });\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    super.prepareState(location, source);\n    this.materialMeta = await getParamMeta(location.params, source, \"material\");\n    this.materialChildren = parseChildren(this.materialMeta!.children);\n    const body = await source.getText(\n      \"material\",\n      this.materialMeta!.id,\n      \"index.html\"\n    );\n\n    const rewrites: { [_: string]: string } = {};\n    for (const id of this.materialChildren.attachment || []) {\n      rewrites[`${id}.mp4`] = `/attachment/${id}`;\n    }\n    this.materialBody = rewriteHTML(body, \"video\", rewrites);\n  }\n\n  renderVideo() {\n    const videoes = this.materialChildren!.video;\n    if (videoes === undefined) {\n      return undefined;\n    }\n    return html`<video src=\"/video/${videoes[0]}\" controls></video>`;\n  }\n\n  renderBody() {\n    return html`\n      ${this.renderVideo()}\n      <div class=\"contenet\">${unsafeHTML(this.materialBody!)}</div>\n    `;\n  }\n}\n\n@customElement(\"freeze-discussion\")\nexport class FreezeDiscussion extends FreezeCourseL2Base {\n  menuItem = menuItemDiscussion;\n\n  discussionMeta?: DiscussionMeta;\n  discussionJson?: any;\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    super.prepareState(location, source);\n    this.discussionMeta = await getParamMeta(\n      location.params,\n      source,\n      \"discussion\"\n    );\n    this.discussionJson = await source.getJson(\n      \"discussion\",\n      this.discussionMeta!.id,\n      \"index.json\"\n    );\n\n    for (const post of this.discussionJson.posts.items) {\n      if (!post.note.trim()) {\n        continue;\n      }\n      const rewrites: { [_: string]: string } = {};\n      for (const attachment of post.attach) {\n        rewrites[attachment.fileName] = `/attachment/${attachment.id}`;\n      }\n      post.note = rewriteHTML(post.note, \"img\", rewrites);\n    }\n  }\n\n  fragments() {\n    const meta = this.discussionMeta!;\n    return fragmentsPush(super.fragments(), {\n      text: meta.title,\n      href: this.router!.urlForName(\"freeze-discussion\", {\n        course_id: this.courseMeta!.id.toString(),\n        discussion_id: meta.id.toString(),\n      }),\n      active: true,\n    });\n  }\n\n  renderBody() {\n    return html`${this.discussionJson.posts.items.map(\n      (post: any) => html`\n        <div class=\"box\">\n          <div class=\"content\">\n            <strong>${post.name}</strong>\n            <small>${materialIcon(\"email\")} ${post.email}</small>\n            <small>${materialIcon(\"calendar_today\")} ${post.date}</small>\n            <br />\n            ${unsafeHTML(post.note)}\n            ${post.attach.map(\n              (attachment: any, index: number) => html`\n                ${index === 0 ? html`<br />` : undefined}\n                ${materialIcon(\"attachment\")}\n                <a href=\"/attachment/${attachment.id}\" target=\"_blank\"\n                  >${attachment.srcName}</a\n                >\n              `\n            )}\n          </div>\n        </div>\n      `\n    )}`;\n  }\n}\n\n@customElement(\"freeze-homework\")\nexport class FreezeHomework extends FreezeCourseL2Base {\n  menuItem = menuItemHomework;\n\n  homeworkMeta?: HomeworkMeta;\n  homeworkChildren?: ChildrenMap;\n  body = \"\";\n\n  fragments() {\n    const frag = super.fragments();\n    const hw_params = {\n      course_id: this.courseMeta!.id.toString(),\n      homework_id: this.homeworkMeta!.id.toString(),\n    };\n    frag[frag.length - 1].active = false;\n    frag.push({\n      text: this.homeworkMeta!.title,\n      href: this.router!.urlForName(\"freeze-homework\", hw_params),\n      active: true,\n    });\n    frag.push({\n      text: `可下載 (${this.homeworkChildren!.submittedhomework?.length || 0})`,\n      href: this.router!.urlForName(\"freeze-homework-submissions\", hw_params),\n    });\n    return frag;\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    super.prepareState(location, source);\n    this.homeworkMeta = await getParamMeta(location.params, source, \"homework\");\n    this.body = await source.getText(\n      \"homework\",\n      this.homeworkMeta!.id,\n      \"index.html\"\n    );\n    this.homeworkChildren = parseChildren(this.homeworkMeta!.children);\n  }\n\n  renderBody() {\n    return unsafeContent(this.body);\n  }\n}\n\n@customElement(\"freeze-homework-submissions\")\nexport class FreezeHomeworkSubmissions extends FreezeHomework {\n  submissions?: SubmissionMeta[];\n\n  fragments() {\n    const frag = super.fragments();\n    frag[frag.length - 2].active = false;\n    frag[frag.length - 1].active = true;\n    return frag;\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.submissions = await source.getMetas(\n      \"submittedhomework\",\n      this.homeworkChildren!.submittedhomework\n    );\n  }\n\n  fields() {\n    const linkFn = (item: any, attr: string) => {\n      const url = this.router!.urlForName(\"freeze-submission\", {\n        course_id: this.courseMeta!.id.toString(),\n        homework_id: this.homeworkMeta!.id.toString(),\n        submittedhomework_id: item.id.toString(),\n      });\n      return html`<a href=${url}>${attr}</a>`;\n    };\n    return {\n      id: linkFn,\n      title: linkFn,\n      by: textField,\n      comment: (_: any, attr: string) => attr || \"-\",\n    };\n  }\n\n  renderBody() {\n    if (this.submissions === undefined || this.submissions.length === 0) {\n      return html`\n        <div style=\"display: inline-block\">\n          <div class=\"oops\">¯\\\\_(ツ)_/¯</div>\n          <div class=\"has-text-centered\">no submissions found</div>\n        </div>\n      `;\n    }\n    return html`<freeze-table\n      .items=${this.submissions}\n      .fields=${this.fields()}\n      .sortDescending=${true}\n      .sortField=${\"id\"}\n    ></freeze-table>`;\n  }\n}\n\n@customElement(\"freeze-submission\")\nexport class FreezeSubmission extends FreezeHomeworkSubmissions {\n  submissionMeta?: SubmissionMeta;\n  submissionBody = \"\";\n\n  fragments() {\n    const meta = this.submissionMeta!;\n    return fragmentsPush(super.fragments(), {\n      text: meta.title,\n      href: this.router!.urlForName(\"freeze-submission\", {\n        course_id: this.courseMeta!.id.toString(),\n        homework_id: this.homeworkMeta!.id.toString(),\n        submittedhomework_id: meta.id.toString(),\n      }),\n      active: true,\n    });\n  }\n\n  async prepareState(location: RouterLocation, source: DataSource) {\n    await super.prepareState(location, source);\n    this.submissionMeta = await getParamMeta(\n      location.params,\n      source,\n      \"submittedhomework\"\n    );\n    this.submissionBody = await source.getText(\n      \"submittedhomework\",\n      this.submissionMeta!.id,\n      \"index.html\"\n    );\n  }\n\n  renderBody() {\n    return unsafeContent(this.submissionBody);\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\nimport {\n  externalLink,\n  renderStatus,\n  statusFail,\n  statusSuccess,\n  statusUnknown,\n  statusWarn,\n} from \"./html\";\n\n@customElement(\"freeze-index\")\nexport class FreezeIndex extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n  @state()\n  fsAvailable = \"showDirectoryPicker\" in window;\n  @state()\n  serviceWorkerStatus = statusWarn;\n  @state()\n  serviceWorkerDescription = \"Unknown\";\n  @state()\n  extensionInstalled = false;\n  @state()\n  extensionVersion = \"\";\n  updatedListener: EventListener;\n\n  constructor() {\n    super();\n    this.updatedListener = () => this.updateExtensionStatus();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.checkServiceWorkerStatus();\n\n    const status = document.querySelector(\"freeze-extension-status\") as any;\n    status.addEventListener(\"updated\", this.updatedListener);\n    this.updateExtensionStatus();\n  }\n\n  disconnectedCallback() {\n    document\n      .querySelector(\"freeze-extension-status\")\n      ?.removeEventListener(\"updated\", this.updatedListener);\n  }\n\n  updateExtensionStatus() {\n    const status = document.querySelector(\"freeze-extension-status\") as any;\n    this.extensionInstalled = status.extensionId !== \"\";\n    this.extensionVersion = status.extensionVersion;\n  }\n\n  async checkServiceWorkerStatus() {\n    for (let i = 1; i < 100; i *= 1.3) {\n      const response = await fetch(\"/sw-status.json\");\n      const status = await response.json();\n      switch (status.version) {\n        case null:\n          this.serviceWorkerStatus = statusWarn;\n          this.serviceWorkerDescription = \"Unavailable\";\n          break;\n        case 1:\n          this.serviceWorkerStatus = statusSuccess;\n          this.serviceWorkerDescription = \"Active\";\n          return;\n        default:\n          this.serviceWorkerStatus = statusUnknown;\n          this.serviceWorkerDescription = \"Unknown\";\n          return;\n      }\n      await new Promise((r) => setTimeout(r, i * 1000));\n    }\n  }\n\n  render() {\n    return html`\n      <div class=\"content\">\n        <h1 class=\"title\">ilmsfreeze</h1>\n        <p>\n          Hello! ilmsfreeze helps you back up & view\n          ${externalLink(\"NTHU iLMS\", \"https://lms.nthu.edu.tw/\")} data in the\n          browser.<br />\n        </p>\n        <p>\n          Source code is hosted on\n          ${externalLink(\"GitHub\", \"https://github.com/afq984/ilmsfreeze\")}. Bug\n          reports & contributions welcome!\n        </p>\n        ${this.renderDiagnostics()}\n        <h3>Privacy</h3>\n        Your iLMS data stays on your disk and does not go to our server.<br />\n        Google Analytics is used to track site usage.\n      </div>\n    `;\n  }\n\n  renderDiagnostics() {\n    return html`\n      <h3>Diagnostics</h3>\n      <dl>\n        <dt>\n          <strong>File System Access API</strong>\n          ${this.fsAvailable\n            ? renderStatus(statusSuccess, \"Available\")\n            : renderStatus(statusFail, \"Unsupported\")}\n        </dt>\n        <dd>\n          <em>Required</em> to load/download iLMS data from/to your disk.<br />\n          See\n          ${externalLink(\n            \"supported browsers\",\n            \"https://caniuse.com/native-filesystem-api\"\n          )}.\n        </dd>\n        <dt>\n          <strong>Service Worker</strong>\n          ${renderStatus(\n            this.serviceWorkerStatus,\n            this.serviceWorkerDescription\n          )}\n        </dt>\n        <dd>\n          The service worker provides access to\n          <em>attachments, videos, and inline images</em>.<br />\n          Try close all tabs and reload this site if there is a problem.\n        </dd>\n        <dt>\n          <strong>Chrome Extension</strong>\n          ${this.extensionInstalled\n            ? renderStatus(\n                statusSuccess,\n                `Installed (version: ${this.extensionVersion})`\n              )\n            : renderStatus(statusWarn, `Not installed`)}\n        </dt>\n        <dd>\n          You need the\n          ${externalLink(\n            \"Chrome Extension\",\n            \"https://chrome.google.com/webstore/detail/jmchkngdnmcmenihgjknjoamfdkpojcn\"\n          )}\n          to <em>download</em> from iLMS.<br />\n          Alternatively, you can use\n          ${externalLink(\"ilmsdump\", \"https://github.com/afq984/ilmsdump\")} to\n          backup. ilmsfreeze is compatible with the\n          <code>ilmsdump.out</code> directory.\n        </dd>\n      </dl>\n    `;\n  }\n}\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\n        });\n    }\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking)\n            db.addEventListener('versionchange', () => blocking());\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport { createRef, Ref, ref } from \"lit/directives/ref.js\";\n\nimport \"./freeze-navbar\";\nimport \"./freeze-browse\";\nimport \"./freeze-download\";\nimport \"./freeze-course\";\nimport \"./freeze-index\";\nimport \"./freeze-404\";\nimport { RouterSource, routes } from \"./routes\";\nimport {\n  DataSource,\n  deserializeDataSource,\n  FileSystemDataSource,\n  RemoteDataSource,\n  serializeDataSource,\n} from \"./data-source\";\nimport { IDBPDatabase, openDB } from \"idb\";\n\n@customElement(\"freeze-extension-status\")\nexport class FreezeExtensionStatus extends LitElement {\n  @property()\n  extensionId = \"\";\n  @property()\n  extensionVersion = \"\";\n}\n\n@customElement(\"freeze-app\")\nexport class FreezeApp extends LitElement {\n  dataSource?: DataSource;\n  mainRef: Ref<Element> = createRef();\n  router: RouterSource;\n  db?: IDBPDatabase;\n  private dbInitDone: Promise<void>;\n\n  constructor() {\n    super();\n    this.router = new RouterSource();\n    this.dbInitDone = this.initDB();\n  }\n\n  createRenderRoot() {\n    return this;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.initServiceWorker();\n  }\n\n  async firstUpdated() {\n    await this.dbInitDone;\n    this.router.setOutlet(this.mainRef.value!);\n    this.router.setRoutes(routes);\n  }\n\n  async initDB() {\n    this.db = await openDB(\"meta\", 1, {\n      upgrade(db) {\n        db.createObjectStore(\"keyval\");\n      },\n    });\n\n    const q = new URLSearchParams(window.location.search);\n    const remote = q.get(\"open\");\n    if (remote === \"https://ilmsdump.afq984.org\") {\n      this.setDataSource(new RemoteDataSource(remote));\n      window.history.replaceState(\"\", \"\", window.location.pathname);\n      return;\n    }\n\n    const serializedSource = await this.db.get(\"keyval\", \"storedSource\");\n    if (serializedSource !== undefined) {\n      const cachedSource = deserializeDataSource(serializedSource);\n      if (cachedSource !== null) {\n        if (cachedSource instanceof FileSystemDataSource) {\n          const readPerm = await cachedSource.rootHandle.queryPermission({\n            mode: \"read\",\n          });\n          if (readPerm === \"granted\") {\n            this.setDataSource(cachedSource, true);\n          } else {\n            console.log(\"Bad read perm:\", readPerm);\n          }\n        } else {\n          this.setDataSource(cachedSource, true);\n        }\n      }\n    }\n  }\n\n  initServiceWorker() {\n    if (\"serviceWorker\" in navigator) {\n      navigator.serviceWorker.register(\"/sw.js\").then(\n        (registration) => {\n          console.log(\n            \"ServiceWorker registration successful with scope: \",\n            registration.scope\n          );\n          registration.addEventListener(\"updatefound\", () => {\n            const newWorker = registration.installing;\n            if (this.dataSource !== undefined) {\n              newWorker!.postMessage({\n                op: \"set_data_source\",\n                data: serializeDataSource(this.dataSource),\n              });\n            }\n            newWorker?.postMessage({\n              op: \"take_over\",\n            });\n          });\n        },\n        (err) => {\n          console.log(\"ServiceWorker registration failed: \", err);\n        }\n      );\n    }\n  }\n\n  render() {\n    return html`\n      <freeze-navbar\n        @subscribe=${this._onSubscribe}\n        @directory-open=${this._onClick}\n      ></freeze-navbar>\n\n      <div class=\"section\">\n        <main\n          ${ref(this.mainRef)}\n          class=\"container\"\n          @subscribe=${this._onSubscribe}\n          @request-write=${this._onRequestWrite}\n        ></main>\n      </div>\n    `;\n  }\n\n  private async _onClick() {\n    const rootHandle = await window.showDirectoryPicker();\n    this.setDataSource(new FileSystemDataSource(rootHandle));\n  }\n\n  private async _onRequestWrite() {\n    if (this.dataSource === undefined) {\n      return;\n    }\n    if (this.dataSource instanceof FileSystemDataSource) {\n      const rootHandle = this.dataSource.rootHandle;\n      const rw = await rootHandle.queryPermission({ mode: \"readwrite\" });\n      if (rw === \"prompt\") {\n        await rootHandle.requestPermission({ mode: \"readwrite\" });\n        this.setDataSource(this.dataSource);\n      }\n    }\n  }\n\n  setDataSource(dataSource: DataSource, skipDB = false) {\n    this.dataSource = dataSource;\n    const options = {\n      detail: this.dataSource,\n    };\n    this.router!.dataSource = dataSource;\n    this.dispatchEvent(new CustomEvent(\"directory-changed\", options));\n\n    if (\n      !(\"serviceWorker\" in navigator) ||\n      navigator.serviceWorker.controller === null\n    ) {\n      console.log(\"Service worker not available, not sending data source\");\n    } else {\n      navigator.serviceWorker.controller.postMessage({\n        op: \"set_data_source\",\n        data: serializeDataSource(dataSource),\n      });\n    }\n\n    if (!skipDB) {\n      this.db?.put(\"keyval\", serializeDataSource(dataSource), \"storedSource\");\n    }\n    console.log(`set data source: ${dataSource.name}`);\n  }\n\n  private async _onSubscribe(e: CustomEvent) {\n    await e.detail(this, this.dataSource);\n  }\n}\n"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","t","window","ShadowRoot","ShadyCSS","nativeShadow","Document","prototype","CSSStyleSheet","e","Symbol","n","Map","s","constructor","this","_$cssResult$","Error","cssText","styleSheet","get","set","replaceSync","toString","S","cssRules","o","toAttribute","Boolean","Array","JSON","stringify","fromAttribute","Number","parse","h","attribute","type","String","converter","reflect","hasChanged","HTMLElement","super","_$Et","isUpdatePending","hasUpdated","_$Ei","static","l","push","observedAttributes","finalize","elementProperties","forEach","_$Eh","_$Eu","state","noAccessor","hasOwnProperty","getPropertyDescriptor","requestUpdate","configurable","enumerable","finalized","getPrototypeOf","properties","getOwnPropertyNames","getOwnPropertySymbols","createProperty","elementStyles","finalizeStyles","styles","isArray","Set","flat","reverse","unshift","toLowerCase","_$Ev","Promise","enableUpdating","_$AL","_$Ep","addController","_$Em","renderRoot","isConnected","hostConnected","call","removeController","splice","indexOf","createRenderRoot","shadowRoot","attachShadow","shadowRootOptions","adoptedStyleSheets","map","document","createElement","litNonce","setAttribute","textContent","appendChild","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$Eg","removeAttribute","getPropertyOptions","a","has","_$ES","_$EC","async","reject","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","update","_$ET","_$AE","hostUpdated","firstUpdated","updated","updateComplete","getUpdateComplete","mode","globalThis","reactiveElementPolyfillSupport","ReactiveElement","reactiveElementVersions","trustedTypes","createPolicy","createHTML","Math","random","slice","createComment","u","v","iterator","f","_","g","m","$","y","_$litType$","strings","values","p","T","for","x","w","WeakMap","C","createTreeWalker","P","lastIndex","exec","test","RegExp","startsWith","V","parts","el","currentNode","content","firstChild","remove","append","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","endsWith","getAttribute","split","index","name","ctor","k","H","I","M","tagName","emptyScript","data","innerHTML","E","_$Cl","_$Cu","_$litDirective$","_$AO","_$AT","_$AS","N","_$AN","_$AD","_$AM","parentNode","_$AU","creationScope","importNode","nextSibling","L","_$AI","_$AH","_$AA","_$AB","options","_$Cg","startNode","endNode","_$AR","A","insertBefore","createTextNode","_$AC","_$AP","setConnected","element","fill","capture","once","passive","removeEventListener","addEventListener","handleEvent","host","R","D","j","O","F","B","W","Z","litHtmlPolyfillSupport","litHtmlVersions","renderOptions","_$Dt","renderBefore","render","_$litPart$","_$litElement$","litElementHydrateSupport","LitElement","litElementPolyfillSupport","litElementVersions","customElements","define","kind","elements","finisher","descriptor","placement","originalKey","initializer","querySelector","_$AQ","_$Ct","_$Ci","delete","size","add","reconnected","disconnected","setValue","U","nt","rt","lt","ht","value","keys","filter","join","st","et","classList","RenderableError","title","message","setPrototypeOf","error404","error400","badsource","error403","reduce","replace","style","ut","includes","removeProperty","setProperty","it","directiveName","vt","raw","resultType","materialIcon","html","styleMap","unsafeContent","unsafeHTML","externalLink","text","url","classes","classMap","statusSuccess","iconName","cssClass","statusUnknown","statusWarn","statusFail","renderStatus","cls","renderError","err","oops","x2","DirectoryChangeAwareView","directoryChangedListener","handleDirectoryChange","detail","dataSource","subscribedTo","undefined","subscribe","bubbles","dispatchEvent","CustomEvent","BaseView","location","router","activeUrl","pathname","prepareStateProtected","source","prepareState","error","console","renderState","BrowseBaseView","_location","header","renderHeader","warnAndThrow","warn","DataSource","typename","id","filename","file","txt","getText","getJson","ids","result","getMeta","isNotFoundError","find","promise","notFound","FileSystemDataSource","rootHandle","typeDir","getDirectoryHandle","objDir","fileHandle","getFileHandle","getFile","entry","metaHandlePromise","metaFile","meta","RemoteDataSource","baseURL","resp","fetch","json","path","URL","status","statusText","blob","serializeDataSource","ty","FreezeNavbar","directoryName","queryPermission","directoryAccess","renderDirectoryStatus","directoryAccessClasses","tag","renderOpenButton","_dispatchClick","composed","customElement","textField","_item","attr","FreezeTable","items","fields","sortField","sort","sortDescending","field","b","toggleSort","item","entries","attrFn","property","homeFragment","href","fragmentsPush","frags","active","FreezePathbar","fragments","fragment","FreezeNoSource","FreezeBrowse","linkfn","urlForName","course_id","serial","is_admin","courses","getAllMeta","dt","ct","Bug","check","condition","notnull","mustParseInt","parseInt","isFinite","parseChildren","children","child","camelTypeName","toLocaleLowerCase","$x","xpathExpression","contextNode","ownerDocument","evaluate","iterateNext","$x1","results","dl","parseDownloadableReference","idstr","isTypename","fetch200","response","ok","parseHTML","body","DOMParser","parseFromString","mustGetQs","q","searchParams","buildURL","query","search","URLSearchParams","tableIsEmpty","secondRowTds","htmlGetMain","noPermission","checkPermission","mains","main","bad","toRemove","parentElement","removeChild","flattenPaginator","courseMeta","page","courseID","toFixed","nextHrefs","next_page","assert","getCourseAnnouncements","tr","course","getCourseDiscussions","getCourseMaterials","getCourseHomeworks","getCourseScores","getCourseGroupLists","replaceIllegalCharactersInPath","fileName","replaceChar","from","codePointAt","match","isIllegalAnywhere","isIllegalAtEnds","processAttachment","attachmentMeta","respose","saveName","dirty","saved_filename","getAttachments","parent","trim","processMaterial","materialMeta","cid","refString","attachment","video","db_table","flash_installed","swf_id","area_size","ret","player_width","embed","src","getMaterialVideo","outerHTML","processSinglePage","processItem","getters","func","processCourse","announcementMeta","news","note","poster","attachmentRawDiv","attach","processAnnouncement","discussionMeta","post","srcName","processDiscussion","homeworkMeta","saveFiles","hw","headerTr","fieldIndexes","td","as","ititle","iname","comments","comment","by","processHomework","submissionMeta","processSubmission","videoMeta","processVideo","downloadableToString","ref","DownloadState","FreezePrompt","closeWith","resolve","yes","no","ask","prompt","DirectoryState","FreezeDownload","None","windowOnBeforeUnload","downlaodIsRunning","getStatus","dumper","downloadRunning","commands","onbeforeunload","onBeforeEnter","prevent","ilmsAccess","profile","nameTag","nameTagName","loggedInAs","getLoginState","dh","ReadOnly","ReadWrite","Remote","FreezeDump","setEnrolledCoursesAsync","enrolledCourses","bs","courseURL","getEnrolledCourses","completedDownloads","queue","dm","download","addCourse","added","UIDownloadManager","doDownload","addEnrolledCourses","courseIdInput","nodeValue","hint","getCourse","_requestWriteAccess","Event","renderForm","event","addSelectedCourse","preventDefault","renderQueue","repeat","FreezeDumpCourse","downloadManager","ui","startDownload","getIconName","Scheduled","Processing","Completed","Errored","progress","total","stateChanged","setState","downloadInternal","itemID","itemName","typedir","create","objdir","stream","createWritable","ReadableStream","write","close","bytesWritten","reportTransform","TransformStream","transform","chunk","controller","byteLength","enqueue","reportingStream","pipeThrough","pipeTo","currentItem","totalItems","shift","done","next","downloadFile","Freeze404","toArray","objectOrArray","log","msg","bundleKeys","ensureBundle","ensureRoute","route","isString","bundle","stringKeys","isFunction","action","isObject","some","redirect","overriddenProp","ensureRoutes","routes","loadScript","script","head","onreadystatechange","onload","__dynamicImportLoaded","onerror","fireRouterEvent","cancelable","getNotFoundError","context","code","notFoundResult","vaadinRouterGlobalClickHandler","defaultPrevented","button","shiftKey","ctrlKey","altKey","metaKey","anchor","composedPath","nodeName","hasAttribute","hash","origin","port","protocol","hostname","getAnchorOrigin","scrollTo","CLICK","activate","inactivate","vaadinRouterGlobalPopstateHandler","navigator","userAgent","PopStateEvent","inType","params","createEvent","initEvent","POPSTATE","pathToRegexp_1","pathToRegexp","parse_1","compile_1","str","tokensToFunction","tokensToFunction_1","tokensToRegExp_1","tokensToRegExp","PATH_REGEXP","res","tokens","defaultDelimiter","delimiter","delimiters","pathEscaped","escaped","offset","prev","group","modifier","partial","optional","pattern","prefix","escapeGroup","escapeString","substr","matches","encode","encodeURIComponent","token","segment","TypeError","flags","sensitive","strict","start","end","concat","isEndDelimited","groups","regexpToRegexp","arrayToRegexp","stringToRegexp","compile","cache","decodeParam","val","decodeURIComponent","matchRoute","ignoreLeadingSlash","parentKeys","parentParams","childMatches","childIndex","routepath","charAt","routeToSkip","__children","exact","cacheKey","regexp","assign","prop","matchPath","childRoute","matchedLength","childMatch","resolveRoute","Resolver","baseUrl","errorHandler","resolver","root","__synthetic","getRoutes","setRoutes","newRoutes","addRoutes","removeRoutes","pathnameOrContext","__normalizePathname","nextMatches","currentContext","resume","prevResult","parentRoute","isChildRoute","chain","pop","updateChainForRoute","then","resolution","catch","errorMessage","routePath","generateErrorMessage","DOMException","base","__effectiveBaseUrl","__createUrl","baseURI","normalizedUrl","pathToRegexp$1","cache$1","cacheRoutes","routesByName","component","getRouteByName","routeName","getRoutePath","generateUrls","clear","fullPath","toPath","stringifyQueryParams","queryParams","triggers","setNavigationTriggers","newTriggers","trigger","animate","elem","className","getComputedStyle","getPropertyValue","willAnimate","rect","getBoundingClientRect","bottom","top","right","left","cb","listener","waitForAnimation","isResultNotEmpty","createLocation","redirectFrom","getUrl","userParams","getPathnameForRouter","Router","getMatchedPath","createRedirect","runCallbackIfPossible","callback","args","thisArg","apply","amend","amendmentFunction","amendmentResult","cancel","removeDomNodes","nodes","outlet","baseElement","baseHref","__resolveRoute","NavigationTrigger","setTriggers","ready","__lastStartedRenderId","__navigationEventHandler","__onNavigationEvent","bind","setOutlet","__createdByRouter","__addedByRouter","callbacks","copy","copyContextWithoutNext","newChildren","childRoutes","processNewChildren","__isLatestRender","race","__ensureOutlet","__outlet","getOutlet","skipRender","__previousContext","__urlForName","shouldUpdateHistory","renderId","__renderId","__fullyResolveChain","previousContext","__updateBrowserHistory","__skipAttach","__copyUnchangedElements","__addAppearingContent","animationDone","__animateIfNeeded","__runOnAfterEnterCallbacks","__runOnAfterLeaveCallbacks","__removeDisappearingContent","topOfTheChainContextBeforeRedirects","contextBeforeRedirects","__findComponentContextAfterAllRedirects","contextAfterRedirects","topOfTheChainContextAfterRedirects","isFound","findNextContextIfAny","nextContext","__amendWithOnBeforeCallbacks","renderElement","__redirect","__redirectCount","stringType","logValue","contextWithFullChain","__runOnBeforeCallbacks","amendedContext","newContext","previousChain","newChain","__divergedChainIndex","min","__isReusableElement","__runOnBeforeLeaveCallbacks","__runOnBeforeEnterCallbacks","chainElement","afterLeaveFunction","beforeEnterFunction","otherElement","localName","redirectData","counter","urlForPath","Node","changeState","history","deepestCommonParent","unchangedElement","__removeAppearingContent","__appearingContent","__disappearingContent","elementToAdd","targetContext","currentComponent","onAfterLeave","onAfterEnter","to","promises","config","leave","enter","all","unsubscribe","DEV_MODE_CODE_REGEXP","FlowClients","Vaadin","Flow","clients","uncommentAndRun","Function","runIfDevelopmentMode","developmentMode","maybeGatherAndSendStats","localStorage","getItem","client","productionMode","isDevelopmentMode","registrations","is","version","menuItemAnnouncement","displayname","countable","menuItemMaterial","menuItemDiscussion","menuItemHomework","menuItemScore","menuItemGrouplist","menuItems","actionOpenBlank","ctx","open","redirectLocation","param","getRedirectLocation","RouterSource","FreezeSidemenu","renderLink","courseChildren","menuItem","getLink","baseName","rewriteHTML","srcmap","keyfunc","doc","querySelectorAll","getParamMeta","getParamId","FreezeCourseBase","renderBody","FreezeCourseOverview","FreezeCourseL2Base","course_id_param","FreezeCourseScore","FreezeCourseGrouplist","FreezeCourseTable","makeLinkFn","typename_id","table","getMetas","FreezeCourseAnnouncements","FreezeCousreMaterials","FreezeCourseDiscussions","FzeezeCourseHomeworks","FreezeAnnouncement","announcement_id","attachments","renderAttachments","views","createTime","FreezeMaterial","material_id","materialChildren","rewrites","materialBody","renderVideo","videoes","FreezeDiscussion","discussionJson","posts","discussion_id","email","date","FreezeHomework","frag","hw_params","homework_id","homeworkChildren","submittedhomework","FreezeHomeworkSubmissions","submissions","linkFn","submittedhomework_id","FreezeSubmission","submissionBody","FreezeIndex","updatedListener","updateExtensionStatus","checkServiceWorkerStatus","extensionInstalled","extensionId","extensionVersion","serviceWorkerStatus","serviceWorkerDescription","setTimeout","renderDiagnostics","fsAvailable","idbProxyableTypes","cursorAdvanceMethods","cursorRequestMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","receiver","IDBTransaction","objectStoreNames","objectStore","wrap","wrapFunction","IDBDatabase","transaction","IDBCursor","advance","continue","continuePrimaryKey","unwrap","storeNames","tx","transformCachableValue","unlisten","complete","cacheDonePromiseForTransaction","object","IDBObjectStore","IDBIndex","Proxy","IDBRequest","request","success","promisifyRequest","newValue","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","store","oldTraps","FreezeExtensionStatus","FreezeApp","dbInitDone","initDB","initServiceWorker","mainRef","db","blocked","upgrade","blocking","terminated","indexedDB","openPromise","oldVersion","newVersion","openDB","createObjectStore","remote","setDataSource","replaceState","serializedSource","cachedSource","obj","readPerm","serviceWorker","register","registration","scope","newWorker","installing","postMessage","op","_onSubscribe","_onClick","_onRequestWrite","showDirectoryPicker","requestPermission","skipDB","put"],"mappings":"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"}